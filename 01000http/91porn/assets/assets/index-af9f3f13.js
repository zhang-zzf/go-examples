(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function Os(t,e){const r=Object.create(null),n=t.split(",");for(let i=0;i<n.length;i++)r[n[i]]=!0;return e?i=>!!r[i.toLowerCase()]:i=>!!r[i]}const Ie={},Rr=[],St=()=>{},uc=()=>!1,cc=/^on[^a-z]/,di=t=>cc.test(t),xs=t=>t.startsWith("onUpdate:"),Ve=Object.assign,Ps=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},dc=Object.prototype.hasOwnProperty,be=(t,e)=>dc.call(t,e),ce=Array.isArray,Ir=t=>Sn(t)==="[object Map]",fi=t=>Sn(t)==="[object Set]",ua=t=>Sn(t)==="[object Date]",ve=t=>typeof t=="function",Me=t=>typeof t=="string",dn=t=>typeof t=="symbol",De=t=>t!==null&&typeof t=="object",zo=t=>De(t)&&ve(t.then)&&ve(t.catch),Yo=Object.prototype.toString,Sn=t=>Yo.call(t),fc=t=>Sn(t).slice(8,-1),qo=t=>Sn(t)==="[object Object]",Ms=t=>Me(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Vn=Os(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),hi=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},hc=/-(\w)/g,It=hi(t=>t.replace(hc,(e,r)=>r?r.toUpperCase():"")),gc=/\B([A-Z])/g,Ar=hi(t=>t.replace(gc,"-$1").toLowerCase()),gi=hi(t=>t.charAt(0).toUpperCase()+t.slice(1)),Fi=hi(t=>t?`on${gi(t)}`:""),fn=(t,e)=>!Object.is(t,e),jn=(t,e)=>{for(let r=0;r<t.length;r++)t[r](e)},Xn=(t,e,r)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:r})},Qn=t=>{const e=parseFloat(t);return isNaN(e)?t:e},mc=t=>{const e=Me(t)?Number(t):NaN;return isNaN(e)?t:e};let ca;const is=()=>ca||(ca=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function yt(t){if(ce(t)){const e={};for(let r=0;r<t.length;r++){const n=t[r],i=Me(n)?Ec(n):yt(n);if(i)for(const s in i)e[s]=i[s]}return e}else{if(Me(t))return t;if(De(t))return t}}const pc=/;(?![^(]*\))/g,vc=/:([^]+)/,yc=/\/\*[^]*?\*\//g;function Ec(t){const e={};return t.replace(yc,"").split(pc).forEach(r=>{if(r){const n=r.split(vc);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Je(t){let e="";if(Me(t))e=t;else if(ce(t))for(let r=0;r<t.length;r++){const n=Je(t[r]);n&&(e+=n+" ")}else if(De(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}function Tc(t){if(!t)return null;let{class:e,style:r}=t;return e&&!Me(e)&&(t.class=Je(e)),r&&(t.style=yt(r)),t}const Sc="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",bc=Os(Sc);function $o(t){return!!t||t===""}function Ac(t,e){if(t.length!==e.length)return!1;let r=!0;for(let n=0;r&&n<t.length;n++)r=mi(t[n],e[n]);return r}function mi(t,e){if(t===e)return!0;let r=ua(t),n=ua(e);if(r||n)return r&&n?t.getTime()===e.getTime():!1;if(r=dn(t),n=dn(e),r||n)return t===e;if(r=ce(t),n=ce(e),r||n)return r&&n?Ac(t,e):!1;if(r=De(t),n=De(e),r||n){if(!r||!n)return!1;const i=Object.keys(t).length,s=Object.keys(e).length;if(i!==s)return!1;for(const a in t){const d=t.hasOwnProperty(a),u=e.hasOwnProperty(a);if(d&&!u||!d&&u||!mi(t[a],e[a]))return!1}}return String(t)===String(e)}function Lc(t,e){return t.findIndex(r=>mi(r,e))}const Ae=t=>Me(t)?t:t==null?"":ce(t)||De(t)&&(t.toString===Yo||!ve(t.toString))?JSON.stringify(t,Zo,2):String(t),Zo=(t,e)=>e&&e.__v_isRef?Zo(t,e.value):Ir(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[n,i])=>(r[`${n} =>`]=i,r),{})}:fi(e)?{[`Set(${e.size})`]:[...e.values()]}:De(e)&&!ce(e)&&!qo(e)?String(e):e;let tt;class wc{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=tt,!e&&tt&&(this.index=(tt.scopes||(tt.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const r=tt;try{return tt=this,e()}finally{tt=r}}}on(){tt=this}off(){tt=this.parent}stop(e){if(this._active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function _c(t,e=tt){e&&e.active&&e.effects.push(t)}function Xo(){return tt}function kc(t){tt&&tt.cleanups.push(t)}const Fs=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Qo=t=>(t.w&er)>0,Jo=t=>(t.n&er)>0,Dc=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=er},Rc=t=>{const{deps:e}=t;if(e.length){let r=0;for(let n=0;n<e.length;n++){const i=e[n];Qo(i)&&!Jo(i)?i.delete(t):e[r++]=i,i.w&=~er,i.n&=~er}e.length=r}},Jn=new WeakMap;let en=0,er=1;const ss=30;let vt;const Er=Symbol(""),as=Symbol("");class Ns{constructor(e,r=null,n){this.fn=e,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,_c(this,n)}run(){if(!this.active)return this.fn();let e=vt,r=Qt;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=vt,vt=this,Qt=!0,er=1<<++en,en<=ss?Dc(this):da(this),this.fn()}finally{en<=ss&&Rc(this),er=1<<--en,vt=this.parent,Qt=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){vt===this?this.deferStop=!0:this.active&&(da(this),this.onStop&&this.onStop(),this.active=!1)}}function da(t){const{deps:e}=t;if(e.length){for(let r=0;r<e.length;r++)e[r].delete(t);e.length=0}}let Qt=!0;const el=[];function Vr(){el.push(Qt),Qt=!1}function jr(){const t=el.pop();Qt=t===void 0?!0:t}function et(t,e,r){if(Qt&&vt){let n=Jn.get(t);n||Jn.set(t,n=new Map);let i=n.get(r);i||n.set(r,i=Fs()),tl(i)}}function tl(t,e){let r=!1;en<=ss?Jo(t)||(t.n|=er,r=!Qo(t)):r=!t.has(vt),r&&(t.add(vt),vt.deps.push(t))}function Nt(t,e,r,n,i,s){const a=Jn.get(t);if(!a)return;let d=[];if(e==="clear")d=[...a.values()];else if(r==="length"&&ce(t)){const u=Number(n);a.forEach((o,y)=>{(y==="length"||y>=u)&&d.push(o)})}else switch(r!==void 0&&d.push(a.get(r)),e){case"add":ce(t)?Ms(r)&&d.push(a.get("length")):(d.push(a.get(Er)),Ir(t)&&d.push(a.get(as)));break;case"delete":ce(t)||(d.push(a.get(Er)),Ir(t)&&d.push(a.get(as)));break;case"set":Ir(t)&&d.push(a.get(Er));break}if(d.length===1)d[0]&&os(d[0]);else{const u=[];for(const o of d)o&&u.push(...o);os(Fs(u))}}function os(t,e){const r=ce(t)?t:[...t];for(const n of r)n.computed&&fa(n);for(const n of r)n.computed||fa(n)}function fa(t,e){(t!==vt||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}function Ic(t,e){var r;return(r=Jn.get(t))==null?void 0:r.get(e)}const Cc=Os("__proto__,__v_isRef,__isVue"),rl=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(dn)),Oc=Us(),xc=Us(!1,!0),Pc=Us(!0),ha=Mc();function Mc(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...r){const n=Le(this);for(let s=0,a=this.length;s<a;s++)et(n,"get",s+"");const i=n[e](...r);return i===-1||i===!1?n[e](...r.map(Le)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...r){Vr();const n=Le(this)[e].apply(this,r);return jr(),n}}),t}function Fc(t){const e=Le(this);return et(e,"has",t),e.hasOwnProperty(t)}function Us(t=!1,e=!1){return function(n,i,s){if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_isShallow")return e;if(i==="__v_raw"&&s===(t?e?Qc:ol:e?al:sl).get(n))return n;const a=ce(n);if(!t){if(a&&be(ha,i))return Reflect.get(ha,i,s);if(i==="hasOwnProperty")return Fc}const d=Reflect.get(n,i,s);return(dn(i)?rl.has(i):Cc(i))||(t||et(n,"get",i),e)?d:Ge(d)?a&&Ms(i)?d:d.value:De(d)?t?vi(d):Ct(d):d}}const Nc=nl(),Uc=nl(!0);function nl(t=!1){return function(r,n,i,s){let a=r[n];if(Mr(a)&&Ge(a)&&!Ge(i))return!1;if(!t&&(!ei(i)&&!Mr(i)&&(a=Le(a),i=Le(i)),!ce(r)&&Ge(a)&&!Ge(i)))return a.value=i,!0;const d=ce(r)&&Ms(n)?Number(n)<r.length:be(r,n),u=Reflect.set(r,n,i,s);return r===Le(s)&&(d?fn(i,a)&&Nt(r,"set",n,i):Nt(r,"add",n,i)),u}}function Bc(t,e){const r=be(t,e);t[e];const n=Reflect.deleteProperty(t,e);return n&&r&&Nt(t,"delete",e,void 0),n}function Gc(t,e){const r=Reflect.has(t,e);return(!dn(e)||!rl.has(e))&&et(t,"has",e),r}function Vc(t){return et(t,"iterate",ce(t)?"length":Er),Reflect.ownKeys(t)}const il={get:Oc,set:Nc,deleteProperty:Bc,has:Gc,ownKeys:Vc},jc={get:Pc,set(t,e){return!0},deleteProperty(t,e){return!0}},Hc=Ve({},il,{get:xc,set:Uc}),Bs=t=>t,pi=t=>Reflect.getPrototypeOf(t);function Dn(t,e,r=!1,n=!1){t=t.__v_raw;const i=Le(t),s=Le(e);r||(e!==s&&et(i,"get",e),et(i,"get",s));const{has:a}=pi(i),d=n?Bs:r?js:hn;if(a.call(i,e))return d(t.get(e));if(a.call(i,s))return d(t.get(s));t!==i&&t.get(e)}function Rn(t,e=!1){const r=this.__v_raw,n=Le(r),i=Le(t);return e||(t!==i&&et(n,"has",t),et(n,"has",i)),t===i?r.has(t):r.has(t)||r.has(i)}function In(t,e=!1){return t=t.__v_raw,!e&&et(Le(t),"iterate",Er),Reflect.get(t,"size",t)}function ga(t){t=Le(t);const e=Le(this);return pi(e).has.call(e,t)||(e.add(t),Nt(e,"add",t,t)),this}function ma(t,e){e=Le(e);const r=Le(this),{has:n,get:i}=pi(r);let s=n.call(r,t);s||(t=Le(t),s=n.call(r,t));const a=i.call(r,t);return r.set(t,e),s?fn(e,a)&&Nt(r,"set",t,e):Nt(r,"add",t,e),this}function pa(t){const e=Le(this),{has:r,get:n}=pi(e);let i=r.call(e,t);i||(t=Le(t),i=r.call(e,t)),n&&n.call(e,t);const s=e.delete(t);return i&&Nt(e,"delete",t,void 0),s}function va(){const t=Le(this),e=t.size!==0,r=t.clear();return e&&Nt(t,"clear",void 0,void 0),r}function Cn(t,e){return function(n,i){const s=this,a=s.__v_raw,d=Le(a),u=e?Bs:t?js:hn;return!t&&et(d,"iterate",Er),a.forEach((o,y)=>n.call(i,u(o),u(y),s))}}function On(t,e,r){return function(...n){const i=this.__v_raw,s=Le(i),a=Ir(s),d=t==="entries"||t===Symbol.iterator&&a,u=t==="keys"&&a,o=i[t](...n),y=r?Bs:e?js:hn;return!e&&et(s,"iterate",u?as:Er),{next(){const{value:m,done:f}=o.next();return f?{value:m,done:f}:{value:d?[y(m[0]),y(m[1])]:y(m),done:f}},[Symbol.iterator](){return this}}}}function Vt(t){return function(...e){return t==="delete"?!1:this}}function Kc(){const t={get(s){return Dn(this,s)},get size(){return In(this)},has:Rn,add:ga,set:ma,delete:pa,clear:va,forEach:Cn(!1,!1)},e={get(s){return Dn(this,s,!1,!0)},get size(){return In(this)},has:Rn,add:ga,set:ma,delete:pa,clear:va,forEach:Cn(!1,!0)},r={get(s){return Dn(this,s,!0)},get size(){return In(this,!0)},has(s){return Rn.call(this,s,!0)},add:Vt("add"),set:Vt("set"),delete:Vt("delete"),clear:Vt("clear"),forEach:Cn(!0,!1)},n={get(s){return Dn(this,s,!0,!0)},get size(){return In(this,!0)},has(s){return Rn.call(this,s,!0)},add:Vt("add"),set:Vt("set"),delete:Vt("delete"),clear:Vt("clear"),forEach:Cn(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=On(s,!1,!1),r[s]=On(s,!0,!1),e[s]=On(s,!1,!0),n[s]=On(s,!0,!0)}),[t,r,e,n]}const[Wc,zc,Yc,qc]=Kc();function Gs(t,e){const r=e?t?qc:Yc:t?zc:Wc;return(n,i,s)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?n:Reflect.get(be(r,i)&&i in n?r:n,i,s)}const $c={get:Gs(!1,!1)},Zc={get:Gs(!1,!0)},Xc={get:Gs(!0,!1)},sl=new WeakMap,al=new WeakMap,ol=new WeakMap,Qc=new WeakMap;function Jc(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ed(t){return t.__v_skip||!Object.isExtensible(t)?0:Jc(fc(t))}function Ct(t){return Mr(t)?t:Vs(t,!1,il,$c,sl)}function ll(t){return Vs(t,!1,Hc,Zc,al)}function vi(t){return Vs(t,!0,jc,Xc,ol)}function Vs(t,e,r,n,i){if(!De(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=i.get(t);if(s)return s;const a=ed(t);if(a===0)return t;const d=new Proxy(t,a===2?n:r);return i.set(t,d),d}function Cr(t){return Mr(t)?Cr(t.__v_raw):!!(t&&t.__v_isReactive)}function Mr(t){return!!(t&&t.__v_isReadonly)}function ei(t){return!!(t&&t.__v_isShallow)}function ul(t){return Cr(t)||Mr(t)}function Le(t){const e=t&&t.__v_raw;return e?Le(e):t}function cl(t){return Xn(t,"__v_skip",!0),t}const hn=t=>De(t)?Ct(t):t,js=t=>De(t)?vi(t):t;function Hs(t){Qt&&vt&&(t=Le(t),tl(t.dep||(t.dep=Fs())))}function Ks(t,e){t=Le(t);const r=t.dep;r&&os(r)}function Ge(t){return!!(t&&t.__v_isRef===!0)}function Ke(t){return dl(t,!1)}function Hn(t){return dl(t,!0)}function dl(t,e){return Ge(t)?t:new td(t,e)}class td{constructor(e,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?e:Le(e),this._value=r?e:hn(e)}get value(){return Hs(this),this._value}set value(e){const r=this.__v_isShallow||ei(e)||Mr(e);e=r?e:Le(e),fn(e,this._rawValue)&&(this._rawValue=e,this._value=r?e:hn(e),Ks(this))}}function J(t){return Ge(t)?t.value:t}const rd={get:(t,e,r)=>J(Reflect.get(t,e,r)),set:(t,e,r,n)=>{const i=t[e];return Ge(i)&&!Ge(r)?(i.value=r,!0):Reflect.set(t,e,r,n)}};function fl(t){return Cr(t)?t:new Proxy(t,rd)}class nd{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:r,set:n}=e(()=>Hs(this),()=>Ks(this));this._get=r,this._set=n}get value(){return this._get()}set value(e){this._set(e)}}function id(t){return new nd(t)}class sd{constructor(e,r,n){this._object=e,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return Ic(Le(this._object),this._key)}}class ad{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function od(t,e,r){return Ge(t)?t:ve(t)?new ad(t):De(t)&&arguments.length>1?ld(t,e,r):Ke(t)}function ld(t,e,r){const n=t[e];return Ge(n)?n:new sd(t,e,r)}class ud{constructor(e,r,n,i){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Ns(e,()=>{this._dirty||(this._dirty=!0,Ks(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const e=Le(this);return Hs(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function cd(t,e,r=!1){let n,i;const s=ve(t);return s?(n=t,i=St):(n=t.get,i=t.set),new ud(n,i,s||!i,r)}function Jt(t,e,r,n){let i;try{i=n?t(...n):t()}catch(s){yi(s,e,r)}return i}function ft(t,e,r,n){if(ve(t)){const s=Jt(t,e,r,n);return s&&zo(s)&&s.catch(a=>{yi(a,e,r)}),s}const i=[];for(let s=0;s<t.length;s++)i.push(ft(t[s],e,r,n));return i}function yi(t,e,r,n=!0){const i=e?e.vnode:null;if(e){let s=e.parent;const a=e.proxy,d=r;for(;s;){const o=s.ec;if(o){for(let y=0;y<o.length;y++)if(o[y](t,a,d)===!1)return}s=s.parent}const u=e.appContext.config.errorHandler;if(u){Jt(u,null,10,[t,a,d]);return}}dd(t,r,i,n)}function dd(t,e,r,n=!0){console.error(t)}let gn=!1,ls=!1;const ze=[];let Dt=0;const Or=[];let Pt=null,fr=0;const hl=Promise.resolve();let Ws=null;function Ei(t){const e=Ws||hl;return t?e.then(this?t.bind(this):t):e}function fd(t){let e=Dt+1,r=ze.length;for(;e<r;){const n=e+r>>>1;mn(ze[n])<t?e=n+1:r=n}return e}function zs(t){(!ze.length||!ze.includes(t,gn&&t.allowRecurse?Dt+1:Dt))&&(t.id==null?ze.push(t):ze.splice(fd(t.id),0,t),gl())}function gl(){!gn&&!ls&&(ls=!0,Ws=hl.then(pl))}function hd(t){const e=ze.indexOf(t);e>Dt&&ze.splice(e,1)}function gd(t){ce(t)?Or.push(...t):(!Pt||!Pt.includes(t,t.allowRecurse?fr+1:fr))&&Or.push(t),gl()}function ya(t,e=gn?Dt+1:0){for(;e<ze.length;e++){const r=ze[e];r&&r.pre&&(ze.splice(e,1),e--,r())}}function ml(t){if(Or.length){const e=[...new Set(Or)];if(Or.length=0,Pt){Pt.push(...e);return}for(Pt=e,Pt.sort((r,n)=>mn(r)-mn(n)),fr=0;fr<Pt.length;fr++)Pt[fr]();Pt=null,fr=0}}const mn=t=>t.id==null?1/0:t.id,md=(t,e)=>{const r=mn(t)-mn(e);if(r===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return r};function pl(t){ls=!1,gn=!0,ze.sort(md);const e=St;try{for(Dt=0;Dt<ze.length;Dt++){const r=ze[Dt];r&&r.active!==!1&&Jt(r,null,14)}}finally{Dt=0,ze.length=0,ml(),gn=!1,Ws=null,(ze.length||Or.length)&&pl()}}function pd(t,e,...r){if(t.isUnmounted)return;const n=t.vnode.props||Ie;let i=r;const s=e.startsWith("update:"),a=s&&e.slice(7);if(a&&a in n){const y=`${a==="modelValue"?"model":a}Modifiers`,{number:m,trim:f}=n[y]||Ie;f&&(i=r.map(L=>Me(L)?L.trim():L)),m&&(i=r.map(Qn))}let d,u=n[d=Fi(e)]||n[d=Fi(It(e))];!u&&s&&(u=n[d=Fi(Ar(e))]),u&&ft(u,t,6,i);const o=n[d+"Once"];if(o){if(!t.emitted)t.emitted={};else if(t.emitted[d])return;t.emitted[d]=!0,ft(o,t,6,i)}}function vl(t,e,r=!1){const n=e.emitsCache,i=n.get(t);if(i!==void 0)return i;const s=t.emits;let a={},d=!1;if(!ve(t)){const u=o=>{const y=vl(o,e,!0);y&&(d=!0,Ve(a,y))};!r&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}return!s&&!d?(De(t)&&n.set(t,null),null):(ce(s)?s.forEach(u=>a[u]=null):Ve(a,s),De(t)&&n.set(t,a),a)}function Ti(t,e){return!t||!di(e)?!1:(e=e.slice(2).replace(/Once$/,""),be(t,e[0].toLowerCase()+e.slice(1))||be(t,Ar(e))||be(t,e))}let nt=null,Si=null;function ti(t){const e=nt;return nt=t,Si=t&&t.type.__scopeId||null,e}function rr(t){Si=t}function nr(){Si=null}function Fr(t,e=nt,r){if(!e||t._n)return t;const n=(...i)=>{n._d&&Ia(-1);const s=ti(e);let a;try{a=t(...i)}finally{ti(s),n._d&&Ia(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Ni(t){const{type:e,vnode:r,proxy:n,withProxy:i,props:s,propsOptions:[a],slots:d,attrs:u,emit:o,render:y,renderCache:m,data:f,setupState:L,ctx:_,inheritAttrs:E}=t;let l,g;const c=ti(t);try{if(r.shapeFlag&4){const S=i||n;l=kt(y.call(S,S,m,s,L,f,_)),g=u}else{const S=e;l=kt(S.length>1?S(s,{attrs:u,slots:d,emit:o}):S(s,null)),g=e.props?u:vd(u)}}catch(S){an.length=0,yi(S,t,1),l=pe(bt)}let T=l;if(g&&E!==!1){const S=Object.keys(g),{shapeFlag:p}=T;S.length&&p&7&&(a&&S.some(xs)&&(g=yd(g,a)),T=tr(T,g))}return r.dirs&&(T=tr(T),T.dirs=T.dirs?T.dirs.concat(r.dirs):r.dirs),r.transition&&(T.transition=r.transition),l=T,ti(c),l}const vd=t=>{let e;for(const r in t)(r==="class"||r==="style"||di(r))&&((e||(e={}))[r]=t[r]);return e},yd=(t,e)=>{const r={};for(const n in t)(!xs(n)||!(n.slice(9)in e))&&(r[n]=t[n]);return r};function Ed(t,e,r){const{props:n,children:i,component:s}=t,{props:a,children:d,patchFlag:u}=e,o=s.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&u>=0){if(u&1024)return!0;if(u&16)return n?Ea(n,a,o):!!a;if(u&8){const y=e.dynamicProps;for(let m=0;m<y.length;m++){const f=y[m];if(a[f]!==n[f]&&!Ti(o,f))return!0}}}else return(i||d)&&(!d||!d.$stable)?!0:n===a?!1:n?a?Ea(n,a,o):!0:!!a;return!1}function Ea(t,e,r){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(e[s]!==t[s]&&!Ti(r,s))return!0}return!1}function Td({vnode:t,parent:e},r){for(;e&&e.subTree===t;)(t=e.vnode).el=r,e=e.parent}const Sd=t=>t.__isSuspense;function bd(t,e){e&&e.pendingBranch?ce(t)?e.effects.push(...t):e.effects.push(t):gd(t)}function Ad(t,e){return bi(t,null,e)}function Ld(t,e){return bi(t,null,{flush:"post"})}const xn={};function Rt(t,e,r){return bi(t,e,r)}function bi(t,e,{immediate:r,deep:n,flush:i,onTrack:s,onTrigger:a}=Ie){var d;const u=Xo()===((d=He)==null?void 0:d.scope)?He:null;let o,y=!1,m=!1;if(Ge(t)?(o=()=>t.value,y=ei(t)):Cr(t)?(o=()=>t,n=!0):ce(t)?(m=!0,y=t.some(S=>Cr(S)||ei(S)),o=()=>t.map(S=>{if(Ge(S))return S.value;if(Cr(S))return pr(S);if(ve(S))return Jt(S,u,2)})):ve(t)?e?o=()=>Jt(t,u,2):o=()=>{if(!(u&&u.isUnmounted))return f&&f(),ft(t,u,3,[L])}:o=St,e&&n){const S=o;o=()=>pr(S())}let f,L=S=>{f=c.onStop=()=>{Jt(S,u,4)}},_;if(vn)if(L=St,e?r&&ft(e,u,3,[o(),m?[]:void 0,L]):o(),i==="sync"){const S=yf();_=S.__watcherHandles||(S.__watcherHandles=[])}else return St;let E=m?new Array(t.length).fill(xn):xn;const l=()=>{if(c.active)if(e){const S=c.run();(n||y||(m?S.some((p,A)=>fn(p,E[A])):fn(S,E)))&&(f&&f(),ft(e,u,3,[S,E===xn?void 0:m&&E[0]===xn?[]:E,L]),E=S)}else c.run()};l.allowRecurse=!!e;let g;i==="sync"?g=l:i==="post"?g=()=>Qe(l,u&&u.suspense):(l.pre=!0,u&&(l.id=u.uid),g=()=>zs(l));const c=new Ns(o,g);e?r?l():E=c.run():i==="post"?Qe(c.run.bind(c),u&&u.suspense):c.run();const T=()=>{c.stop(),u&&u.scope&&Ps(u.scope.effects,c)};return _&&_.push(T),T}function wd(t,e,r){const n=this.proxy,i=Me(t)?t.includes(".")?yl(n,t):()=>n[t]:t.bind(n,n);let s;ve(e)?s=e:(s=e.handler,r=e);const a=He;Nr(this);const d=bi(i,s.bind(n),r);return a?Nr(a):Tr(),d}function yl(t,e){const r=e.split(".");return()=>{let n=t;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}function pr(t,e){if(!De(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),Ge(t))pr(t.value,e);else if(ce(t))for(let r=0;r<t.length;r++)pr(t[r],e);else if(fi(t)||Ir(t))t.forEach(r=>{pr(r,e)});else if(qo(t))for(const r in t)pr(t[r],e);return t}function Ze(t,e){const r=nt;if(r===null)return t;const n=Di(r)||r.proxy,i=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[a,d,u,o=Ie]=e[s];a&&(ve(a)&&(a={mounted:a,updated:a}),a.deep&&pr(d),i.push({dir:a,instance:n,value:d,oldValue:void 0,arg:u,modifiers:o}))}return t}function ar(t,e,r,n){const i=t.dirs,s=e&&e.dirs;for(let a=0;a<i.length;a++){const d=i[a];s&&(d.oldValue=s[a].value);let u=d.dir[n];u&&(Vr(),ft(u,r,8,[t.el,d,t,e]),jr())}}function _d(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return bn(()=>{t.isMounted=!0}),Al(()=>{t.isUnmounting=!0}),t}const lt=[Function,Array],El={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:lt,onEnter:lt,onAfterEnter:lt,onEnterCancelled:lt,onBeforeLeave:lt,onLeave:lt,onAfterLeave:lt,onLeaveCancelled:lt,onBeforeAppear:lt,onAppear:lt,onAfterAppear:lt,onAppearCancelled:lt},kd={name:"BaseTransition",props:El,setup(t,{slots:e}){const r=ki(),n=_d();let i;return()=>{const s=e.default&&Sl(e.default(),!0);if(!s||!s.length)return;let a=s[0];if(s.length>1){for(const E of s)if(E.type!==bt){a=E;break}}const d=Le(t),{mode:u}=d;if(n.isLeaving)return Ui(a);const o=Ta(a);if(!o)return Ui(a);const y=us(o,d,n,r);cs(o,y);const m=r.subTree,f=m&&Ta(m);let L=!1;const{getTransitionKey:_}=o.type;if(_){const E=_();i===void 0?i=E:E!==i&&(i=E,L=!0)}if(f&&f.type!==bt&&(!hr(o,f)||L)){const E=us(f,d,n,r);if(cs(f,E),u==="out-in")return n.isLeaving=!0,E.afterLeave=()=>{n.isLeaving=!1,r.update.active!==!1&&r.update()},Ui(a);u==="in-out"&&o.type!==bt&&(E.delayLeave=(l,g,c)=>{const T=Tl(n,f);T[String(f.key)]=f,l._leaveCb=()=>{g(),l._leaveCb=void 0,delete y.delayedLeave},y.delayedLeave=c})}return a}}},Dd=kd;function Tl(t,e){const{leavingVNodes:r}=t;let n=r.get(e.type);return n||(n=Object.create(null),r.set(e.type,n)),n}function us(t,e,r,n){const{appear:i,mode:s,persisted:a=!1,onBeforeEnter:d,onEnter:u,onAfterEnter:o,onEnterCancelled:y,onBeforeLeave:m,onLeave:f,onAfterLeave:L,onLeaveCancelled:_,onBeforeAppear:E,onAppear:l,onAfterAppear:g,onAppearCancelled:c}=e,T=String(t.key),S=Tl(r,t),p=(w,k)=>{w&&ft(w,n,9,k)},A=(w,k)=>{const h=k[1];p(w,k),ce(w)?w.every(v=>v.length<=1)&&h():w.length<=1&&h()},D={mode:s,persisted:a,beforeEnter(w){let k=d;if(!r.isMounted)if(i)k=E||d;else return;w._leaveCb&&w._leaveCb(!0);const h=S[T];h&&hr(t,h)&&h.el._leaveCb&&h.el._leaveCb(),p(k,[w])},enter(w){let k=u,h=o,v=y;if(!r.isMounted)if(i)k=l||u,h=g||o,v=c||y;else return;let b=!1;const R=w._enterCb=I=>{b||(b=!0,I?p(v,[w]):p(h,[w]),D.delayedLeave&&D.delayedLeave(),w._enterCb=void 0)};k?A(k,[w,R]):R()},leave(w,k){const h=String(t.key);if(w._enterCb&&w._enterCb(!0),r.isUnmounting)return k();p(m,[w]);let v=!1;const b=w._leaveCb=R=>{v||(v=!0,k(),R?p(_,[w]):p(L,[w]),w._leaveCb=void 0,S[h]===t&&delete S[h])};S[h]=t,f?A(f,[w,b]):b()},clone(w){return us(w,e,r,n)}};return D}function Ui(t){if(Ai(t))return t=tr(t),t.children=null,t}function Ta(t){return Ai(t)?t.children?t.children[0]:void 0:t}function cs(t,e){t.shapeFlag&6&&t.component?cs(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Sl(t,e=!1,r){let n=[],i=0;for(let s=0;s<t.length;s++){let a=t[s];const d=r==null?a.key:String(r)+String(a.key!=null?a.key:s);a.type===Be?(a.patchFlag&128&&i++,n=n.concat(Sl(a.children,e,d))):(e||a.type!==bt)&&n.push(d!=null?tr(a,{key:d}):a)}if(i>1)for(let s=0;s<n.length;s++)n[s].patchFlag=-2;return n}function at(t,e){return ve(t)?(()=>Ve({name:t.name},e,{setup:t}))():t}const Kn=t=>!!t.type.__asyncLoader,Ai=t=>t.type.__isKeepAlive;function Rd(t,e){bl(t,"a",e)}function Id(t,e){bl(t,"da",e)}function bl(t,e,r=He){const n=t.__wdc||(t.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(Li(e,n,r),r){let i=r.parent;for(;i&&i.parent;)Ai(i.parent.vnode)&&Cd(n,e,r,i),i=i.parent}}function Cd(t,e,r,n){const i=Li(e,t,n,!0);An(()=>{Ps(n[e],i)},r)}function Li(t,e,r=He,n=!1){if(r){const i=r[t]||(r[t]=[]),s=e.__weh||(e.__weh=(...a)=>{if(r.isUnmounted)return;Vr(),Nr(r);const d=ft(e,r,t,a);return Tr(),jr(),d});return n?i.unshift(s):i.push(s),s}}const Bt=t=>(e,r=He)=>(!vn||t==="sp")&&Li(t,(...n)=>e(...n),r),Od=Bt("bm"),bn=Bt("m"),xd=Bt("bu"),Pd=Bt("u"),Al=Bt("bum"),An=Bt("um"),Md=Bt("sp"),Fd=Bt("rtg"),Nd=Bt("rtc");function Ud(t,e=He){Li("ec",t,e)}const Ll="components";function wl(t,e){return Gd(Ll,t,!0,e)||t}const Bd=Symbol.for("v-ndc");function Gd(t,e,r=!0,n=!1){const i=nt||He;if(i){const s=i.type;if(t===Ll){const d=mf(s,!1);if(d&&(d===e||d===It(e)||d===gi(It(e))))return s}const a=Sa(i[t]||s[t],e)||Sa(i.appContext[t],e);return!a&&n?s:a}}function Sa(t,e){return t&&(t[e]||t[It(e)]||t[gi(It(e))])}function br(t,e,r,n){let i;const s=r&&r[n];if(ce(t)||Me(t)){i=new Array(t.length);for(let a=0,d=t.length;a<d;a++)i[a]=e(t[a],a,void 0,s&&s[a])}else if(typeof t=="number"){i=new Array(t);for(let a=0;a<t;a++)i[a]=e(a+1,a,void 0,s&&s[a])}else if(De(t))if(t[Symbol.iterator])i=Array.from(t,(a,d)=>e(a,d,void 0,s&&s[d]));else{const a=Object.keys(t);i=new Array(a.length);for(let d=0,u=a.length;d<u;d++){const o=a[d];i[d]=e(t[o],o,d,s&&s[d])}}else i=[];return r&&(r[n]=i),i}const ds=t=>t?Ul(t)?Di(t)||t.proxy:ds(t.parent):null,sn=Ve(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>ds(t.parent),$root:t=>ds(t.root),$emit:t=>t.emit,$options:t=>Ys(t),$forceUpdate:t=>t.f||(t.f=()=>zs(t.update)),$nextTick:t=>t.n||(t.n=Ei.bind(t.proxy)),$watch:t=>wd.bind(t)}),Bi=(t,e)=>t!==Ie&&!t.__isScriptSetup&&be(t,e),Vd={get({_:t},e){const{ctx:r,setupState:n,data:i,props:s,accessCache:a,type:d,appContext:u}=t;let o;if(e[0]!=="$"){const L=a[e];if(L!==void 0)switch(L){case 1:return n[e];case 2:return i[e];case 4:return r[e];case 3:return s[e]}else{if(Bi(n,e))return a[e]=1,n[e];if(i!==Ie&&be(i,e))return a[e]=2,i[e];if((o=t.propsOptions[0])&&be(o,e))return a[e]=3,s[e];if(r!==Ie&&be(r,e))return a[e]=4,r[e];fs&&(a[e]=0)}}const y=sn[e];let m,f;if(y)return e==="$attrs"&&et(t,"get",e),y(t);if((m=d.__cssModules)&&(m=m[e]))return m;if(r!==Ie&&be(r,e))return a[e]=4,r[e];if(f=u.config.globalProperties,be(f,e))return f[e]},set({_:t},e,r){const{data:n,setupState:i,ctx:s}=t;return Bi(i,e)?(i[e]=r,!0):n!==Ie&&be(n,e)?(n[e]=r,!0):be(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:i,propsOptions:s}},a){let d;return!!r[a]||t!==Ie&&be(t,a)||Bi(e,a)||(d=s[0])&&be(d,a)||be(n,a)||be(sn,a)||be(i.config.globalProperties,a)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:be(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}};function jd(){return Hd().attrs}function Hd(){const t=ki();return t.setupContext||(t.setupContext=Gl(t))}function ba(t){return ce(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}let fs=!0;function Kd(t){const e=Ys(t),r=t.proxy,n=t.ctx;fs=!1,e.beforeCreate&&Aa(e.beforeCreate,t,"bc");const{data:i,computed:s,methods:a,watch:d,provide:u,inject:o,created:y,beforeMount:m,mounted:f,beforeUpdate:L,updated:_,activated:E,deactivated:l,beforeDestroy:g,beforeUnmount:c,destroyed:T,unmounted:S,render:p,renderTracked:A,renderTriggered:D,errorCaptured:w,serverPrefetch:k,expose:h,inheritAttrs:v,components:b,directives:R,filters:I}=e;if(o&&Wd(o,n,null),a)for(const O in a){const P=a[O];ve(P)&&(n[O]=P.bind(r))}if(i){const O=i.call(r,r);De(O)&&(t.data=Ct(O))}if(fs=!0,s)for(const O in s){const P=s[O],M=ve(P)?P.bind(r,r):ve(P.get)?P.get.bind(r,r):St,F=!ve(P)&&ve(P.set)?P.set.bind(r):St,B=Ce({get:M,set:F});Object.defineProperty(n,O,{enumerable:!0,configurable:!0,get:()=>B.value,set:j=>B.value=j})}if(d)for(const O in d)_l(d[O],n,r,O);if(u){const O=ve(u)?u.call(r):u;Reflect.ownKeys(O).forEach(P=>{Wn(P,O[P])})}y&&Aa(y,t,"c");function x(O,P){ce(P)?P.forEach(M=>O(M.bind(r))):P&&O(P.bind(r))}if(x(Od,m),x(bn,f),x(xd,L),x(Pd,_),x(Rd,E),x(Id,l),x(Ud,w),x(Nd,A),x(Fd,D),x(Al,c),x(An,S),x(Md,k),ce(h))if(h.length){const O=t.exposed||(t.exposed={});h.forEach(P=>{Object.defineProperty(O,P,{get:()=>r[P],set:M=>r[P]=M})})}else t.exposed||(t.exposed={});p&&t.render===St&&(t.render=p),v!=null&&(t.inheritAttrs=v),b&&(t.components=b),R&&(t.directives=R)}function Wd(t,e,r=St){ce(t)&&(t=hs(t));for(const n in t){const i=t[n];let s;De(i)?"default"in i?s=Ft(i.from||n,i.default,!0):s=Ft(i.from||n):s=Ft(i),Ge(s)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):e[n]=s}}function Aa(t,e,r){ft(ce(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,r)}function _l(t,e,r,n){const i=n.includes(".")?yl(r,n):()=>r[n];if(Me(t)){const s=e[t];ve(s)&&Rt(i,s)}else if(ve(t))Rt(i,t.bind(r));else if(De(t))if(ce(t))t.forEach(s=>_l(s,e,r,n));else{const s=ve(t.handler)?t.handler.bind(r):e[t.handler];ve(s)&&Rt(i,s,t)}}function Ys(t){const e=t.type,{mixins:r,extends:n}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:a}}=t.appContext,d=s.get(e);let u;return d?u=d:!i.length&&!r&&!n?u=e:(u={},i.length&&i.forEach(o=>ri(u,o,a,!0)),ri(u,e,a)),De(e)&&s.set(e,u),u}function ri(t,e,r,n=!1){const{mixins:i,extends:s}=e;s&&ri(t,s,r,!0),i&&i.forEach(a=>ri(t,a,r,!0));for(const a in e)if(!(n&&a==="expose")){const d=zd[a]||r&&r[a];t[a]=d?d(t[a],e[a]):e[a]}return t}const zd={data:La,props:wa,emits:wa,methods:tn,computed:tn,beforeCreate:$e,created:$e,beforeMount:$e,mounted:$e,beforeUpdate:$e,updated:$e,beforeDestroy:$e,beforeUnmount:$e,destroyed:$e,unmounted:$e,activated:$e,deactivated:$e,errorCaptured:$e,serverPrefetch:$e,components:tn,directives:tn,watch:qd,provide:La,inject:Yd};function La(t,e){return e?t?function(){return Ve(ve(t)?t.call(this,this):t,ve(e)?e.call(this,this):e)}:e:t}function Yd(t,e){return tn(hs(t),hs(e))}function hs(t){if(ce(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function $e(t,e){return t?[...new Set([].concat(t,e))]:e}function tn(t,e){return t?Ve(Object.create(null),t,e):e}function wa(t,e){return t?ce(t)&&ce(e)?[...new Set([...t,...e])]:Ve(Object.create(null),ba(t),ba(e??{})):e}function qd(t,e){if(!t)return e;if(!e)return t;const r=Ve(Object.create(null),t);for(const n in e)r[n]=$e(t[n],e[n]);return r}function kl(){return{app:null,config:{isNativeTag:uc,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let $d=0;function Zd(t,e){return function(n,i=null){ve(n)||(n=Ve({},n)),i!=null&&!De(i)&&(i=null);const s=kl(),a=new Set;let d=!1;const u=s.app={_uid:$d++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:Ef,get config(){return s.config},set config(o){},use(o,...y){return a.has(o)||(o&&ve(o.install)?(a.add(o),o.install(u,...y)):ve(o)&&(a.add(o),o(u,...y))),u},mixin(o){return s.mixins.includes(o)||s.mixins.push(o),u},component(o,y){return y?(s.components[o]=y,u):s.components[o]},directive(o,y){return y?(s.directives[o]=y,u):s.directives[o]},mount(o,y,m){if(!d){const f=pe(n,i);return f.appContext=s,y&&e?e(f,o):t(f,o,m),d=!0,u._container=o,o.__vue_app__=u,Di(f.component)||f.component.proxy}},unmount(){d&&(t(null,u._container),delete u._container.__vue_app__)},provide(o,y){return s.provides[o]=y,u},runWithContext(o){ni=u;try{return o()}finally{ni=null}}};return u}}let ni=null;function Wn(t,e){if(He){let r=He.provides;const n=He.parent&&He.parent.provides;n===r&&(r=He.provides=Object.create(n)),r[t]=e}}function Ft(t,e,r=!1){const n=He||nt;if(n||ni){const i=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:ni._context.provides;if(i&&t in i)return i[t];if(arguments.length>1)return r&&ve(e)?e.call(n&&n.proxy):e}}function Xd(t,e,r,n=!1){const i={},s={};Xn(s,_i,1),t.propsDefaults=Object.create(null),Dl(t,e,i,s);for(const a in t.propsOptions[0])a in i||(i[a]=void 0);r?t.props=n?i:ll(i):t.type.props?t.props=i:t.props=s,t.attrs=s}function Qd(t,e,r,n){const{props:i,attrs:s,vnode:{patchFlag:a}}=t,d=Le(i),[u]=t.propsOptions;let o=!1;if((n||a>0)&&!(a&16)){if(a&8){const y=t.vnode.dynamicProps;for(let m=0;m<y.length;m++){let f=y[m];if(Ti(t.emitsOptions,f))continue;const L=e[f];if(u)if(be(s,f))L!==s[f]&&(s[f]=L,o=!0);else{const _=It(f);i[_]=gs(u,d,_,L,t,!1)}else L!==s[f]&&(s[f]=L,o=!0)}}}else{Dl(t,e,i,s)&&(o=!0);let y;for(const m in d)(!e||!be(e,m)&&((y=Ar(m))===m||!be(e,y)))&&(u?r&&(r[m]!==void 0||r[y]!==void 0)&&(i[m]=gs(u,d,m,void 0,t,!0)):delete i[m]);if(s!==d)for(const m in s)(!e||!be(e,m))&&(delete s[m],o=!0)}o&&Nt(t,"set","$attrs")}function Dl(t,e,r,n){const[i,s]=t.propsOptions;let a=!1,d;if(e)for(let u in e){if(Vn(u))continue;const o=e[u];let y;i&&be(i,y=It(u))?!s||!s.includes(y)?r[y]=o:(d||(d={}))[y]=o:Ti(t.emitsOptions,u)||(!(u in n)||o!==n[u])&&(n[u]=o,a=!0)}if(s){const u=Le(r),o=d||Ie;for(let y=0;y<s.length;y++){const m=s[y];r[m]=gs(i,u,m,o[m],t,!be(o,m))}}return a}function gs(t,e,r,n,i,s){const a=t[r];if(a!=null){const d=be(a,"default");if(d&&n===void 0){const u=a.default;if(a.type!==Function&&!a.skipFactory&&ve(u)){const{propsDefaults:o}=i;r in o?n=o[r]:(Nr(i),n=o[r]=u.call(null,e),Tr())}else n=u}a[0]&&(s&&!d?n=!1:a[1]&&(n===""||n===Ar(r))&&(n=!0))}return n}function Rl(t,e,r=!1){const n=e.propsCache,i=n.get(t);if(i)return i;const s=t.props,a={},d=[];let u=!1;if(!ve(t)){const y=m=>{u=!0;const[f,L]=Rl(m,e,!0);Ve(a,f),L&&d.push(...L)};!r&&e.mixins.length&&e.mixins.forEach(y),t.extends&&y(t.extends),t.mixins&&t.mixins.forEach(y)}if(!s&&!u)return De(t)&&n.set(t,Rr),Rr;if(ce(s))for(let y=0;y<s.length;y++){const m=It(s[y]);_a(m)&&(a[m]=Ie)}else if(s)for(const y in s){const m=It(y);if(_a(m)){const f=s[y],L=a[m]=ce(f)||ve(f)?{type:f}:Ve({},f);if(L){const _=Ra(Boolean,L.type),E=Ra(String,L.type);L[0]=_>-1,L[1]=E<0||_<E,(_>-1||be(L,"default"))&&d.push(m)}}}const o=[a,d];return De(t)&&n.set(t,o),o}function _a(t){return t[0]!=="$"}function ka(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function Da(t,e){return ka(t)===ka(e)}function Ra(t,e){return ce(e)?e.findIndex(r=>Da(r,t)):ve(e)&&Da(e,t)?0:-1}const Il=t=>t[0]==="_"||t==="$stable",qs=t=>ce(t)?t.map(kt):[kt(t)],Jd=(t,e,r)=>{if(e._n)return e;const n=Fr((...i)=>qs(e(...i)),r);return n._c=!1,n},Cl=(t,e,r)=>{const n=t._ctx;for(const i in t){if(Il(i))continue;const s=t[i];if(ve(s))e[i]=Jd(i,s,n);else if(s!=null){const a=qs(s);e[i]=()=>a}}},Ol=(t,e)=>{const r=qs(e);t.slots.default=()=>r},ef=(t,e)=>{if(t.vnode.shapeFlag&32){const r=e._;r?(t.slots=Le(e),Xn(e,"_",r)):Cl(e,t.slots={})}else t.slots={},e&&Ol(t,e);Xn(t.slots,_i,1)},tf=(t,e,r)=>{const{vnode:n,slots:i}=t;let s=!0,a=Ie;if(n.shapeFlag&32){const d=e._;d?r&&d===1?s=!1:(Ve(i,e),!r&&d===1&&delete i._):(s=!e.$stable,Cl(e,i)),a=e}else e&&(Ol(t,e),a={default:1});if(s)for(const d in i)!Il(d)&&!(d in a)&&delete i[d]};function ms(t,e,r,n,i=!1){if(ce(t)){t.forEach((f,L)=>ms(f,e&&(ce(e)?e[L]:e),r,n,i));return}if(Kn(n)&&!i)return;const s=n.shapeFlag&4?Di(n.component)||n.component.proxy:n.el,a=i?null:s,{i:d,r:u}=t,o=e&&e.r,y=d.refs===Ie?d.refs={}:d.refs,m=d.setupState;if(o!=null&&o!==u&&(Me(o)?(y[o]=null,be(m,o)&&(m[o]=null)):Ge(o)&&(o.value=null)),ve(u))Jt(u,d,12,[a,y]);else{const f=Me(u),L=Ge(u);if(f||L){const _=()=>{if(t.f){const E=f?be(m,u)?m[u]:y[u]:u.value;i?ce(E)&&Ps(E,s):ce(E)?E.includes(s)||E.push(s):f?(y[u]=[s],be(m,u)&&(m[u]=y[u])):(u.value=[s],t.k&&(y[t.k]=u.value))}else f?(y[u]=a,be(m,u)&&(m[u]=a)):L&&(u.value=a,t.k&&(y[t.k]=a))};a?(_.id=-1,Qe(_,r)):_()}}}const Qe=bd;function rf(t){return nf(t)}function nf(t,e){const r=is();r.__VUE__=!0;const{insert:n,remove:i,patchProp:s,createElement:a,createText:d,createComment:u,setText:o,setElementText:y,parentNode:m,nextSibling:f,setScopeId:L=St,insertStaticContent:_}=t,E=(N,U,G,H=null,W=null,$=null,ee=!1,X=null,te=!!U.dynamicChildren)=>{if(N===U)return;N&&!hr(N,U)&&(H=V(N),j(N,W,$,!0),N=null),U.patchFlag===-2&&(te=!1,U.dynamicChildren=null);const{type:Z,ref:le,shapeFlag:se}=U;switch(Z){case wi:l(N,U,G,H);break;case bt:g(N,U,G,H);break;case zn:N==null&&c(U,G,H,ee);break;case Be:b(N,U,G,H,W,$,ee,X,te);break;default:se&1?p(N,U,G,H,W,$,ee,X,te):se&6?R(N,U,G,H,W,$,ee,X,te):(se&64||se&128)&&Z.process(N,U,G,H,W,$,ee,X,te,Y)}le!=null&&W&&ms(le,N&&N.ref,$,U||N,!U)},l=(N,U,G,H)=>{if(N==null)n(U.el=d(U.children),G,H);else{const W=U.el=N.el;U.children!==N.children&&o(W,U.children)}},g=(N,U,G,H)=>{N==null?n(U.el=u(U.children||""),G,H):U.el=N.el},c=(N,U,G,H)=>{[N.el,N.anchor]=_(N.children,U,G,H,N.el,N.anchor)},T=({el:N,anchor:U},G,H)=>{let W;for(;N&&N!==U;)W=f(N),n(N,G,H),N=W;n(U,G,H)},S=({el:N,anchor:U})=>{let G;for(;N&&N!==U;)G=f(N),i(N),N=G;i(U)},p=(N,U,G,H,W,$,ee,X,te)=>{ee=ee||U.type==="svg",N==null?A(U,G,H,W,$,ee,X,te):k(N,U,W,$,ee,X,te)},A=(N,U,G,H,W,$,ee,X)=>{let te,Z;const{type:le,props:se,shapeFlag:oe,transition:de,dirs:fe}=N;if(te=N.el=a(N.type,$,se&&se.is,se),oe&8?y(te,N.children):oe&16&&w(N.children,te,null,H,W,$&&le!=="foreignObject",ee,X),fe&&ar(N,null,H,"created"),D(te,N,N.scopeId,ee,H),se){for(const Ee in se)Ee!=="value"&&!Vn(Ee)&&s(te,Ee,null,se[Ee],$,N.children,H,W,ne);"value"in se&&s(te,"value",null,se.value),(Z=se.onVnodeBeforeMount)&&_t(Z,H,N)}fe&&ar(N,null,H,"beforeMount");const ye=(!W||W&&!W.pendingBranch)&&de&&!de.persisted;ye&&de.beforeEnter(te),n(te,U,G),((Z=se&&se.onVnodeMounted)||ye||fe)&&Qe(()=>{Z&&_t(Z,H,N),ye&&de.enter(te),fe&&ar(N,null,H,"mounted")},W)},D=(N,U,G,H,W)=>{if(G&&L(N,G),H)for(let $=0;$<H.length;$++)L(N,H[$]);if(W){let $=W.subTree;if(U===$){const ee=W.vnode;D(N,ee,ee.scopeId,ee.slotScopeIds,W.parent)}}},w=(N,U,G,H,W,$,ee,X,te=0)=>{for(let Z=te;Z<N.length;Z++){const le=N[Z]=X?Yt(N[Z]):kt(N[Z]);E(null,le,U,G,H,W,$,ee,X)}},k=(N,U,G,H,W,$,ee)=>{const X=U.el=N.el;let{patchFlag:te,dynamicChildren:Z,dirs:le}=U;te|=N.patchFlag&16;const se=N.props||Ie,oe=U.props||Ie;let de;G&&or(G,!1),(de=oe.onVnodeBeforeUpdate)&&_t(de,G,U,N),le&&ar(U,N,G,"beforeUpdate"),G&&or(G,!0);const fe=W&&U.type!=="foreignObject";if(Z?h(N.dynamicChildren,Z,X,G,H,fe,$):ee||P(N,U,X,null,G,H,fe,$,!1),te>0){if(te&16)v(X,U,se,oe,G,H,W);else if(te&2&&se.class!==oe.class&&s(X,"class",null,oe.class,W),te&4&&s(X,"style",se.style,oe.style,W),te&8){const ye=U.dynamicProps;for(let Ee=0;Ee<ye.length;Ee++){const ke=ye[Ee],xe=se[ke],ot=oe[ke];(ot!==xe||ke==="value")&&s(X,ke,xe,ot,W,N.children,G,H,ne)}}te&1&&N.children!==U.children&&y(X,U.children)}else!ee&&Z==null&&v(X,U,se,oe,G,H,W);((de=oe.onVnodeUpdated)||le)&&Qe(()=>{de&&_t(de,G,U,N),le&&ar(U,N,G,"updated")},H)},h=(N,U,G,H,W,$,ee)=>{for(let X=0;X<U.length;X++){const te=N[X],Z=U[X],le=te.el&&(te.type===Be||!hr(te,Z)||te.shapeFlag&70)?m(te.el):G;E(te,Z,le,null,H,W,$,ee,!0)}},v=(N,U,G,H,W,$,ee)=>{if(G!==H){if(G!==Ie)for(const X in G)!Vn(X)&&!(X in H)&&s(N,X,G[X],null,ee,U.children,W,$,ne);for(const X in H){if(Vn(X))continue;const te=H[X],Z=G[X];te!==Z&&X!=="value"&&s(N,X,Z,te,ee,U.children,W,$,ne)}"value"in H&&s(N,"value",G.value,H.value)}},b=(N,U,G,H,W,$,ee,X,te)=>{const Z=U.el=N?N.el:d(""),le=U.anchor=N?N.anchor:d("");let{patchFlag:se,dynamicChildren:oe,slotScopeIds:de}=U;de&&(X=X?X.concat(de):de),N==null?(n(Z,G,H),n(le,G,H),w(U.children,G,le,W,$,ee,X,te)):se>0&&se&64&&oe&&N.dynamicChildren?(h(N.dynamicChildren,oe,G,W,$,ee,X),(U.key!=null||W&&U===W.subTree)&&xl(N,U,!0)):P(N,U,G,le,W,$,ee,X,te)},R=(N,U,G,H,W,$,ee,X,te)=>{U.slotScopeIds=X,N==null?U.shapeFlag&512?W.ctx.activate(U,G,H,ee,te):I(U,G,H,W,$,ee,te):C(N,U,te)},I=(N,U,G,H,W,$,ee)=>{const X=N.component=df(N,H,W);if(Ai(N)&&(X.ctx.renderer=Y),ff(X),X.asyncDep){if(W&&W.registerDep(X,x),!N.el){const te=X.subTree=pe(bt);g(null,te,U,G)}return}x(X,N,U,G,W,$,ee)},C=(N,U,G)=>{const H=U.component=N.component;if(Ed(N,U,G))if(H.asyncDep&&!H.asyncResolved){O(H,U,G);return}else H.next=U,hd(H.update),H.update();else U.el=N.el,H.vnode=U},x=(N,U,G,H,W,$,ee)=>{const X=()=>{if(N.isMounted){let{next:le,bu:se,u:oe,parent:de,vnode:fe}=N,ye=le,Ee;or(N,!1),le?(le.el=fe.el,O(N,le,ee)):le=fe,se&&jn(se),(Ee=le.props&&le.props.onVnodeBeforeUpdate)&&_t(Ee,de,le,fe),or(N,!0);const ke=Ni(N),xe=N.subTree;N.subTree=ke,E(xe,ke,m(xe.el),V(xe),N,W,$),le.el=ke.el,ye===null&&Td(N,ke.el),oe&&Qe(oe,W),(Ee=le.props&&le.props.onVnodeUpdated)&&Qe(()=>_t(Ee,de,le,fe),W)}else{let le;const{el:se,props:oe}=U,{bm:de,m:fe,parent:ye}=N,Ee=Kn(U);if(or(N,!1),de&&jn(de),!Ee&&(le=oe&&oe.onVnodeBeforeMount)&&_t(le,ye,U),or(N,!0),se&&ue){const ke=()=>{N.subTree=Ni(N),ue(se,N.subTree,N,W,null)};Ee?U.type.__asyncLoader().then(()=>!N.isUnmounted&&ke()):ke()}else{const ke=N.subTree=Ni(N);E(null,ke,G,H,N,W,$),U.el=ke.el}if(fe&&Qe(fe,W),!Ee&&(le=oe&&oe.onVnodeMounted)){const ke=U;Qe(()=>_t(le,ye,ke),W)}(U.shapeFlag&256||ye&&Kn(ye.vnode)&&ye.vnode.shapeFlag&256)&&N.a&&Qe(N.a,W),N.isMounted=!0,U=G=H=null}},te=N.effect=new Ns(X,()=>zs(Z),N.scope),Z=N.update=()=>te.run();Z.id=N.uid,or(N,!0),Z()},O=(N,U,G)=>{U.component=N;const H=N.vnode.props;N.vnode=U,N.next=null,Qd(N,U.props,H,G),tf(N,U.children,G),Vr(),ya(),jr()},P=(N,U,G,H,W,$,ee,X,te=!1)=>{const Z=N&&N.children,le=N?N.shapeFlag:0,se=U.children,{patchFlag:oe,shapeFlag:de}=U;if(oe>0){if(oe&128){F(Z,se,G,H,W,$,ee,X,te);return}else if(oe&256){M(Z,se,G,H,W,$,ee,X,te);return}}de&8?(le&16&&ne(Z,W,$),se!==Z&&y(G,se)):le&16?de&16?F(Z,se,G,H,W,$,ee,X,te):ne(Z,W,$,!0):(le&8&&y(G,""),de&16&&w(se,G,H,W,$,ee,X,te))},M=(N,U,G,H,W,$,ee,X,te)=>{N=N||Rr,U=U||Rr;const Z=N.length,le=U.length,se=Math.min(Z,le);let oe;for(oe=0;oe<se;oe++){const de=U[oe]=te?Yt(U[oe]):kt(U[oe]);E(N[oe],de,G,null,W,$,ee,X,te)}Z>le?ne(N,W,$,!0,!1,se):w(U,G,H,W,$,ee,X,te,se)},F=(N,U,G,H,W,$,ee,X,te)=>{let Z=0;const le=U.length;let se=N.length-1,oe=le-1;for(;Z<=se&&Z<=oe;){const de=N[Z],fe=U[Z]=te?Yt(U[Z]):kt(U[Z]);if(hr(de,fe))E(de,fe,G,null,W,$,ee,X,te);else break;Z++}for(;Z<=se&&Z<=oe;){const de=N[se],fe=U[oe]=te?Yt(U[oe]):kt(U[oe]);if(hr(de,fe))E(de,fe,G,null,W,$,ee,X,te);else break;se--,oe--}if(Z>se){if(Z<=oe){const de=oe+1,fe=de<le?U[de].el:H;for(;Z<=oe;)E(null,U[Z]=te?Yt(U[Z]):kt(U[Z]),G,fe,W,$,ee,X,te),Z++}}else if(Z>oe)for(;Z<=se;)j(N[Z],W,$,!0),Z++;else{const de=Z,fe=Z,ye=new Map;for(Z=fe;Z<=oe;Z++){const Fe=U[Z]=te?Yt(U[Z]):kt(U[Z]);Fe.key!=null&&ye.set(Fe.key,Z)}let Ee,ke=0;const xe=oe-fe+1;let ot=!1,Ot=0;const qe=new Array(xe);for(Z=0;Z<xe;Z++)qe[Z]=0;for(Z=de;Z<=se;Z++){const Fe=N[Z];if(ke>=xe){j(Fe,W,$,!0);continue}let je;if(Fe.key!=null)je=ye.get(Fe.key);else for(Ee=fe;Ee<=oe;Ee++)if(qe[Ee-fe]===0&&hr(Fe,U[Ee])){je=Ee;break}je===void 0?j(Fe,W,$,!0):(qe[je-fe]=Z+1,je>=Ot?Ot=je:ot=!0,E(Fe,U[je],G,null,W,$,ee,X,te),ke++)}const Gt=ot?sf(qe):Rr;for(Ee=Gt.length-1,Z=xe-1;Z>=0;Z--){const Fe=fe+Z,je=U[Fe],ht=Fe+1<le?U[Fe+1].el:H;qe[Z]===0?E(null,je,G,ht,W,$,ee,X,te):ot&&(Ee<0||Z!==Gt[Ee]?B(je,G,ht,2):Ee--)}}},B=(N,U,G,H,W=null)=>{const{el:$,type:ee,transition:X,children:te,shapeFlag:Z}=N;if(Z&6){B(N.component.subTree,U,G,H);return}if(Z&128){N.suspense.move(U,G,H);return}if(Z&64){ee.move(N,U,G,Y);return}if(ee===Be){n($,U,G);for(let se=0;se<te.length;se++)B(te[se],U,G,H);n(N.anchor,U,G);return}if(ee===zn){T(N,U,G);return}if(H!==2&&Z&1&&X)if(H===0)X.beforeEnter($),n($,U,G),Qe(()=>X.enter($),W);else{const{leave:se,delayLeave:oe,afterLeave:de}=X,fe=()=>n($,U,G),ye=()=>{se($,()=>{fe(),de&&de()})};oe?oe($,fe,ye):ye()}else n($,U,G)},j=(N,U,G,H=!1,W=!1)=>{const{type:$,props:ee,ref:X,children:te,dynamicChildren:Z,shapeFlag:le,patchFlag:se,dirs:oe}=N;if(X!=null&&ms(X,null,G,N,!0),le&256){U.ctx.deactivate(N);return}const de=le&1&&oe,fe=!Kn(N);let ye;if(fe&&(ye=ee&&ee.onVnodeBeforeUnmount)&&_t(ye,U,N),le&6)re(N.component,G,H);else{if(le&128){N.suspense.unmount(G,H);return}de&&ar(N,null,U,"beforeUnmount"),le&64?N.type.remove(N,U,G,W,Y,H):Z&&($!==Be||se>0&&se&64)?ne(Z,U,G,!1,!0):($===Be&&se&384||!W&&le&16)&&ne(te,U,G),H&&K(N)}(fe&&(ye=ee&&ee.onVnodeUnmounted)||de)&&Qe(()=>{ye&&_t(ye,U,N),de&&ar(N,null,U,"unmounted")},G)},K=N=>{const{type:U,el:G,anchor:H,transition:W}=N;if(U===Be){z(G,H);return}if(U===zn){S(N);return}const $=()=>{i(G),W&&!W.persisted&&W.afterLeave&&W.afterLeave()};if(N.shapeFlag&1&&W&&!W.persisted){const{leave:ee,delayLeave:X}=W,te=()=>ee(G,$);X?X(N.el,$,te):te()}else $()},z=(N,U)=>{let G;for(;N!==U;)G=f(N),i(N),N=G;i(U)},re=(N,U,G)=>{const{bum:H,scope:W,update:$,subTree:ee,um:X}=N;H&&jn(H),W.stop(),$&&($.active=!1,j(ee,N,U,G)),X&&Qe(X,U),Qe(()=>{N.isUnmounted=!0},U),U&&U.pendingBranch&&!U.isUnmounted&&N.asyncDep&&!N.asyncResolved&&N.suspenseId===U.pendingId&&(U.deps--,U.deps===0&&U.resolve())},ne=(N,U,G,H=!1,W=!1,$=0)=>{for(let ee=$;ee<N.length;ee++)j(N[ee],U,G,H,W)},V=N=>N.shapeFlag&6?V(N.component.subTree):N.shapeFlag&128?N.suspense.next():f(N.anchor||N.el),q=(N,U,G)=>{N==null?U._vnode&&j(U._vnode,null,null,!0):E(U._vnode||null,N,U,null,null,null,G),ya(),ml(),U._vnode=N},Y={p:E,um:j,m:B,r:K,mt:I,mc:w,pc:P,pbc:h,n:V,o:t};let ie,ue;return e&&([ie,ue]=e(Y)),{render:q,hydrate:ie,createApp:Zd(q,ie)}}function or({effect:t,update:e},r){t.allowRecurse=e.allowRecurse=r}function xl(t,e,r=!1){const n=t.children,i=e.children;if(ce(n)&&ce(i))for(let s=0;s<n.length;s++){const a=n[s];let d=i[s];d.shapeFlag&1&&!d.dynamicChildren&&((d.patchFlag<=0||d.patchFlag===32)&&(d=i[s]=Yt(i[s]),d.el=a.el),r||xl(a,d)),d.type===wi&&(d.el=a.el)}}function sf(t){const e=t.slice(),r=[0];let n,i,s,a,d;const u=t.length;for(n=0;n<u;n++){const o=t[n];if(o!==0){if(i=r[r.length-1],t[i]<o){e[n]=i,r.push(n);continue}for(s=0,a=r.length-1;s<a;)d=s+a>>1,t[r[d]]<o?s=d+1:a=d;o<t[r[s]]&&(s>0&&(e[n]=r[s-1]),r[s]=n)}}for(s=r.length,a=r[s-1];s-- >0;)r[s]=a,a=e[a];return r}const af=t=>t.__isTeleport,Be=Symbol.for("v-fgt"),wi=Symbol.for("v-txt"),bt=Symbol.for("v-cmt"),zn=Symbol.for("v-stc"),an=[];let Et=null;function he(t=!1){an.push(Et=t?null:[])}function of(){an.pop(),Et=an[an.length-1]||null}let pn=1;function Ia(t){pn+=t}function Pl(t){return t.dynamicChildren=pn>0?Et||Rr:null,of(),pn>0&&Et&&Et.push(t),t}function ge(t,e,r,n,i,s){return Pl(Q(t,e,r,n,i,s,!0))}function $s(t,e,r,n,i){return Pl(pe(t,e,r,n,i,!0))}function ps(t){return t?t.__v_isVNode===!0:!1}function hr(t,e){return t.type===e.type&&t.key===e.key}const _i="__vInternal",Ml=({key:t})=>t??null,Yn=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?Me(t)||Ge(t)||ve(t)?{i:nt,r:t,k:e,f:!!r}:t:null);function Q(t,e=null,r=null,n=0,i=null,s=t===Be?0:1,a=!1,d=!1){const u={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Ml(e),ref:e&&Yn(e),scopeId:Si,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:nt};return d?(Zs(u,r),s&128&&t.normalize(u)):r&&(u.shapeFlag|=Me(r)?8:16),pn>0&&!a&&Et&&(u.patchFlag>0||s&6)&&u.patchFlag!==32&&Et.push(u),u}const pe=lf;function lf(t,e=null,r=null,n=0,i=null,s=!1){if((!t||t===Bd)&&(t=bt),ps(t)){const d=tr(t,e,!0);return r&&Zs(d,r),pn>0&&!s&&Et&&(d.shapeFlag&6?Et[Et.indexOf(t)]=d:Et.push(d)),d.patchFlag|=-2,d}if(pf(t)&&(t=t.__vccOpts),e){e=Fl(e);let{class:d,style:u}=e;d&&!Me(d)&&(e.class=Je(d)),De(u)&&(ul(u)&&!ce(u)&&(u=Ve({},u)),e.style=yt(u))}const a=Me(t)?1:Sd(t)?128:af(t)?64:De(t)?4:ve(t)?2:0;return Q(t,e,r,n,i,a,s,!0)}function Fl(t){return t?ul(t)||_i in t?Ve({},t):t:null}function tr(t,e,r=!1){const{props:n,ref:i,patchFlag:s,children:a}=t,d=e?Nl(n||{},e):n;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:d,key:d&&Ml(d),ref:e&&e.ref?r&&i?ce(i)?i.concat(Yn(e)):[i,Yn(e)]:Yn(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Be?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&tr(t.ssContent),ssFallback:t.ssFallback&&tr(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function We(t=" ",e=0){return pe(wi,null,t,e)}function Pe(t="",e=!1){return e?(he(),$s(bt,null,t)):pe(bt,null,t)}function kt(t){return t==null||typeof t=="boolean"?pe(bt):ce(t)?pe(Be,null,t.slice()):typeof t=="object"?Yt(t):pe(wi,null,String(t))}function Yt(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:tr(t)}function Zs(t,e){let r=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(ce(e))r=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),Zs(t,i()),i._c&&(i._d=!0));return}else{r=32;const i=e._;!i&&!(_i in e)?e._ctx=nt:i===3&&nt&&(nt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else ve(e)?(e={default:e,_ctx:nt},r=32):(e=String(e),n&64?(r=16,e=[We(e)]):r=8);t.children=e,t.shapeFlag|=r}function Nl(...t){const e={};for(let r=0;r<t.length;r++){const n=t[r];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=Je([e.class,n.class]));else if(i==="style")e.style=yt([e.style,n.style]);else if(di(i)){const s=e[i],a=n[i];a&&s!==a&&!(ce(s)&&s.includes(a))&&(e[i]=s?[].concat(s,a):a)}else i!==""&&(e[i]=n[i])}return e}function _t(t,e,r,n=null){ft(t,e,7,[r,n])}const uf=kl();let cf=0;function df(t,e,r){const n=t.type,i=(e?e.appContext:t.appContext)||uf,s={uid:cf++,vnode:t,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new wc(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Rl(n,i),emitsOptions:vl(n,i),emit:null,emitted:null,propsDefaults:Ie,inheritAttrs:n.inheritAttrs,ctx:Ie,data:Ie,props:Ie,attrs:Ie,slots:Ie,refs:Ie,setupState:Ie,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=pd.bind(null,s),t.ce&&t.ce(s),s}let He=null;const ki=()=>He||nt;let Xs,wr,Ca="__VUE_INSTANCE_SETTERS__";(wr=is()[Ca])||(wr=is()[Ca]=[]),wr.push(t=>He=t),Xs=t=>{wr.length>1?wr.forEach(e=>e(t)):wr[0](t)};const Nr=t=>{Xs(t),t.scope.on()},Tr=()=>{He&&He.scope.off(),Xs(null)};function Ul(t){return t.vnode.shapeFlag&4}let vn=!1;function ff(t,e=!1){vn=e;const{props:r,children:n}=t.vnode,i=Ul(t);Xd(t,r,i,e),ef(t,n);const s=i?hf(t,e):void 0;return vn=!1,s}function hf(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=cl(new Proxy(t.ctx,Vd));const{setup:n}=r;if(n){const i=t.setupContext=n.length>1?Gl(t):null;Nr(t),Vr();const s=Jt(n,t,0,[t.props,i]);if(jr(),Tr(),zo(s)){if(s.then(Tr,Tr),e)return s.then(a=>{Oa(t,a,e)}).catch(a=>{yi(a,t,0)});t.asyncDep=s}else Oa(t,s,e)}else Bl(t,e)}function Oa(t,e,r){ve(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:De(e)&&(t.setupState=fl(e)),Bl(t,r)}let xa;function Bl(t,e,r){const n=t.type;if(!t.render){if(!e&&xa&&!n.render){const i=n.template||Ys(t).template;if(i){const{isCustomElement:s,compilerOptions:a}=t.appContext.config,{delimiters:d,compilerOptions:u}=n,o=Ve(Ve({isCustomElement:s,delimiters:d},a),u);n.render=xa(i,o)}}t.render=n.render||St}Nr(t),Vr(),Kd(t),jr(),Tr()}function gf(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(e,r){return et(t,"get","$attrs"),e[r]}}))}function Gl(t){const e=r=>{t.exposed=r||{}};return{get attrs(){return gf(t)},slots:t.slots,emit:t.emit,expose:e}}function Di(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(fl(cl(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in sn)return sn[r](t)},has(e,r){return r in e||r in sn}}))}function mf(t,e=!0){return ve(t)?t.displayName||t.name:t.name||e&&t.__name}function pf(t){return ve(t)&&"__vccOpts"in t}const Ce=(t,e)=>cd(t,e,vn);function Qs(t,e,r){const n=arguments.length;return n===2?De(e)&&!ce(e)?ps(e)?pe(t,null,[e]):pe(t,e):pe(t,null,e):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&ps(r)&&(r=[r]),pe(t,e,r))}const vf=Symbol.for("v-scx"),yf=()=>Ft(vf),Ef="3.3.4",Tf="http://www.w3.org/2000/svg",gr=typeof document<"u"?document:null,Pa=gr&&gr.createElement("template"),Sf={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,n)=>{const i=e?gr.createElementNS(Tf,t):gr.createElement(t,r?{is:r}:void 0);return t==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:t=>gr.createTextNode(t),createComment:t=>gr.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>gr.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,n,i,s){const a=r?r.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),r),!(i===s||!(i=i.nextSibling)););else{Pa.innerHTML=n?`<svg>${t}</svg>`:t;const d=Pa.content;if(n){const u=d.firstChild;for(;u.firstChild;)d.appendChild(u.firstChild);d.removeChild(u)}e.insertBefore(d,r)}return[a?a.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}};function bf(t,e,r){const n=t._vtc;n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}function Af(t,e,r){const n=t.style,i=Me(r);if(r&&!i){if(e&&!Me(e))for(const s in e)r[s]==null&&vs(n,s,"");for(const s in r)vs(n,s,r[s])}else{const s=n.display;i?e!==r&&(n.cssText=r):e&&t.removeAttribute("style"),"_vod"in t&&(n.display=s)}}const Ma=/\s*!important$/;function vs(t,e,r){if(ce(r))r.forEach(n=>vs(t,e,n));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const n=Lf(t,e);Ma.test(r)?t.setProperty(Ar(n),r.replace(Ma,""),"important"):t[n]=r}}const Fa=["Webkit","Moz","ms"],Gi={};function Lf(t,e){const r=Gi[e];if(r)return r;let n=It(e);if(n!=="filter"&&n in t)return Gi[e]=n;n=gi(n);for(let i=0;i<Fa.length;i++){const s=Fa[i]+n;if(s in t)return Gi[e]=s}return e}const Na="http://www.w3.org/1999/xlink";function wf(t,e,r,n,i){if(n&&e.startsWith("xlink:"))r==null?t.removeAttributeNS(Na,e.slice(6,e.length)):t.setAttributeNS(Na,e,r);else{const s=bc(e);r==null||s&&!$o(r)?t.removeAttribute(e):t.setAttribute(e,s?"":r)}}function _f(t,e,r,n,i,s,a){if(e==="innerHTML"||e==="textContent"){n&&a(n,i,s),t[e]=r??"";return}const d=t.tagName;if(e==="value"&&d!=="PROGRESS"&&!d.includes("-")){t._value=r;const o=d==="OPTION"?t.getAttribute("value"):t.value,y=r??"";o!==y&&(t.value=y),r==null&&t.removeAttribute(e);return}let u=!1;if(r===""||r==null){const o=typeof t[e];o==="boolean"?r=$o(r):r==null&&o==="string"?(r="",u=!0):o==="number"&&(r=0,u=!0)}try{t[e]=r}catch{}u&&t.removeAttribute(e)}function mr(t,e,r,n){t.addEventListener(e,r,n)}function kf(t,e,r,n){t.removeEventListener(e,r,n)}function Df(t,e,r,n,i=null){const s=t._vei||(t._vei={}),a=s[e];if(n&&a)a.value=n;else{const[d,u]=Rf(e);if(n){const o=s[e]=Of(n,i);mr(t,d,o,u)}else a&&(kf(t,d,a,u),s[e]=void 0)}}const Ua=/(?:Once|Passive|Capture)$/;function Rf(t){let e;if(Ua.test(t)){e={};let n;for(;n=t.match(Ua);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ar(t.slice(2)),e]}let Vi=0;const If=Promise.resolve(),Cf=()=>Vi||(If.then(()=>Vi=0),Vi=Date.now());function Of(t,e){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;ft(xf(n,r.value),e,5,[n])};return r.value=t,r.attached=Cf(),r}function xf(t,e){if(ce(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(n=>i=>!i._stopped&&n&&n(i))}else return e}const Ba=/^on[a-z]/,Pf=(t,e,r,n,i=!1,s,a,d,u)=>{e==="class"?bf(t,n,i):e==="style"?Af(t,r,n):di(e)?xs(e)||Df(t,e,r,n,a):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Mf(t,e,n,i))?_f(t,e,n,s,a,d,u):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),wf(t,e,n,i))};function Mf(t,e,r,n){return n?!!(e==="innerHTML"||e==="textContent"||e in t&&Ba.test(e)&&ve(r)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||Ba.test(e)&&Me(r)?!1:e in t}function Js(t){const e=ki();if(!e)return;const r=e.ut=(i=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(s=>Es(s,i))},n=()=>{const i=t(e.proxy);ys(e.subTree,i),r(i)};Ld(n),bn(()=>{const i=new MutationObserver(n);i.observe(e.subTree.el.parentNode,{childList:!0}),An(()=>i.disconnect())})}function ys(t,e){if(t.shapeFlag&128){const r=t.suspense;t=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{ys(r.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)Es(t.el,e);else if(t.type===Be)t.children.forEach(r=>ys(r,e));else if(t.type===zn){let{el:r,anchor:n}=t;for(;r&&(Es(r,e),r!==n);)r=r.nextSibling}}function Es(t,e){if(t.nodeType===1){const r=t.style;for(const n in e)r.setProperty(`--${n}`,e[n])}}const jt="transition",Yr="animation",yn=(t,{slots:e})=>Qs(Dd,Ff(t),e);yn.displayName="Transition";const Vl={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};yn.props=Ve({},El,Vl);const lr=(t,e=[])=>{ce(t)?t.forEach(r=>r(...e)):t&&t(...e)},Ga=t=>t?ce(t)?t.some(e=>e.length>1):t.length>1:!1;function Ff(t){const e={};for(const b in t)b in Vl||(e[b]=t[b]);if(t.css===!1)return e;const{name:r="v",type:n,duration:i,enterFromClass:s=`${r}-enter-from`,enterActiveClass:a=`${r}-enter-active`,enterToClass:d=`${r}-enter-to`,appearFromClass:u=s,appearActiveClass:o=a,appearToClass:y=d,leaveFromClass:m=`${r}-leave-from`,leaveActiveClass:f=`${r}-leave-active`,leaveToClass:L=`${r}-leave-to`}=t,_=Nf(i),E=_&&_[0],l=_&&_[1],{onBeforeEnter:g,onEnter:c,onEnterCancelled:T,onLeave:S,onLeaveCancelled:p,onBeforeAppear:A=g,onAppear:D=c,onAppearCancelled:w=T}=e,k=(b,R,I)=>{ur(b,R?y:d),ur(b,R?o:a),I&&I()},h=(b,R)=>{b._isLeaving=!1,ur(b,m),ur(b,L),ur(b,f),R&&R()},v=b=>(R,I)=>{const C=b?D:c,x=()=>k(R,b,I);lr(C,[R,x]),Va(()=>{ur(R,b?u:s),Ht(R,b?y:d),Ga(C)||ja(R,n,E,x)})};return Ve(e,{onBeforeEnter(b){lr(g,[b]),Ht(b,s),Ht(b,a)},onBeforeAppear(b){lr(A,[b]),Ht(b,u),Ht(b,o)},onEnter:v(!1),onAppear:v(!0),onLeave(b,R){b._isLeaving=!0;const I=()=>h(b,R);Ht(b,m),Gf(),Ht(b,f),Va(()=>{b._isLeaving&&(ur(b,m),Ht(b,L),Ga(S)||ja(b,n,l,I))}),lr(S,[b,I])},onEnterCancelled(b){k(b,!1),lr(T,[b])},onAppearCancelled(b){k(b,!0),lr(w,[b])},onLeaveCancelled(b){h(b),lr(p,[b])}})}function Nf(t){if(t==null)return null;if(De(t))return[ji(t.enter),ji(t.leave)];{const e=ji(t);return[e,e]}}function ji(t){return mc(t)}function Ht(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.add(r)),(t._vtc||(t._vtc=new Set)).add(e)}function ur(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const{_vtc:r}=t;r&&(r.delete(e),r.size||(t._vtc=void 0))}function Va(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Uf=0;function ja(t,e,r,n){const i=t._endId=++Uf,s=()=>{i===t._endId&&n()};if(r)return setTimeout(s,r);const{type:a,timeout:d,propCount:u}=Bf(t,e);if(!a)return n();const o=a+"end";let y=0;const m=()=>{t.removeEventListener(o,f),s()},f=L=>{L.target===t&&++y>=u&&m()};setTimeout(()=>{y<u&&m()},d+1),t.addEventListener(o,f)}function Bf(t,e){const r=window.getComputedStyle(t),n=_=>(r[_]||"").split(", "),i=n(`${jt}Delay`),s=n(`${jt}Duration`),a=Ha(i,s),d=n(`${Yr}Delay`),u=n(`${Yr}Duration`),o=Ha(d,u);let y=null,m=0,f=0;e===jt?a>0&&(y=jt,m=a,f=s.length):e===Yr?o>0&&(y=Yr,m=o,f=u.length):(m=Math.max(a,o),y=m>0?a>o?jt:Yr:null,f=y?y===jt?s.length:u.length:0);const L=y===jt&&/\b(transform|all)(,|$)/.test(n(`${jt}Property`).toString());return{type:y,timeout:m,propCount:f,hasTransform:L}}function Ha(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((r,n)=>Ka(r)+Ka(t[n])))}function Ka(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function Gf(){return document.body.offsetHeight}const ii=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ce(e)?r=>jn(e,r):e};function Vf(t){t.target.composing=!0}function Wa(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const jf={created(t,{modifiers:{lazy:e,trim:r,number:n}},i){t._assign=ii(i);const s=n||i.props&&i.props.type==="number";mr(t,e?"change":"input",a=>{if(a.target.composing)return;let d=t.value;r&&(d=d.trim()),s&&(d=Qn(d)),t._assign(d)}),r&&mr(t,"change",()=>{t.value=t.value.trim()}),e||(mr(t,"compositionstart",Vf),mr(t,"compositionend",Wa),mr(t,"change",Wa))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,modifiers:{lazy:r,trim:n,number:i}},s){if(t._assign=ii(s),t.composing||document.activeElement===t&&t.type!=="range"&&(r||n&&t.value.trim()===e||(i||t.type==="number")&&Qn(t.value)===e))return;const a=e??"";t.value!==a&&(t.value=a)}},Hf={deep:!0,created(t,{value:e,modifiers:{number:r}},n){const i=fi(e);mr(t,"change",()=>{const s=Array.prototype.filter.call(t.options,a=>a.selected).map(a=>r?Qn(si(a)):si(a));t._assign(t.multiple?i?new Set(s):s:s[0])}),t._assign=ii(n)},mounted(t,{value:e}){za(t,e)},beforeUpdate(t,e,r){t._assign=ii(r)},updated(t,{value:e}){za(t,e)}};function za(t,e){const r=t.multiple;if(!(r&&!ce(e)&&!fi(e))){for(let n=0,i=t.options.length;n<i;n++){const s=t.options[n],a=si(s);if(r)ce(e)?s.selected=Lc(e,a)>-1:s.selected=e.has(a);else if(mi(si(s),e)){t.selectedIndex!==n&&(t.selectedIndex=n);return}}!r&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function si(t){return"_value"in t?t._value:t.value}const Kf=["ctrl","shift","alt","meta"],Wf={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Kf.some(r=>t[`${r}Key`]&&!e.includes(r))},zf=(t,e)=>(r,...n)=>{for(let i=0;i<e.length;i++){const s=Wf[e[i]];if(s&&s(r,e))return}return t(r,...n)},Yf={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},qr=(t,e)=>r=>{if(!("key"in r))return;const n=Ar(r.key);if(e.some(i=>i===n||Yf[i]===n))return t(r)},it={beforeMount(t,{value:e},{transition:r}){t._vod=t.style.display==="none"?"":t.style.display,r&&e?r.beforeEnter(t):$r(t,e)},mounted(t,{value:e},{transition:r}){r&&e&&r.enter(t)},updated(t,{value:e,oldValue:r},{transition:n}){!e!=!r&&(n?e?(n.beforeEnter(t),$r(t,!0),n.enter(t)):n.leave(t,()=>{$r(t,!1)}):$r(t,e))},beforeUnmount(t,{value:e}){$r(t,e)}};function $r(t,e){t.style.display=e?t._vod:"none"}const qf=Ve({patchProp:Pf},Sf);let Ya;function $f(){return Ya||(Ya=rf(qf))}const Zf=(...t)=>{const e=$f().createApp(...t),{mount:r}=e;return e.mount=n=>{const i=Xf(n);if(!i)return;const s=e._component;!ve(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.innerHTML="";const a=r(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},e};function Xf(t){return Me(t)?document.querySelector(t):t}/*!
  * vue-router v4.2.5
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const Dr=typeof window<"u";function Qf(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const _e=Object.assign;function Hi(t,e){const r={};for(const n in e){const i=e[n];r[n]=At(i)?i.map(t):t(i)}return r}const on=()=>{},At=Array.isArray,Jf=/\/$/,eh=t=>t.replace(Jf,"");function Ki(t,e,r="/"){let n,i={},s="",a="";const d=e.indexOf("#");let u=e.indexOf("?");return d<u&&d>=0&&(u=-1),u>-1&&(n=e.slice(0,u),s=e.slice(u+1,d>-1?d:e.length),i=t(s)),d>-1&&(n=n||e.slice(0,d),a=e.slice(d,e.length)),n=ih(n??e,r),{fullPath:n+(s&&"?")+s+a,path:n,query:i,hash:a}}function th(t,e){const r=e.query?t(e.query):"";return e.path+(r&&"?")+r+(e.hash||"")}function qa(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function rh(t,e,r){const n=e.matched.length-1,i=r.matched.length-1;return n>-1&&n===i&&Ur(e.matched[n],r.matched[i])&&jl(e.params,r.params)&&t(e.query)===t(r.query)&&e.hash===r.hash}function Ur(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function jl(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(!nh(t[r],e[r]))return!1;return!0}function nh(t,e){return At(t)?$a(t,e):At(e)?$a(e,t):t===e}function $a(t,e){return At(e)?t.length===e.length&&t.every((r,n)=>r===e[n]):t.length===1&&t[0]===e}function ih(t,e){if(t.startsWith("/"))return t;if(!t)return e;const r=e.split("/"),n=t.split("/"),i=n[n.length-1];(i===".."||i===".")&&n.push("");let s=r.length-1,a,d;for(a=0;a<n.length;a++)if(d=n[a],d!==".")if(d==="..")s>1&&s--;else break;return r.slice(0,s).join("/")+"/"+n.slice(a-(a===n.length?1:0)).join("/")}var En;(function(t){t.pop="pop",t.push="push"})(En||(En={}));var ln;(function(t){t.back="back",t.forward="forward",t.unknown=""})(ln||(ln={}));function sh(t){if(!t)if(Dr){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),eh(t)}const ah=/^[^#]+#/;function oh(t,e){return t.replace(ah,"#")+e}function lh(t,e){const r=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-r.left-(e.left||0),top:n.top-r.top-(e.top||0)}}const Ri=()=>({left:window.pageXOffset,top:window.pageYOffset});function uh(t){let e;if("el"in t){const r=t.el,n=typeof r=="string"&&r.startsWith("#"),i=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!i)return;e=lh(i,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function Za(t,e){return(history.state?history.state.position-e:-1)+t}const Ts=new Map;function ch(t,e){Ts.set(t,e)}function dh(t){const e=Ts.get(t);return Ts.delete(t),e}let fh=()=>location.protocol+"//"+location.host;function Hl(t,e){const{pathname:r,search:n,hash:i}=e,s=t.indexOf("#");if(s>-1){let d=i.includes(t.slice(s))?t.slice(s).length:1,u=i.slice(d);return u[0]!=="/"&&(u="/"+u),qa(u,"")}return qa(r,t)+n+i}function hh(t,e,r,n){let i=[],s=[],a=null;const d=({state:f})=>{const L=Hl(t,location),_=r.value,E=e.value;let l=0;if(f){if(r.value=L,e.value=f,a&&a===_){a=null;return}l=E?f.position-E.position:0}else n(L);i.forEach(g=>{g(r.value,_,{delta:l,type:En.pop,direction:l?l>0?ln.forward:ln.back:ln.unknown})})};function u(){a=r.value}function o(f){i.push(f);const L=()=>{const _=i.indexOf(f);_>-1&&i.splice(_,1)};return s.push(L),L}function y(){const{history:f}=window;f.state&&f.replaceState(_e({},f.state,{scroll:Ri()}),"")}function m(){for(const f of s)f();s=[],window.removeEventListener("popstate",d),window.removeEventListener("beforeunload",y)}return window.addEventListener("popstate",d),window.addEventListener("beforeunload",y,{passive:!0}),{pauseListeners:u,listen:o,destroy:m}}function Xa(t,e,r,n=!1,i=!1){return{back:t,current:e,forward:r,replaced:n,position:window.history.length,scroll:i?Ri():null}}function gh(t){const{history:e,location:r}=window,n={value:Hl(t,r)},i={value:e.state};i.value||s(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(u,o,y){const m=t.indexOf("#"),f=m>-1?(r.host&&document.querySelector("base")?t:t.slice(m))+u:fh()+t+u;try{e[y?"replaceState":"pushState"](o,"",f),i.value=o}catch(L){console.error(L),r[y?"replace":"assign"](f)}}function a(u,o){const y=_e({},e.state,Xa(i.value.back,u,i.value.forward,!0),o,{position:i.value.position});s(u,y,!0),n.value=u}function d(u,o){const y=_e({},i.value,e.state,{forward:u,scroll:Ri()});s(y.current,y,!0);const m=_e({},Xa(n.value,u,null),{position:y.position+1},o);s(u,m,!1),n.value=u}return{location:n,state:i,push:d,replace:a}}function mh(t){t=sh(t);const e=gh(t),r=hh(t,e.state,e.location,e.replace);function n(s,a=!0){a||r.pauseListeners(),history.go(s)}const i=_e({location:"",base:t,go:n,createHref:oh.bind(null,t)},e,r);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function ph(t){return typeof t=="string"||t&&typeof t=="object"}function Kl(t){return typeof t=="string"||typeof t=="symbol"}const Kt={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Wl=Symbol("");var Qa;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Qa||(Qa={}));function Br(t,e){return _e(new Error,{type:t,[Wl]:!0},e)}function xt(t,e){return t instanceof Error&&Wl in t&&(e==null||!!(t.type&e))}const Ja="[^/]+?",vh={sensitive:!1,strict:!1,start:!0,end:!0},yh=/[.+*?^${}()[\]/\\]/g;function Eh(t,e){const r=_e({},vh,e),n=[];let i=r.start?"^":"";const s=[];for(const o of t){const y=o.length?[]:[90];r.strict&&!o.length&&(i+="/");for(let m=0;m<o.length;m++){const f=o[m];let L=40+(r.sensitive?.25:0);if(f.type===0)m||(i+="/"),i+=f.value.replace(yh,"\\$&"),L+=40;else if(f.type===1){const{value:_,repeatable:E,optional:l,regexp:g}=f;s.push({name:_,repeatable:E,optional:l});const c=g||Ja;if(c!==Ja){L+=10;try{new RegExp(`(${c})`)}catch(S){throw new Error(`Invalid custom RegExp for param "${_}" (${c}): `+S.message)}}let T=E?`((?:${c})(?:/(?:${c}))*)`:`(${c})`;m||(T=l&&o.length<2?`(?:/${T})`:"/"+T),l&&(T+="?"),i+=T,L+=20,l&&(L+=-8),E&&(L+=-20),c===".*"&&(L+=-50)}y.push(L)}n.push(y)}if(r.strict&&r.end){const o=n.length-1;n[o][n[o].length-1]+=.7000000000000001}r.strict||(i+="/?"),r.end?i+="$":r.strict&&(i+="(?:/|$)");const a=new RegExp(i,r.sensitive?"":"i");function d(o){const y=o.match(a),m={};if(!y)return null;for(let f=1;f<y.length;f++){const L=y[f]||"",_=s[f-1];m[_.name]=L&&_.repeatable?L.split("/"):L}return m}function u(o){let y="",m=!1;for(const f of t){(!m||!y.endsWith("/"))&&(y+="/"),m=!1;for(const L of f)if(L.type===0)y+=L.value;else if(L.type===1){const{value:_,repeatable:E,optional:l}=L,g=_ in o?o[_]:"";if(At(g)&&!E)throw new Error(`Provided param "${_}" is an array but it is not repeatable (* or + modifiers)`);const c=At(g)?g.join("/"):g;if(!c)if(l)f.length<2&&(y.endsWith("/")?y=y.slice(0,-1):m=!0);else throw new Error(`Missing required param "${_}"`);y+=c}}return y||"/"}return{re:a,score:n,keys:s,parse:d,stringify:u}}function Th(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=e[r]-t[r];if(n)return n;r++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function Sh(t,e){let r=0;const n=t.score,i=e.score;for(;r<n.length&&r<i.length;){const s=Th(n[r],i[r]);if(s)return s;r++}if(Math.abs(i.length-n.length)===1){if(eo(n))return 1;if(eo(i))return-1}return i.length-n.length}function eo(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const bh={type:0,value:""},Ah=/[a-zA-Z0-9_]/;function Lh(t){if(!t)return[[]];if(t==="/")return[[bh]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(L){throw new Error(`ERR (${r})/"${o}": ${L}`)}let r=0,n=r;const i=[];let s;function a(){s&&i.push(s),s=[]}let d=0,u,o="",y="";function m(){o&&(r===0?s.push({type:0,value:o}):r===1||r===2||r===3?(s.length>1&&(u==="*"||u==="+")&&e(`A repeatable param (${o}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:o,regexp:y,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):e("Invalid state to consume buffer"),o="")}function f(){o+=u}for(;d<t.length;){if(u=t[d++],u==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:u==="/"?(o&&m(),a()):u===":"?(m(),r=1):f();break;case 4:f(),r=n;break;case 1:u==="("?r=2:Ah.test(u)?f():(m(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&d--);break;case 2:u===")"?y[y.length-1]=="\\"?y=y.slice(0,-1)+u:r=3:y+=u;break;case 3:m(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&d--,y="";break;default:e("Unknown state");break}}return r===2&&e(`Unfinished custom RegExp for param "${o}"`),m(),a(),i}function wh(t,e,r){const n=Eh(Lh(t.path),r),i=_e(n,{record:t,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function _h(t,e){const r=[],n=new Map;e=no({strict:!1,end:!0,sensitive:!1},e);function i(y){return n.get(y)}function s(y,m,f){const L=!f,_=kh(y);_.aliasOf=f&&f.record;const E=no(e,y),l=[_];if("alias"in y){const T=typeof y.alias=="string"?[y.alias]:y.alias;for(const S of T)l.push(_e({},_,{components:f?f.record.components:_.components,path:S,aliasOf:f?f.record:_}))}let g,c;for(const T of l){const{path:S}=T;if(m&&S[0]!=="/"){const p=m.record.path,A=p[p.length-1]==="/"?"":"/";T.path=m.record.path+(S&&A+S)}if(g=wh(T,m,E),f?f.alias.push(g):(c=c||g,c!==g&&c.alias.push(g),L&&y.name&&!ro(g)&&a(y.name)),_.children){const p=_.children;for(let A=0;A<p.length;A++)s(p[A],g,f&&f.children[A])}f=f||g,(g.record.components&&Object.keys(g.record.components).length||g.record.name||g.record.redirect)&&u(g)}return c?()=>{a(c)}:on}function a(y){if(Kl(y)){const m=n.get(y);m&&(n.delete(y),r.splice(r.indexOf(m),1),m.children.forEach(a),m.alias.forEach(a))}else{const m=r.indexOf(y);m>-1&&(r.splice(m,1),y.record.name&&n.delete(y.record.name),y.children.forEach(a),y.alias.forEach(a))}}function d(){return r}function u(y){let m=0;for(;m<r.length&&Sh(y,r[m])>=0&&(y.record.path!==r[m].record.path||!zl(y,r[m]));)m++;r.splice(m,0,y),y.record.name&&!ro(y)&&n.set(y.record.name,y)}function o(y,m){let f,L={},_,E;if("name"in y&&y.name){if(f=n.get(y.name),!f)throw Br(1,{location:y});E=f.record.name,L=_e(to(m.params,f.keys.filter(c=>!c.optional).map(c=>c.name)),y.params&&to(y.params,f.keys.map(c=>c.name))),_=f.stringify(L)}else if("path"in y)_=y.path,f=r.find(c=>c.re.test(_)),f&&(L=f.parse(_),E=f.record.name);else{if(f=m.name?n.get(m.name):r.find(c=>c.re.test(m.path)),!f)throw Br(1,{location:y,currentLocation:m});E=f.record.name,L=_e({},m.params,y.params),_=f.stringify(L)}const l=[];let g=f;for(;g;)l.unshift(g.record),g=g.parent;return{name:E,path:_,params:L,matched:l,meta:Rh(l)}}return t.forEach(y=>s(y)),{addRoute:s,resolve:o,removeRoute:a,getRoutes:d,getRecordMatcher:i}}function to(t,e){const r={};for(const n of e)n in t&&(r[n]=t[n]);return r}function kh(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:Dh(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function Dh(t){const e={},r=t.props||!1;if("component"in t)e.default=r;else for(const n in t.components)e[n]=typeof r=="object"?r[n]:r;return e}function ro(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function Rh(t){return t.reduce((e,r)=>_e(e,r.meta),{})}function no(t,e){const r={};for(const n in t)r[n]=n in e?e[n]:t[n];return r}function zl(t,e){return e.children.some(r=>r===t||zl(t,r))}const Yl=/#/g,Ih=/&/g,Ch=/\//g,Oh=/=/g,xh=/\?/g,ql=/\+/g,Ph=/%5B/g,Mh=/%5D/g,$l=/%5E/g,Fh=/%60/g,Zl=/%7B/g,Nh=/%7C/g,Xl=/%7D/g,Uh=/%20/g;function ea(t){return encodeURI(""+t).replace(Nh,"|").replace(Ph,"[").replace(Mh,"]")}function Bh(t){return ea(t).replace(Zl,"{").replace(Xl,"}").replace($l,"^")}function Ss(t){return ea(t).replace(ql,"%2B").replace(Uh,"+").replace(Yl,"%23").replace(Ih,"%26").replace(Fh,"`").replace(Zl,"{").replace(Xl,"}").replace($l,"^")}function Gh(t){return Ss(t).replace(Oh,"%3D")}function Vh(t){return ea(t).replace(Yl,"%23").replace(xh,"%3F")}function jh(t){return t==null?"":Vh(t).replace(Ch,"%2F")}function ai(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function Hh(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let i=0;i<n.length;++i){const s=n[i].replace(ql," "),a=s.indexOf("="),d=ai(a<0?s:s.slice(0,a)),u=a<0?null:ai(s.slice(a+1));if(d in e){let o=e[d];At(o)||(o=e[d]=[o]),o.push(u)}else e[d]=u}return e}function io(t){let e="";for(let r in t){const n=t[r];if(r=Gh(r),n==null){n!==void 0&&(e+=(e.length?"&":"")+r);continue}(At(n)?n.map(s=>s&&Ss(s)):[n&&Ss(n)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+r,s!=null&&(e+="="+s))})}return e}function Kh(t){const e={};for(const r in t){const n=t[r];n!==void 0&&(e[r]=At(n)?n.map(i=>i==null?null:""+i):n==null?n:""+n)}return e}const Wh=Symbol(""),so=Symbol(""),ta=Symbol(""),Ql=Symbol(""),bs=Symbol("");function Zr(){let t=[];function e(n){return t.push(n),()=>{const i=t.indexOf(n);i>-1&&t.splice(i,1)}}function r(){t=[]}return{add:e,list:()=>t.slice(),reset:r}}function qt(t,e,r,n,i){const s=n&&(n.enterCallbacks[i]=n.enterCallbacks[i]||[]);return()=>new Promise((a,d)=>{const u=m=>{m===!1?d(Br(4,{from:r,to:e})):m instanceof Error?d(m):ph(m)?d(Br(2,{from:e,to:m})):(s&&n.enterCallbacks[i]===s&&typeof m=="function"&&s.push(m),a())},o=t.call(n&&n.instances[i],e,r,u);let y=Promise.resolve(o);t.length<3&&(y=y.then(u)),y.catch(m=>d(m))})}function Wi(t,e,r,n){const i=[];for(const s of t)for(const a in s.components){let d=s.components[a];if(!(e!=="beforeRouteEnter"&&!s.instances[a]))if(zh(d)){const o=(d.__vccOpts||d)[e];o&&i.push(qt(o,r,n,s,a))}else{let u=d();i.push(()=>u.then(o=>{if(!o)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${s.path}"`));const y=Qf(o)?o.default:o;s.components[a]=y;const f=(y.__vccOpts||y)[e];return f&&qt(f,r,n,s,a)()}))}}return i}function zh(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function ao(t){const e=Ft(ta),r=Ft(Ql),n=Ce(()=>e.resolve(J(t.to))),i=Ce(()=>{const{matched:u}=n.value,{length:o}=u,y=u[o-1],m=r.matched;if(!y||!m.length)return-1;const f=m.findIndex(Ur.bind(null,y));if(f>-1)return f;const L=oo(u[o-2]);return o>1&&oo(y)===L&&m[m.length-1].path!==L?m.findIndex(Ur.bind(null,u[o-2])):f}),s=Ce(()=>i.value>-1&&Zh(r.params,n.value.params)),a=Ce(()=>i.value>-1&&i.value===r.matched.length-1&&jl(r.params,n.value.params));function d(u={}){return $h(u)?e[J(t.replace)?"replace":"push"](J(t.to)).catch(on):Promise.resolve()}return{route:n,href:Ce(()=>n.value.href),isActive:s,isExactActive:a,navigate:d}}const Yh=at({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:ao,setup(t,{slots:e}){const r=Ct(ao(t)),{options:n}=Ft(ta),i=Ce(()=>({[lo(t.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[lo(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const s=e.default&&e.default(r);return t.custom?s:Qs("a",{"aria-current":r.isExactActive?t.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:i.value},s)}}}),qh=Yh;function $h(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Zh(t,e){for(const r in e){const n=e[r],i=t[r];if(typeof n=="string"){if(n!==i)return!1}else if(!At(i)||i.length!==n.length||n.some((s,a)=>s!==i[a]))return!1}return!0}function oo(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const lo=(t,e,r)=>t??e??r,Xh=at({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:r}){const n=Ft(bs),i=Ce(()=>t.route||n.value),s=Ft(so,0),a=Ce(()=>{let o=J(s);const{matched:y}=i.value;let m;for(;(m=y[o])&&!m.components;)o++;return o}),d=Ce(()=>i.value.matched[a.value]);Wn(so,Ce(()=>a.value+1)),Wn(Wh,d),Wn(bs,i);const u=Ke();return Rt(()=>[u.value,d.value,t.name],([o,y,m],[f,L,_])=>{y&&(y.instances[m]=o,L&&L!==y&&o&&o===f&&(y.leaveGuards.size||(y.leaveGuards=L.leaveGuards),y.updateGuards.size||(y.updateGuards=L.updateGuards))),o&&y&&(!L||!Ur(y,L)||!f)&&(y.enterCallbacks[m]||[]).forEach(E=>E(o))},{flush:"post"}),()=>{const o=i.value,y=t.name,m=d.value,f=m&&m.components[y];if(!f)return uo(r.default,{Component:f,route:o});const L=m.props[y],_=L?L===!0?o.params:typeof L=="function"?L(o):L:null,l=Qs(f,_e({},_,e,{onVnodeUnmounted:g=>{g.component.isUnmounted&&(m.instances[y]=null)},ref:u}));return uo(r.default,{Component:l,route:o})||l}}});function uo(t,e){if(!t)return null;const r=t(e);return r.length===1?r[0]:r}const Jl=Xh;function Qh(t){const e=_h(t.routes,t),r=t.parseQuery||Hh,n=t.stringifyQuery||io,i=t.history,s=Zr(),a=Zr(),d=Zr(),u=Hn(Kt);let o=Kt;Dr&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const y=Hi.bind(null,V=>""+V),m=Hi.bind(null,jh),f=Hi.bind(null,ai);function L(V,q){let Y,ie;return Kl(V)?(Y=e.getRecordMatcher(V),ie=q):ie=V,e.addRoute(ie,Y)}function _(V){const q=e.getRecordMatcher(V);q&&e.removeRoute(q)}function E(){return e.getRoutes().map(V=>V.record)}function l(V){return!!e.getRecordMatcher(V)}function g(V,q){if(q=_e({},q||u.value),typeof V=="string"){const G=Ki(r,V,q.path),H=e.resolve({path:G.path},q),W=i.createHref(G.fullPath);return _e(G,H,{params:f(H.params),hash:ai(G.hash),redirectedFrom:void 0,href:W})}let Y;if("path"in V)Y=_e({},V,{path:Ki(r,V.path,q.path).path});else{const G=_e({},V.params);for(const H in G)G[H]==null&&delete G[H];Y=_e({},V,{params:m(G)}),q.params=m(q.params)}const ie=e.resolve(Y,q),ue=V.hash||"";ie.params=y(f(ie.params));const N=th(n,_e({},V,{hash:Bh(ue),path:ie.path})),U=i.createHref(N);return _e({fullPath:N,hash:ue,query:n===io?Kh(V.query):V.query||{}},ie,{redirectedFrom:void 0,href:U})}function c(V){return typeof V=="string"?Ki(r,V,u.value.path):_e({},V)}function T(V,q){if(o!==V)return Br(8,{from:q,to:V})}function S(V){return D(V)}function p(V){return S(_e(c(V),{replace:!0}))}function A(V){const q=V.matched[V.matched.length-1];if(q&&q.redirect){const{redirect:Y}=q;let ie=typeof Y=="function"?Y(V):Y;return typeof ie=="string"&&(ie=ie.includes("?")||ie.includes("#")?ie=c(ie):{path:ie},ie.params={}),_e({query:V.query,hash:V.hash,params:"path"in ie?{}:V.params},ie)}}function D(V,q){const Y=o=g(V),ie=u.value,ue=V.state,N=V.force,U=V.replace===!0,G=A(Y);if(G)return D(_e(c(G),{state:typeof G=="object"?_e({},ue,G.state):ue,force:N,replace:U}),q||Y);const H=Y;H.redirectedFrom=q;let W;return!N&&rh(n,ie,Y)&&(W=Br(16,{to:H,from:ie}),B(ie,ie,!0,!1)),(W?Promise.resolve(W):h(H,ie)).catch($=>xt($)?xt($,2)?$:F($):P($,H,ie)).then($=>{if($){if(xt($,2))return D(_e({replace:U},c($.to),{state:typeof $.to=="object"?_e({},ue,$.to.state):ue,force:N}),q||H)}else $=b(H,ie,!0,U,ue);return v(H,ie,$),$})}function w(V,q){const Y=T(V,q);return Y?Promise.reject(Y):Promise.resolve()}function k(V){const q=z.values().next().value;return q&&typeof q.runWithContext=="function"?q.runWithContext(V):V()}function h(V,q){let Y;const[ie,ue,N]=Jh(V,q);Y=Wi(ie.reverse(),"beforeRouteLeave",V,q);for(const G of ie)G.leaveGuards.forEach(H=>{Y.push(qt(H,V,q))});const U=w.bind(null,V,q);return Y.push(U),ne(Y).then(()=>{Y=[];for(const G of s.list())Y.push(qt(G,V,q));return Y.push(U),ne(Y)}).then(()=>{Y=Wi(ue,"beforeRouteUpdate",V,q);for(const G of ue)G.updateGuards.forEach(H=>{Y.push(qt(H,V,q))});return Y.push(U),ne(Y)}).then(()=>{Y=[];for(const G of N)if(G.beforeEnter)if(At(G.beforeEnter))for(const H of G.beforeEnter)Y.push(qt(H,V,q));else Y.push(qt(G.beforeEnter,V,q));return Y.push(U),ne(Y)}).then(()=>(V.matched.forEach(G=>G.enterCallbacks={}),Y=Wi(N,"beforeRouteEnter",V,q),Y.push(U),ne(Y))).then(()=>{Y=[];for(const G of a.list())Y.push(qt(G,V,q));return Y.push(U),ne(Y)}).catch(G=>xt(G,8)?G:Promise.reject(G))}function v(V,q,Y){d.list().forEach(ie=>k(()=>ie(V,q,Y)))}function b(V,q,Y,ie,ue){const N=T(V,q);if(N)return N;const U=q===Kt,G=Dr?history.state:{};Y&&(ie||U?i.replace(V.fullPath,_e({scroll:U&&G&&G.scroll},ue)):i.push(V.fullPath,ue)),u.value=V,B(V,q,Y,U),F()}let R;function I(){R||(R=i.listen((V,q,Y)=>{if(!re.listening)return;const ie=g(V),ue=A(ie);if(ue){D(_e(ue,{replace:!0}),ie).catch(on);return}o=ie;const N=u.value;Dr&&ch(Za(N.fullPath,Y.delta),Ri()),h(ie,N).catch(U=>xt(U,12)?U:xt(U,2)?(D(U.to,ie).then(G=>{xt(G,20)&&!Y.delta&&Y.type===En.pop&&i.go(-1,!1)}).catch(on),Promise.reject()):(Y.delta&&i.go(-Y.delta,!1),P(U,ie,N))).then(U=>{U=U||b(ie,N,!1),U&&(Y.delta&&!xt(U,8)?i.go(-Y.delta,!1):Y.type===En.pop&&xt(U,20)&&i.go(-1,!1)),v(ie,N,U)}).catch(on)}))}let C=Zr(),x=Zr(),O;function P(V,q,Y){F(V);const ie=x.list();return ie.length?ie.forEach(ue=>ue(V,q,Y)):console.error(V),Promise.reject(V)}function M(){return O&&u.value!==Kt?Promise.resolve():new Promise((V,q)=>{C.add([V,q])})}function F(V){return O||(O=!V,I(),C.list().forEach(([q,Y])=>V?Y(V):q()),C.reset()),V}function B(V,q,Y,ie){const{scrollBehavior:ue}=t;if(!Dr||!ue)return Promise.resolve();const N=!Y&&dh(Za(V.fullPath,0))||(ie||!Y)&&history.state&&history.state.scroll||null;return Ei().then(()=>ue(V,q,N)).then(U=>U&&uh(U)).catch(U=>P(U,V,q))}const j=V=>i.go(V);let K;const z=new Set,re={currentRoute:u,listening:!0,addRoute:L,removeRoute:_,hasRoute:l,getRoutes:E,resolve:g,options:t,push:S,replace:p,go:j,back:()=>j(-1),forward:()=>j(1),beforeEach:s.add,beforeResolve:a.add,afterEach:d.add,onError:x.add,isReady:M,install(V){const q=this;V.component("RouterLink",qh),V.component("RouterView",Jl),V.config.globalProperties.$router=q,Object.defineProperty(V.config.globalProperties,"$route",{enumerable:!0,get:()=>J(u)}),Dr&&!K&&u.value===Kt&&(K=!0,S(i.location).catch(ue=>{}));const Y={};for(const ue in Kt)Object.defineProperty(Y,ue,{get:()=>u.value[ue],enumerable:!0});V.provide(ta,q),V.provide(Ql,ll(Y)),V.provide(bs,u);const ie=V.unmount;z.add(V),V.unmount=function(){z.delete(V),z.size<1&&(o=Kt,R&&R(),R=null,u.value=Kt,K=!1,O=!1),ie()}}};function ne(V){return V.reduce((q,Y)=>q.then(()=>k(Y)),Promise.resolve())}return re}function Jh(t,e){const r=[],n=[],i=[],s=Math.max(e.matched.length,t.matched.length);for(let a=0;a<s;a++){const d=e.matched[a];d&&(t.matched.find(o=>Ur(o,d))?n.push(d):r.push(d));const u=t.matched[a];u&&(e.matched.find(o=>Ur(o,u))||i.push(u))}return[r,n,i]}function eu(t){return Xo()?(kc(t),!0):!1}function zi(){const t=new Set,e=i=>{t.delete(i)};return{on:i=>{t.add(i);const s=()=>e(i);return eu(s),{off:s}},off:e,trigger:i=>Promise.all(Array.from(t).map(s=>s(i)))}}function Zt(t){return typeof t=="function"?t():J(t)}const tu=typeof window<"u"&&typeof document<"u",eg=()=>{};function co(t,e=!1,r="Timeout"){return new Promise((n,i)=>{setTimeout(e?()=>i(r):n,t)})}function tg(t,...e){return e.some(r=>r in t)}function Yi(...t){if(t.length!==1)return od(...t);const e=t[0];return typeof e=="function"?vi(id(()=>({get:e,set:eg}))):Ke(e)}function As(t,e=!1){function r(m,{flush:f="sync",deep:L=!1,timeout:_,throwOnTimeout:E}={}){let l=null;const c=[new Promise(T=>{l=Rt(t,S=>{m(S)!==e&&(l==null||l(),T(S))},{flush:f,deep:L,immediate:!0})})];return _!=null&&c.push(co(_,E).then(()=>Zt(t)).finally(()=>l==null?void 0:l())),Promise.race(c)}function n(m,f){if(!Ge(m))return r(S=>S===m,f);const{flush:L="sync",deep:_=!1,timeout:E,throwOnTimeout:l}=f??{};let g=null;const T=[new Promise(S=>{g=Rt([t,m],([p,A])=>{e!==(p===A)&&(g==null||g(),S(p))},{flush:L,deep:_,immediate:!0})})];return E!=null&&T.push(co(E,l).then(()=>Zt(t)).finally(()=>(g==null||g(),Zt(t)))),Promise.race(T)}function i(m){return r(f=>!!f,m)}function s(m){return n(null,m)}function a(m){return n(void 0,m)}function d(m){return r(Number.isNaN,m)}function u(m,f){return r(L=>{const _=Array.from(L);return _.includes(m)||_.includes(Zt(m))},f)}function o(m){return y(1,m)}function y(m=1,f){let L=-1;return r(()=>(L+=1,L>=m),f)}return Array.isArray(Zt(t))?{toMatch:r,toContains:u,changed:o,changedTimes:y,get not(){return As(t,!e)}}:{toMatch:r,toBe:n,toBeTruthy:i,toBeNull:s,toBeNaN:d,toBeUndefined:a,changed:o,changedTimes:y,get not(){return As(t,!e)}}}function rg(t){return As(t)}function ng(t,e,r={}){const{immediate:n=!0}=r,i=Ke(!1);let s=null;function a(){s&&(clearTimeout(s),s=null)}function d(){i.value=!1,a()}function u(...o){a(),i.value=!0,s=setTimeout(()=>{i.value=!1,s=null,t(...o)},Zt(e))}return n&&(i.value=!0,tu&&u()),eu(d),{isPending:vi(i),start:u,stop:d}}const ig=tu?window:void 0,sg={json:"application/json",text:"text/plain"};function fo(t){return t&&tg(t,"immediate","refetch","initialData","timeout","beforeFetch","afterFetch","onFetchError","fetch","updateDataOnError")}function qi(t){return typeof Headers<"u"&&t instanceof Headers?Object.fromEntries([...t.entries()]):t}function ru(t,...e){var r;const n=typeof AbortController=="function";let i={},s={immediate:!0,refetch:!1,timeout:0,updateDataOnError:!1};const a={method:"GET",type:"text",payload:void 0};e.length>0&&(fo(e[0])?s={...s,...e[0]}:i=e[0]),e.length>1&&fo(e[1])&&(s={...s,...e[1]});const{fetch:d=(r=ig)==null?void 0:r.fetch,initialData:u,timeout:o}=s,y=zi(),m=zi(),f=zi(),L=Ke(!1),_=Ke(!1),E=Ke(!1),l=Ke(null),g=Hn(null),c=Hn(null),T=Hn(u||null),S=Ce(()=>n&&_.value);let p,A;const D=()=>{n&&(p==null||p.abort(),p=new AbortController,p.signal.onabort=()=>E.value=!0,i={...i,signal:p.signal})},w=C=>{_.value=C,L.value=!C};o&&(A=ng(D,o,{immediate:!1}));const k=async(C=!1)=>{var x;D(),w(!0),c.value=null,l.value=null,E.value=!1;const O={method:a.method,headers:{}};if(a.payload){const B=qi(O.headers),j=Zt(a.payload);!a.payloadType&&j&&Object.getPrototypeOf(j)===Object.prototype&&!(j instanceof FormData)&&(a.payloadType="json"),a.payloadType&&(B["Content-Type"]=(x=sg[a.payloadType])!=null?x:a.payloadType),O.body=a.payloadType==="json"?JSON.stringify(j):j}let P=!1;const M={url:Zt(t),options:{...O,...i},cancel:()=>{P=!0}};if(s.beforeFetch&&Object.assign(M,await s.beforeFetch(M)),P||!d)return w(!1),Promise.resolve(null);let F=null;return A&&A.start(),new Promise((B,j)=>{var K;d(M.url,{...O,...M.options,headers:{...qi(O.headers),...qi((K=M.options)==null?void 0:K.headers)}}).then(async z=>{if(g.value=z,l.value=z.status,F=await z[a.type](),!z.ok)throw T.value=u||null,new Error(z.statusText);return s.afterFetch&&({data:F}=await s.afterFetch({data:F,response:z})),T.value=F,y.trigger(z),B(z)}).catch(async z=>{let re=z.message||z.name;return s.onFetchError&&({error:re,data:F}=await s.onFetchError({data:F,error:z,response:g.value})),c.value=re,s.updateDataOnError&&(T.value=F),m.trigger(z),C?j(z):B(null)}).finally(()=>{w(!1),A&&A.stop(),f.trigger(null)})})},h=Yi(s.refetch);Rt([h,Yi(t)],([C])=>C&&k(),{deep:!0});const v={isFinished:L,statusCode:l,response:g,error:c,data:T,isFetching:_,canAbort:S,aborted:E,abort:D,execute:k,onFetchResponse:y.on,onFetchError:m.on,onFetchFinally:f.on,get:b("GET"),put:b("PUT"),post:b("POST"),delete:b("DELETE"),patch:b("PATCH"),head:b("HEAD"),options:b("OPTIONS"),json:I("json"),text:I("text"),blob:I("blob"),arrayBuffer:I("arrayBuffer"),formData:I("formData")};function b(C){return(x,O)=>{if(!_.value)return a.method=C,a.payload=x,a.payloadType=O,Ge(a.payload)&&Rt([h,Yi(a.payload)],([P])=>P&&k(),{deep:!0}),{...v,then(P,M){return R().then(P,M)}}}}function R(){return new Promise((C,x)=>{rg(L).toBe(!0).then(()=>C(v)).catch(O=>x(O))})}function I(C){return()=>{if(!_.value)return a.type=C,{...v,then(x,O){return R().then(x,O)}}}}return s.immediate&&Promise.resolve().then(()=>k()),{...v,then(C,x){return R().then(C,x)}}}const ag={class:"nav"},og={key:0},lg="http://localhost",ug=at({__name:"HeadView",setup(t){const{data:e}=ru(`${lg}/api/v1/categories`).get().json();return(r,n)=>{const i=wl("RouterLink");return he(),ge("header",null,[Q("div",ag,[J(e)?(he(),ge("ul",og,[(he(!0),ge(Be,null,br(J(e),s=>(he(),ge("li",{key:s.Category},[pe(i,{to:`/categories/${s.Category}`},{default:Fr(()=>[We(Ae(s.Category),1)]),_:2},1032,["to"])]))),128))])):Pe("",!0)])])}}});const Ii=(t,e)=>{const r=t.__vccOpts||t;for(const[n,i]of e)r[n]=i;return r},cg=Ii(ug,[["__scopeId","data-v-4c154342"]]),dg=at({__name:"App",setup(t){return(e,r)=>(he(),ge(Be,null,[pe(cg),pe(J(Jl))],64))}});class Lr extends Error{}class fg extends Lr{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class hg extends Lr{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class gg extends Lr{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class rn extends Lr{}class nu extends Lr{constructor(e){super(`Invalid unit ${e}`)}}class ct extends Lr{}class Wt extends Lr{constructor(){super("Zone is an abstract class")}}const ae="numeric",Lt="short",st="long",oi={year:ae,month:ae,day:ae},iu={year:ae,month:Lt,day:ae},mg={year:ae,month:Lt,day:ae,weekday:Lt},su={year:ae,month:st,day:ae},au={year:ae,month:st,day:ae,weekday:st},ou={hour:ae,minute:ae},lu={hour:ae,minute:ae,second:ae},uu={hour:ae,minute:ae,second:ae,timeZoneName:Lt},cu={hour:ae,minute:ae,second:ae,timeZoneName:st},du={hour:ae,minute:ae,hourCycle:"h23"},fu={hour:ae,minute:ae,second:ae,hourCycle:"h23"},hu={hour:ae,minute:ae,second:ae,hourCycle:"h23",timeZoneName:Lt},gu={hour:ae,minute:ae,second:ae,hourCycle:"h23",timeZoneName:st},mu={year:ae,month:ae,day:ae,hour:ae,minute:ae},pu={year:ae,month:ae,day:ae,hour:ae,minute:ae,second:ae},vu={year:ae,month:Lt,day:ae,hour:ae,minute:ae},yu={year:ae,month:Lt,day:ae,hour:ae,minute:ae,second:ae},pg={year:ae,month:Lt,day:ae,weekday:Lt,hour:ae,minute:ae},Eu={year:ae,month:st,day:ae,hour:ae,minute:ae,timeZoneName:Lt},Tu={year:ae,month:st,day:ae,hour:ae,minute:ae,second:ae,timeZoneName:Lt},Su={year:ae,month:st,day:ae,weekday:st,hour:ae,minute:ae,timeZoneName:st},bu={year:ae,month:st,day:ae,weekday:st,hour:ae,minute:ae,second:ae,timeZoneName:st};class Ln{get type(){throw new Wt}get name(){throw new Wt}get ianaName(){return this.name}get isUniversal(){throw new Wt}offsetName(e,r){throw new Wt}formatOffset(e,r){throw new Wt}offset(e){throw new Wt}equals(e){throw new Wt}get isValid(){throw new Wt}}let $i=null;class Ci extends Ln{static get instance(){return $i===null&&($i=new Ci),$i}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:r,locale:n}){return Lu(e,r,n)}formatOffset(e,r){return cn(this.offset(e),r)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let qn={};function vg(t){return qn[t]||(qn[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),qn[t]}const yg={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function Eg(t,e){const r=t.format(e).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(r),[,i,s,a,d,u,o,y]=n;return[a,i,s,d,u,o,y]}function Tg(t,e){const r=t.formatToParts(e),n=[];for(let i=0;i<r.length;i++){const{type:s,value:a}=r[i],d=yg[s];s==="era"?n[d]=a:Te(d)||(n[d]=parseInt(a,10))}return n}let Pn={};class Ut extends Ln{static create(e){return Pn[e]||(Pn[e]=new Ut(e)),Pn[e]}static resetCache(){Pn={},qn={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=Ut.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:r,locale:n}){return Lu(e,r,n,this.name)}formatOffset(e,r){return cn(this.offset(e),r)}offset(e){const r=new Date(e);if(isNaN(r))return NaN;const n=vg(this.name);let[i,s,a,d,u,o,y]=n.formatToParts?Tg(n,r):Eg(n,r);d==="BC"&&(i=-Math.abs(i)+1);const f=xi({year:i,month:s,day:a,hour:u===24?0:u,minute:o,second:y,millisecond:0});let L=+r;const _=L%1e3;return L-=_>=0?_:1e3+_,(f-L)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let ho={};function Sg(t,e={}){const r=JSON.stringify([t,e]);let n=ho[r];return n||(n=new Intl.ListFormat(t,e),ho[r]=n),n}let Ls={};function ws(t,e={}){const r=JSON.stringify([t,e]);let n=Ls[r];return n||(n=new Intl.DateTimeFormat(t,e),Ls[r]=n),n}let _s={};function bg(t,e={}){const r=JSON.stringify([t,e]);let n=_s[r];return n||(n=new Intl.NumberFormat(t,e),_s[r]=n),n}let ks={};function Ag(t,e={}){const{base:r,...n}=e,i=JSON.stringify([t,n]);let s=ks[i];return s||(s=new Intl.RelativeTimeFormat(t,e),ks[i]=s),s}let nn=null;function Lg(){return nn||(nn=new Intl.DateTimeFormat().resolvedOptions().locale,nn)}function wg(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const r=t.indexOf("-u-");if(r===-1)return[t];{let n,i;try{n=ws(t).resolvedOptions(),i=t}catch{const u=t.substring(0,r);n=ws(u).resolvedOptions(),i=u}const{numberingSystem:s,calendar:a}=n;return[i,s,a]}}function _g(t,e,r){return(r||e)&&(t.includes("-u-")||(t+="-u"),r&&(t+=`-ca-${r}`),e&&(t+=`-nu-${e}`)),t}function kg(t){const e=[];for(let r=1;r<=12;r++){const n=me.utc(2009,r,1);e.push(t(n))}return e}function Dg(t){const e=[];for(let r=1;r<=7;r++){const n=me.utc(2016,11,13+r);e.push(t(n))}return e}function Mn(t,e,r,n){const i=t.listingMode();return i==="error"?null:i==="en"?r(e):n(e)}function Rg(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}class Ig{constructor(e,r,n){this.padTo=n.padTo||0,this.floor=n.floor||!1;const{padTo:i,floor:s,...a}=n;if(!r||Object.keys(a).length>0){const d={useGrouping:!1,...n};n.padTo>0&&(d.minimumIntegerDigits=n.padTo),this.inf=bg(e,d)}}format(e){if(this.inf){const r=this.floor?Math.floor(e):e;return this.inf.format(r)}else{const r=this.floor?Math.floor(e):na(e,3);return Ue(r,this.padTo)}}}class Cg{constructor(e,r,n){this.opts=n,this.originalZone=void 0;let i;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const a=-1*(e.offset/60),d=a>=0?`Etc/GMT+${a}`:`Etc/GMT${a}`;e.offset!==0&&Ut.create(d).valid?(i=d,this.dt=e):(i="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,i=e.zone.name):(i="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||i,this.dtf=ws(r,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(r=>{if(r.type==="timeZoneName"){const n=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...r,value:n}}else return r}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class Og{constructor(e,r,n){this.opts={style:"long",...n},!r&&Au()&&(this.rtf=Ag(e,n))}format(e,r){return this.rtf?this.rtf.format(e,r):$g(r,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,r){return this.rtf?this.rtf.formatToParts(e,r):[]}}class Re{static fromOpts(e){return Re.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,r,n,i=!1){const s=e||Ne.defaultLocale,a=s||(i?"en-US":Lg()),d=r||Ne.defaultNumberingSystem,u=n||Ne.defaultOutputCalendar;return new Re(a,d,u,s)}static resetCache(){nn=null,Ls={},_s={},ks={}}static fromObject({locale:e,numberingSystem:r,outputCalendar:n}={}){return Re.create(e,r,n)}constructor(e,r,n,i){const[s,a,d]=wg(e);this.locale=s,this.numberingSystem=r||a||null,this.outputCalendar=n||d||null,this.intl=_g(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=i,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=Rg(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),r=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&r?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Re.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,r=!1){return Mn(this,e,ku,()=>{const n=r?{month:e,day:"numeric"}:{month:e},i=r?"format":"standalone";return this.monthsCache[i][e]||(this.monthsCache[i][e]=kg(s=>this.extract(s,n,"month"))),this.monthsCache[i][e]})}weekdays(e,r=!1){return Mn(this,e,Iu,()=>{const n=r?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},i=r?"format":"standalone";return this.weekdaysCache[i][e]||(this.weekdaysCache[i][e]=Dg(s=>this.extract(s,n,"weekday"))),this.weekdaysCache[i][e]})}meridiems(){return Mn(this,void 0,()=>Cu,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[me.utc(2016,11,13,9),me.utc(2016,11,13,19)].map(r=>this.extract(r,e,"dayperiod"))}return this.meridiemCache})}eras(e){return Mn(this,e,Ou,()=>{const r={era:e};return this.eraCache[e]||(this.eraCache[e]=[me.utc(-40,1,1),me.utc(2017,1,1)].map(n=>this.extract(n,r,"era"))),this.eraCache[e]})}extract(e,r,n){const i=this.dtFormatter(e,r),s=i.formatToParts(),a=s.find(d=>d.type.toLowerCase()===n);return a?a.value:null}numberFormatter(e={}){return new Ig(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,r={}){return new Cg(e,this.intl,r)}relFormatter(e={}){return new Og(this.intl,this.isEnglish(),e)}listFormatter(e={}){return Sg(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let Zi=null;class Xe extends Ln{static get utcInstance(){return Zi===null&&(Zi=new Xe(0)),Zi}static instance(e){return e===0?Xe.utcInstance:new Xe(e)}static parseSpecifier(e){if(e){const r=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new Xe(Pi(r[1],r[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${cn(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${cn(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,r){return cn(this.fixed,r)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class xg extends Ln{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Xt(t,e){if(Te(t)||t===null)return e;if(t instanceof Ln)return t;if(Pg(t)){const r=t.toLowerCase();return r==="default"?e:r==="local"||r==="system"?Ci.instance:r==="utc"||r==="gmt"?Xe.utcInstance:Xe.parseSpecifier(r)||Ut.create(t)}else return Sr(t)?Xe.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new xg(t)}let go=()=>Date.now(),mo="system",po=null,vo=null,yo=null,Eo=60,To;class Ne{static get now(){return go}static set now(e){go=e}static set defaultZone(e){mo=e}static get defaultZone(){return Xt(mo,Ci.instance)}static get defaultLocale(){return po}static set defaultLocale(e){po=e}static get defaultNumberingSystem(){return vo}static set defaultNumberingSystem(e){vo=e}static get defaultOutputCalendar(){return yo}static set defaultOutputCalendar(e){yo=e}static get twoDigitCutoffYear(){return Eo}static set twoDigitCutoffYear(e){Eo=e%100}static get throwOnInvalid(){return To}static set throwOnInvalid(e){To=e}static resetCaches(){Re.resetCache(),Ut.resetCache()}}function Te(t){return typeof t>"u"}function Sr(t){return typeof t=="number"}function Oi(t){return typeof t=="number"&&t%1===0}function Pg(t){return typeof t=="string"}function Mg(t){return Object.prototype.toString.call(t)==="[object Date]"}function Au(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Fg(t){return Array.isArray(t)?t:[t]}function So(t,e,r){if(t.length!==0)return t.reduce((n,i)=>{const s=[e(i),i];return n&&r(n[0],s[0])===n[0]?n:s},null)[1]}function Ng(t,e){return e.reduce((r,n)=>(r[n]=t[n],r),{})}function Gr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Mt(t,e,r){return Oi(t)&&t>=e&&t<=r}function Ug(t,e){return t-e*Math.floor(t/e)}function Ue(t,e=2){const r=t<0;let n;return r?n="-"+(""+-t).padStart(e,"0"):n=(""+t).padStart(e,"0"),n}function $t(t){if(!(Te(t)||t===null||t===""))return parseInt(t,10)}function cr(t){if(!(Te(t)||t===null||t===""))return parseFloat(t)}function ra(t){if(!(Te(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function na(t,e,r=!1){const n=10**e;return(r?Math.trunc:Math.round)(t*n)/n}function wn(t){return t%4===0&&(t%100!==0||t%400===0)}function un(t){return wn(t)?366:365}function li(t,e){const r=Ug(e-1,12)+1,n=t+(e-r)/12;return r===2?wn(n)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][r-1]}function xi(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function ui(t){const e=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7,r=t-1,n=(r+Math.floor(r/4)-Math.floor(r/100)+Math.floor(r/400))%7;return e===4||n===3?53:52}function Ds(t){return t>99?t:t>Ne.twoDigitCutoffYear?1900+t:2e3+t}function Lu(t,e,r,n=null){const i=new Date(t),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(s.timeZone=n);const a={timeZoneName:e,...s},d=new Intl.DateTimeFormat(r,a).formatToParts(i).find(u=>u.type.toLowerCase()==="timezonename");return d?d.value:null}function Pi(t,e){let r=parseInt(t,10);Number.isNaN(r)&&(r=0);const n=parseInt(e,10)||0,i=r<0||Object.is(r,-0)?-n:n;return r*60+i}function wu(t){const e=Number(t);if(typeof t=="boolean"||t===""||Number.isNaN(e))throw new ct(`Invalid unit value ${t}`);return e}function ci(t,e){const r={};for(const n in t)if(Gr(t,n)){const i=t[n];if(i==null)continue;r[e(n)]=wu(i)}return r}function cn(t,e){const r=Math.trunc(Math.abs(t/60)),n=Math.trunc(Math.abs(t%60)),i=t>=0?"+":"-";switch(e){case"short":return`${i}${Ue(r,2)}:${Ue(n,2)}`;case"narrow":return`${i}${r}${n>0?`:${n}`:""}`;case"techie":return`${i}${Ue(r,2)}${Ue(n,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function Mi(t){return Ng(t,["hour","minute","second","millisecond"])}const Bg=["January","February","March","April","May","June","July","August","September","October","November","December"],_u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Gg=["J","F","M","A","M","J","J","A","S","O","N","D"];function ku(t){switch(t){case"narrow":return[...Gg];case"short":return[..._u];case"long":return[...Bg];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const Du=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Ru=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Vg=["M","T","W","T","F","S","S"];function Iu(t){switch(t){case"narrow":return[...Vg];case"short":return[...Ru];case"long":return[...Du];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const Cu=["AM","PM"],jg=["Before Christ","Anno Domini"],Hg=["BC","AD"],Kg=["B","A"];function Ou(t){switch(t){case"narrow":return[...Kg];case"short":return[...Hg];case"long":return[...jg];default:return null}}function Wg(t){return Cu[t.hour<12?0:1]}function zg(t,e){return Iu(e)[t.weekday-1]}function Yg(t,e){return ku(e)[t.month-1]}function qg(t,e){return Ou(e)[t.year<0?0:1]}function $g(t,e,r="always",n=!1){const i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(t)===-1;if(r==="auto"&&s){const m=t==="days";switch(e){case 1:return m?"tomorrow":`next ${i[t][0]}`;case-1:return m?"yesterday":`last ${i[t][0]}`;case 0:return m?"today":`this ${i[t][0]}`}}const a=Object.is(e,-0)||e<0,d=Math.abs(e),u=d===1,o=i[t],y=n?u?o[1]:o[2]||o[1]:u?i[t][0]:t;return a?`${d} ${y} ago`:`in ${d} ${y}`}function bo(t,e){let r="";for(const n of t)n.literal?r+=n.val:r+=e(n.val);return r}const Zg={D:oi,DD:iu,DDD:su,DDDD:au,t:ou,tt:lu,ttt:uu,tttt:cu,T:du,TT:fu,TTT:hu,TTTT:gu,f:mu,ff:vu,fff:Eu,ffff:Su,F:pu,FF:yu,FFF:Tu,FFFF:bu};class Ye{static create(e,r={}){return new Ye(e,r)}static parseFormat(e){let r=null,n="",i=!1;const s=[];for(let a=0;a<e.length;a++){const d=e.charAt(a);d==="'"?(n.length>0&&s.push({literal:i||/^\s+$/.test(n),val:n}),r=null,n="",i=!i):i||d===r?n+=d:(n.length>0&&s.push({literal:/^\s+$/.test(n),val:n}),n=d,r=d)}return n.length>0&&s.push({literal:i||/^\s+$/.test(n),val:n}),s}static macroTokenToFormatOpts(e){return Zg[e]}constructor(e,r){this.opts=r,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,r){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...r}).format()}dtFormatter(e,r={}){return this.loc.dtFormatter(e,{...this.opts,...r})}formatDateTime(e,r){return this.dtFormatter(e,r).format()}formatDateTimeParts(e,r){return this.dtFormatter(e,r).formatToParts()}formatInterval(e,r){return this.dtFormatter(e.start,r).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,r){return this.dtFormatter(e,r).resolvedOptions()}num(e,r=0){if(this.opts.forceSimple)return Ue(e,r);const n={...this.opts};return r>0&&(n.padTo=r),this.loc.numberFormatter(n).format(e)}formatDateTimeFromString(e,r){const n=this.loc.listingMode()==="en",i=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(L,_)=>this.loc.extract(e,L,_),a=L=>e.isOffsetFixed&&e.offset===0&&L.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,L.format):"",d=()=>n?Wg(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),u=(L,_)=>n?Yg(e,L):s(_?{month:L}:{month:L,day:"numeric"},"month"),o=(L,_)=>n?zg(e,L):s(_?{weekday:L}:{weekday:L,month:"long",day:"numeric"},"weekday"),y=L=>{const _=Ye.macroTokenToFormatOpts(L);return _?this.formatWithSystemDefault(e,_):L},m=L=>n?qg(e,L):s({era:L},"era"),f=L=>{switch(L){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return a({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return a({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return a({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return d();case"d":return i?s({day:"numeric"},"day"):this.num(e.day);case"dd":return i?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return o("short",!0);case"cccc":return o("long",!0);case"ccccc":return o("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return o("short",!1);case"EEEE":return o("long",!1);case"EEEEE":return o("narrow",!1);case"L":return i?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return i?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return i?s({month:"numeric"},"month"):this.num(e.month);case"MM":return i?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return i?s({year:"numeric"},"year"):this.num(e.year);case"yy":return i?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return i?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return i?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return m("short");case"GG":return m("long");case"GGGGG":return m("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return y(L)}};return bo(Ye.parseFormat(r),f)}formatDurationFromString(e,r){const n=u=>{switch(u[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},i=u=>o=>{const y=n(o);return y?this.num(u.get(y),o.length):o},s=Ye.parseFormat(r),a=s.reduce((u,{literal:o,val:y})=>o?u:u.concat(y),[]),d=e.shiftTo(...a.map(n).filter(u=>u));return bo(s,i(d))}}class Tt{constructor(e,r){this.reason=e,this.explanation=r}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const xu=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Hr(...t){const e=t.reduce((r,n)=>r+n.source,"");return RegExp(`^${e}$`)}function Kr(...t){return e=>t.reduce(([r,n,i],s)=>{const[a,d,u]=s(e,i);return[{...r,...a},d||n,u]},[{},null,1]).slice(0,2)}function Wr(t,...e){if(t==null)return[null,null];for(const[r,n]of e){const i=r.exec(t);if(i)return n(i)}return[null,null]}function Pu(...t){return(e,r)=>{const n={};let i;for(i=0;i<t.length;i++)n[t[i]]=$t(e[r+i]);return[n,null,r+i]}}const Mu=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Xg=`(?:${Mu.source}?(?:\\[(${xu.source})\\])?)?`,ia=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Fu=RegExp(`${ia.source}${Xg}`),sa=RegExp(`(?:T${Fu.source})?`),Qg=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Jg=/(\d{4})-?W(\d\d)(?:-?(\d))?/,em=/(\d{4})-?(\d{3})/,tm=Pu("weekYear","weekNumber","weekDay"),rm=Pu("year","ordinal"),nm=/(\d{4})-(\d\d)-(\d\d)/,Nu=RegExp(`${ia.source} ?(?:${Mu.source}|(${xu.source}))?`),im=RegExp(`(?: ${Nu.source})?`);function xr(t,e,r){const n=t[e];return Te(n)?r:$t(n)}function sm(t,e){return[{year:xr(t,e),month:xr(t,e+1,1),day:xr(t,e+2,1)},null,e+3]}function zr(t,e){return[{hours:xr(t,e,0),minutes:xr(t,e+1,0),seconds:xr(t,e+2,0),milliseconds:ra(t[e+3])},null,e+4]}function _n(t,e){const r=!t[e]&&!t[e+1],n=Pi(t[e+1],t[e+2]),i=r?null:Xe.instance(n);return[{},i,e+3]}function kn(t,e){const r=t[e]?Ut.create(t[e]):null;return[{},r,e+1]}const am=RegExp(`^T?${ia.source}$`),om=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function lm(t){const[e,r,n,i,s,a,d,u,o]=t,y=e[0]==="-",m=u&&u[0]==="-",f=(L,_=!1)=>L!==void 0&&(_||L&&y)?-L:L;return[{years:f(cr(r)),months:f(cr(n)),weeks:f(cr(i)),days:f(cr(s)),hours:f(cr(a)),minutes:f(cr(d)),seconds:f(cr(u),u==="-0"),milliseconds:f(ra(o),m)}]}const um={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function aa(t,e,r,n,i,s,a){const d={year:e.length===2?Ds($t(e)):$t(e),month:_u.indexOf(r)+1,day:$t(n),hour:$t(i),minute:$t(s)};return a&&(d.second=$t(a)),t&&(d.weekday=t.length>3?Du.indexOf(t)+1:Ru.indexOf(t)+1),d}const cm=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function dm(t){const[,e,r,n,i,s,a,d,u,o,y,m]=t,f=aa(e,i,n,r,s,a,d);let L;return u?L=um[u]:o?L=0:L=Pi(y,m),[f,new Xe(L)]}function fm(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const hm=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,gm=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,mm=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Ao(t){const[,e,r,n,i,s,a,d]=t;return[aa(e,i,n,r,s,a,d),Xe.utcInstance]}function pm(t){const[,e,r,n,i,s,a,d]=t;return[aa(e,d,r,n,i,s,a),Xe.utcInstance]}const vm=Hr(Qg,sa),ym=Hr(Jg,sa),Em=Hr(em,sa),Tm=Hr(Fu),Uu=Kr(sm,zr,_n,kn),Sm=Kr(tm,zr,_n,kn),bm=Kr(rm,zr,_n,kn),Am=Kr(zr,_n,kn);function Lm(t){return Wr(t,[vm,Uu],[ym,Sm],[Em,bm],[Tm,Am])}function wm(t){return Wr(fm(t),[cm,dm])}function _m(t){return Wr(t,[hm,Ao],[gm,Ao],[mm,pm])}function km(t){return Wr(t,[om,lm])}const Dm=Kr(zr);function Rm(t){return Wr(t,[am,Dm])}const Im=Hr(nm,im),Cm=Hr(Nu),Om=Kr(zr,_n,kn);function xm(t){return Wr(t,[Im,Uu],[Cm,Om])}const Lo="Invalid Duration",Bu={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},Pm={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...Bu},ut=146097/400,_r=146097/4800,Mm={years:{quarters:4,months:12,weeks:ut/7,days:ut,hours:ut*24,minutes:ut*24*60,seconds:ut*24*60*60,milliseconds:ut*24*60*60*1e3},quarters:{months:3,weeks:ut/28,days:ut/4,hours:ut*24/4,minutes:ut*24*60/4,seconds:ut*24*60*60/4,milliseconds:ut*24*60*60*1e3/4},months:{weeks:_r/7,days:_r,hours:_r*24,minutes:_r*24*60,seconds:_r*24*60*60,milliseconds:_r*24*60*60*1e3},...Bu},vr=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Fm=vr.slice(0).reverse();function zt(t,e,r=!1){const n={values:r?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new Se(n)}function Gu(t,e){let r=e.milliseconds??0;for(const n of Fm.slice(1))e[n]&&(r+=e[n]*t[n].milliseconds);return r}function wo(t,e){const r=Gu(t,e)<0?-1:1;vr.reduceRight((n,i)=>{if(Te(e[i]))return n;if(n){const s=e[n]*r,a=t[i][n],d=Math.floor(s/a);e[i]+=d*r,e[n]-=d*a*r}return i},null),vr.reduce((n,i)=>{if(Te(e[i]))return n;if(n){const s=e[n]%1;e[n]-=s,e[i]+=s*t[n][i]}return i},null)}function Nm(t){const e={};for(const[r,n]of Object.entries(t))n!==0&&(e[r]=n);return e}class Se{constructor(e){const r=e.conversionAccuracy==="longterm"||!1;let n=r?Mm:Pm;e.matrix&&(n=e.matrix),this.values=e.values,this.loc=e.loc||Re.create(),this.conversionAccuracy=r?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=n,this.isLuxonDuration=!0}static fromMillis(e,r){return Se.fromObject({milliseconds:e},r)}static fromObject(e,r={}){if(e==null||typeof e!="object")throw new ct(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Se({values:ci(e,Se.normalizeUnit),loc:Re.fromObject(r),conversionAccuracy:r.conversionAccuracy,matrix:r.matrix})}static fromDurationLike(e){if(Sr(e))return Se.fromMillis(e);if(Se.isDuration(e))return e;if(typeof e=="object")return Se.fromObject(e);throw new ct(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,r){const[n]=km(e);return n?Se.fromObject(n,r):Se.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,r){const[n]=Rm(e);return n?Se.fromObject(n,r):Se.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,r=null){if(!e)throw new ct("need to specify a reason the Duration is invalid");const n=e instanceof Tt?e:new Tt(e,r);if(Ne.throwOnInvalid)throw new gg(n);return new Se({invalid:n})}static normalizeUnit(e){const r={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!r)throw new nu(e);return r}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,r={}){const n={...r,floor:r.round!==!1&&r.floor!==!1};return this.isValid?Ye.create(this.loc,n).formatDurationFromString(this,e):Lo}toHuman(e={}){if(!this.isValid)return Lo;const r=vr.map(n=>{const i=this.values[n];return Te(i)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:n.slice(0,-1)}).format(i)}).filter(n=>n);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(r)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=na(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const r=this.toMillis();return r<0||r>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},me.fromMillis(r,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.isValid?Gu(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const r=Se.fromDurationLike(e),n={};for(const i of vr)(Gr(r.values,i)||Gr(this.values,i))&&(n[i]=r.get(i)+this.get(i));return zt(this,{values:n},!0)}minus(e){if(!this.isValid)return this;const r=Se.fromDurationLike(e);return this.plus(r.negate())}mapUnits(e){if(!this.isValid)return this;const r={};for(const n of Object.keys(this.values))r[n]=wu(e(this.values[n],n));return zt(this,{values:r},!0)}get(e){return this[Se.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const r={...this.values,...ci(e,Se.normalizeUnit)};return zt(this,{values:r})}reconfigure({locale:e,numberingSystem:r,conversionAccuracy:n,matrix:i}={}){const a={loc:this.loc.clone({locale:e,numberingSystem:r}),matrix:i,conversionAccuracy:n};return zt(this,a)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return wo(this.matrix,e),zt(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=Nm(this.normalize().shiftToAll().toObject());return zt(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(a=>Se.normalizeUnit(a));const r={},n={},i=this.toObject();let s;for(const a of vr)if(e.indexOf(a)>=0){s=a;let d=0;for(const o in n)d+=this.matrix[o][a]*n[o],n[o]=0;Sr(i[a])&&(d+=i[a]);const u=Math.trunc(d);r[a]=u,n[a]=(d*1e3-u*1e3)/1e3}else Sr(i[a])&&(n[a]=i[a]);for(const a in n)n[a]!==0&&(r[s]+=a===s?n[a]:n[a]/this.matrix[s][a]);return wo(this.matrix,r),zt(this,{values:r},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const r of Object.keys(this.values))e[r]=this.values[r]===0?0:-this.values[r];return zt(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function r(n,i){return n===void 0||n===0?i===void 0||i===0:n===i}for(const n of vr)if(!r(this.values[n],e.values[n]))return!1;return!0}}const kr="Invalid Interval";function Um(t,e){return!t||!t.isValid?Oe.invalid("missing or invalid start"):!e||!e.isValid?Oe.invalid("missing or invalid end"):e<t?Oe.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class Oe{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,r=null){if(!e)throw new ct("need to specify a reason the Interval is invalid");const n=e instanceof Tt?e:new Tt(e,r);if(Ne.throwOnInvalid)throw new hg(n);return new Oe({invalid:n})}static fromDateTimes(e,r){const n=Qr(e),i=Qr(r),s=Um(n,i);return s??new Oe({start:n,end:i})}static after(e,r){const n=Se.fromDurationLike(r),i=Qr(e);return Oe.fromDateTimes(i,i.plus(n))}static before(e,r){const n=Se.fromDurationLike(r),i=Qr(e);return Oe.fromDateTimes(i.minus(n),i)}static fromISO(e,r){const[n,i]=(e||"").split("/",2);if(n&&i){let s,a;try{s=me.fromISO(n,r),a=s.isValid}catch{a=!1}let d,u;try{d=me.fromISO(i,r),u=d.isValid}catch{u=!1}if(a&&u)return Oe.fromDateTimes(s,d);if(a){const o=Se.fromISO(i,r);if(o.isValid)return Oe.after(s,o)}else if(u){const o=Se.fromISO(n,r);if(o.isValid)return Oe.before(d,o)}}return Oe.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;const r=this.start.startOf(e),n=this.end.startOf(e);return Math.floor(n.diff(r,e).get(e))+(n.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:r}={}){return this.isValid?Oe.fromDateTimes(e||this.s,r||this.e):this}splitAt(...e){if(!this.isValid)return[];const r=e.map(Qr).filter(a=>this.contains(a)).sort(),n=[];let{s:i}=this,s=0;for(;i<this.e;){const a=r[s]||this.e,d=+a>+this.e?this.e:a;n.push(Oe.fromDateTimes(i,d)),i=d,s+=1}return n}splitBy(e){const r=Se.fromDurationLike(e);if(!this.isValid||!r.isValid||r.as("milliseconds")===0)return[];let{s:n}=this,i=1,s;const a=[];for(;n<this.e;){const d=this.start.plus(r.mapUnits(u=>u*i));s=+d>+this.e?this.e:d,a.push(Oe.fromDateTimes(n,s)),n=s,i+=1}return a}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const r=this.s>e.s?this.s:e.s,n=this.e<e.e?this.e:e.e;return r>=n?null:Oe.fromDateTimes(r,n)}union(e){if(!this.isValid)return this;const r=this.s<e.s?this.s:e.s,n=this.e>e.e?this.e:e.e;return Oe.fromDateTimes(r,n)}static merge(e){const[r,n]=e.sort((i,s)=>i.s-s.s).reduce(([i,s],a)=>s?s.overlaps(a)||s.abutsStart(a)?[i,s.union(a)]:[i.concat([s]),a]:[i,a],[[],null]);return n&&r.push(n),r}static xor(e){let r=null,n=0;const i=[],s=e.map(u=>[{time:u.s,type:"s"},{time:u.e,type:"e"}]),a=Array.prototype.concat(...s),d=a.sort((u,o)=>u.time-o.time);for(const u of d)n+=u.type==="s"?1:-1,n===1?r=u.time:(r&&+r!=+u.time&&i.push(Oe.fromDateTimes(r,u.time)),r=null);return Oe.merge(i)}difference(...e){return Oe.xor([this].concat(e)).map(r=>this.intersection(r)).filter(r=>r&&!r.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:kr}toLocaleString(e=oi,r={}){return this.isValid?Ye.create(this.s.loc.clone(r),e).formatInterval(this):kr}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:kr}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:kr}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:kr}toFormat(e,{separator:r="  "}={}){return this.isValid?`${this.s.toFormat(e)}${r}${this.e.toFormat(e)}`:kr}toDuration(e,r){return this.isValid?this.e.diff(this.s,e,r):Se.invalid(this.invalidReason)}mapEndpoints(e){return Oe.fromDateTimes(e(this.s),e(this.e))}}class Fn{static hasDST(e=Ne.defaultZone){const r=me.now().setZone(e).set({month:12});return!e.isUniversal&&r.offset!==r.set({month:6}).offset}static isValidIANAZone(e){return Ut.isValidZone(e)}static normalizeZone(e){return Xt(e,Ne.defaultZone)}static months(e="long",{locale:r=null,numberingSystem:n=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||Re.create(r,n,s)).months(e)}static monthsFormat(e="long",{locale:r=null,numberingSystem:n=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||Re.create(r,n,s)).months(e,!0)}static weekdays(e="long",{locale:r=null,numberingSystem:n=null,locObj:i=null}={}){return(i||Re.create(r,n,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:r=null,numberingSystem:n=null,locObj:i=null}={}){return(i||Re.create(r,n,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Re.create(e).meridiems()}static eras(e="short",{locale:r=null}={}){return Re.create(r,null,"gregory").eras(e)}static features(){return{relative:Au()}}}function _o(t,e){const r=i=>i.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),n=r(e)-r(t);return Math.floor(Se.fromMillis(n).as("days"))}function Bm(t,e,r){const n=[["years",(u,o)=>o.year-u.year],["quarters",(u,o)=>o.quarter-u.quarter+(o.year-u.year)*4],["months",(u,o)=>o.month-u.month+(o.year-u.year)*12],["weeks",(u,o)=>{const y=_o(u,o);return(y-y%7)/7}],["days",_o]],i={},s=t;let a,d;for(const[u,o]of n)r.indexOf(u)>=0&&(a=u,i[u]=o(t,e),d=s.plus(i),d>e?(i[u]--,t=s.plus(i),t>e&&(d=t,i[u]--,t=s.plus(i))):t=d);return[t,i,d,a]}function Gm(t,e,r,n){let[i,s,a,d]=Bm(t,e,r);const u=e-i,o=r.filter(m=>["hours","minutes","seconds","milliseconds"].indexOf(m)>=0);o.length===0&&(a<e&&(a=i.plus({[d]:1})),a!==i&&(s[d]=(s[d]||0)+u/(a-i)));const y=Se.fromObject(s,n);return o.length>0?Se.fromMillis(u,n).shiftTo(...o).plus(y):y}const oa={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},ko={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Vm=oa.hanidec.replace(/[\[|\]]/g,"").split("");function jm(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let r=0;r<t.length;r++){const n=t.charCodeAt(r);if(t[r].search(oa.hanidec)!==-1)e+=Vm.indexOf(t[r]);else for(const i in ko){const[s,a]=ko[i];n>=s&&n<=a&&(e+=n-s)}}return parseInt(e,10)}else return e}function gt({numberingSystem:t},e=""){return new RegExp(`${oa[t||"latn"]}${e}`)}const Hm="missing Intl.DateTimeFormat.formatToParts support";function we(t,e=r=>r){return{regex:t,deser:([r])=>e(jm(r))}}const Km=String.fromCharCode(160),Vu=`[ ${Km}]`,ju=new RegExp(Vu,"g");function Wm(t){return t.replace(/\./g,"\\.?").replace(ju,Vu)}function Do(t){return t.replace(/\./g,"").replace(ju," ").toLowerCase()}function mt(t,e){return t===null?null:{regex:RegExp(t.map(Wm).join("|")),deser:([r])=>t.findIndex(n=>Do(r)===Do(n))+e}}function Ro(t,e){return{regex:t,deser:([,r,n])=>Pi(r,n),groups:e}}function Nn(t){return{regex:t,deser:([e])=>e}}function zm(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Ym(t,e){const r=gt(e),n=gt(e,"{2}"),i=gt(e,"{3}"),s=gt(e,"{4}"),a=gt(e,"{6}"),d=gt(e,"{1,2}"),u=gt(e,"{1,3}"),o=gt(e,"{1,6}"),y=gt(e,"{1,9}"),m=gt(e,"{2,4}"),f=gt(e,"{4,6}"),L=l=>({regex:RegExp(zm(l.val)),deser:([g])=>g,literal:!0}),E=(l=>{if(t.literal)return L(l);switch(l.val){case"G":return mt(e.eras("short"),0);case"GG":return mt(e.eras("long"),0);case"y":return we(o);case"yy":return we(m,Ds);case"yyyy":return we(s);case"yyyyy":return we(f);case"yyyyyy":return we(a);case"M":return we(d);case"MM":return we(n);case"MMM":return mt(e.months("short",!0),1);case"MMMM":return mt(e.months("long",!0),1);case"L":return we(d);case"LL":return we(n);case"LLL":return mt(e.months("short",!1),1);case"LLLL":return mt(e.months("long",!1),1);case"d":return we(d);case"dd":return we(n);case"o":return we(u);case"ooo":return we(i);case"HH":return we(n);case"H":return we(d);case"hh":return we(n);case"h":return we(d);case"mm":return we(n);case"m":return we(d);case"q":return we(d);case"qq":return we(n);case"s":return we(d);case"ss":return we(n);case"S":return we(u);case"SSS":return we(i);case"u":return Nn(y);case"uu":return Nn(d);case"uuu":return we(r);case"a":return mt(e.meridiems(),0);case"kkkk":return we(s);case"kk":return we(m,Ds);case"W":return we(d);case"WW":return we(n);case"E":case"c":return we(r);case"EEE":return mt(e.weekdays("short",!1),1);case"EEEE":return mt(e.weekdays("long",!1),1);case"ccc":return mt(e.weekdays("short",!0),1);case"cccc":return mt(e.weekdays("long",!0),1);case"Z":case"ZZ":return Ro(new RegExp(`([+-]${d.source})(?::(${n.source}))?`),2);case"ZZZ":return Ro(new RegExp(`([+-]${d.source})(${n.source})?`),2);case"z":return Nn(/[a-z_+-/]{1,256}?/i);case" ":return Nn(/[^\S\n\r]/);default:return L(l)}})(t)||{invalidReason:Hm};return E.token=t,E}const qm={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function $m(t,e,r){const{type:n,value:i}=t;if(n==="literal"){const u=/^\s+$/.test(i);return{literal:!u,val:u?" ":i}}const s=e[n];let a=n;n==="hour"&&(e.hour12!=null?a=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?a="hour12":a="hour24":a=r.hour12?"hour12":"hour24");let d=qm[a];if(typeof d=="object"&&(d=d[s]),d)return{literal:!1,val:d}}function Zm(t){return[`^${t.map(r=>r.regex).reduce((r,n)=>`${r}(${n.source})`,"")}$`,t]}function Xm(t,e,r){const n=t.match(e);if(n){const i={};let s=1;for(const a in r)if(Gr(r,a)){const d=r[a],u=d.groups?d.groups+1:1;!d.literal&&d.token&&(i[d.token.val[0]]=d.deser(n.slice(s,s+u))),s+=u}return[n,i]}else return[n,{}]}function Qm(t){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let r=null,n;return Te(t.z)||(r=Ut.create(t.z)),Te(t.Z)||(r||(r=new Xe(t.Z)),n=t.Z),Te(t.q)||(t.M=(t.q-1)*3+1),Te(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Te(t.u)||(t.S=ra(t.u)),[Object.keys(t).reduce((s,a)=>{const d=e(a);return d&&(s[d]=t[a]),s},{}),r,n]}let Xi=null;function Jm(){return Xi||(Xi=me.fromMillis(1555555555555)),Xi}function ep(t,e){if(t.literal)return t;const r=Ye.macroTokenToFormatOpts(t.val),n=Wu(r,e);return n==null||n.includes(void 0)?t:n}function Hu(t,e){return Array.prototype.concat(...t.map(r=>ep(r,e)))}function Ku(t,e,r){const n=Hu(Ye.parseFormat(r),t),i=n.map(a=>Ym(a,t)),s=i.find(a=>a.invalidReason);if(s)return{input:e,tokens:n,invalidReason:s.invalidReason};{const[a,d]=Zm(i),u=RegExp(a,"i"),[o,y]=Xm(e,u,d),[m,f,L]=y?Qm(y):[null,null,void 0];if(Gr(y,"a")&&Gr(y,"H"))throw new rn("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:n,regex:u,rawMatches:o,matches:y,result:m,zone:f,specificOffset:L}}}function tp(t,e,r){const{result:n,zone:i,specificOffset:s,invalidReason:a}=Ku(t,e,r);return[n,i,s,a]}function Wu(t,e){if(!t)return null;const n=Ye.create(e,t).dtFormatter(Jm()),i=n.formatToParts(),s=n.resolvedOptions();return i.map(a=>$m(a,t,s))}const zu=[0,31,59,90,120,151,181,212,243,273,304,334],Yu=[0,31,60,91,121,152,182,213,244,274,305,335];function dt(t,e){return new Tt("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function qu(t,e,r){const n=new Date(Date.UTC(t,e-1,r));t<100&&t>=0&&n.setUTCFullYear(n.getUTCFullYear()-1900);const i=n.getUTCDay();return i===0?7:i}function $u(t,e,r){return r+(wn(t)?Yu:zu)[e-1]}function Zu(t,e){const r=wn(t)?Yu:zu,n=r.findIndex(s=>s<e),i=e-r[n];return{month:n+1,day:i}}function Rs(t){const{year:e,month:r,day:n}=t,i=$u(e,r,n),s=qu(e,r,n);let a=Math.floor((i-s+10)/7),d;return a<1?(d=e-1,a=ui(d)):a>ui(e)?(d=e+1,a=1):d=e,{weekYear:d,weekNumber:a,weekday:s,...Mi(t)}}function Io(t){const{weekYear:e,weekNumber:r,weekday:n}=t,i=qu(e,1,4),s=un(e);let a=r*7+n-i-3,d;a<1?(d=e-1,a+=un(d)):a>s?(d=e+1,a-=un(e)):d=e;const{month:u,day:o}=Zu(d,a);return{year:d,month:u,day:o,...Mi(t)}}function Qi(t){const{year:e,month:r,day:n}=t,i=$u(e,r,n);return{year:e,ordinal:i,...Mi(t)}}function Co(t){const{year:e,ordinal:r}=t,{month:n,day:i}=Zu(e,r);return{year:e,month:n,day:i,...Mi(t)}}function rp(t){const e=Oi(t.weekYear),r=Mt(t.weekNumber,1,ui(t.weekYear)),n=Mt(t.weekday,1,7);return e?r?n?!1:dt("weekday",t.weekday):dt("week",t.week):dt("weekYear",t.weekYear)}function np(t){const e=Oi(t.year),r=Mt(t.ordinal,1,un(t.year));return e?r?!1:dt("ordinal",t.ordinal):dt("year",t.year)}function Xu(t){const e=Oi(t.year),r=Mt(t.month,1,12),n=Mt(t.day,1,li(t.year,t.month));return e?r?n?!1:dt("day",t.day):dt("month",t.month):dt("year",t.year)}function Qu(t){const{hour:e,minute:r,second:n,millisecond:i}=t,s=Mt(e,0,23)||e===24&&r===0&&n===0&&i===0,a=Mt(r,0,59),d=Mt(n,0,59),u=Mt(i,0,999);return s?a?d?u?!1:dt("millisecond",i):dt("second",n):dt("minute",r):dt("hour",e)}const Ji="Invalid DateTime",Oo=864e13;function Un(t){return new Tt("unsupported zone",`the zone "${t.name}" is not supported`)}function es(t){return t.weekData===null&&(t.weekData=Rs(t.c)),t.weekData}function dr(t,e){const r={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new me({...r,...e,old:r})}function Ju(t,e,r){let n=t-e*60*1e3;const i=r.offset(n);if(e===i)return[n,e];n-=(i-e)*60*1e3;const s=r.offset(n);return i===s?[n,i]:[t-Math.min(i,s)*60*1e3,Math.max(i,s)]}function Bn(t,e){t+=e*60*1e3;const r=new Date(t);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function $n(t,e,r){return Ju(xi(t),e,r)}function xo(t,e){const r=t.o,n=t.c.year+Math.trunc(e.years),i=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...t.c,year:n,month:i,day:Math.min(t.c.day,li(n,i))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},a=Se.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),d=xi(s);let[u,o]=Ju(d,r,t.zone);return a!==0&&(u+=a,o=t.zone.offset(u)),{ts:u,o}}function Xr(t,e,r,n,i,s){const{setZone:a,zone:d}=r;if(t&&Object.keys(t).length!==0||e){const u=e||d,o=me.fromObject(t,{...r,zone:u,specificOffset:s});return a?o:o.setZone(d)}else return me.invalid(new Tt("unparsable",`the input "${i}" can't be parsed as ${n}`))}function Gn(t,e,r=!0){return t.isValid?Ye.create(Re.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(t,e):null}function ts(t,e){const r=t.c.year>9999||t.c.year<0;let n="";return r&&t.c.year>=0&&(n+="+"),n+=Ue(t.c.year,r?6:4),e?(n+="-",n+=Ue(t.c.month),n+="-",n+=Ue(t.c.day)):(n+=Ue(t.c.month),n+=Ue(t.c.day)),n}function Po(t,e,r,n,i,s){let a=Ue(t.c.hour);return e?(a+=":",a+=Ue(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!r)&&(a+=":")):a+=Ue(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!r)&&(a+=Ue(t.c.second),(t.c.millisecond!==0||!n)&&(a+=".",a+=Ue(t.c.millisecond,3))),i&&(t.isOffsetFixed&&t.offset===0&&!s?a+="Z":t.o<0?(a+="-",a+=Ue(Math.trunc(-t.o/60)),a+=":",a+=Ue(Math.trunc(-t.o%60))):(a+="+",a+=Ue(Math.trunc(t.o/60)),a+=":",a+=Ue(Math.trunc(t.o%60)))),s&&(a+="["+t.zone.ianaName+"]"),a}const ec={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},ip={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},sp={ordinal:1,hour:0,minute:0,second:0,millisecond:0},tc=["year","month","day","hour","minute","second","millisecond"],ap=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],op=["year","ordinal","hour","minute","second","millisecond"];function Mo(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new nu(t);return e}function Fo(t,e){const r=Xt(e.zone,Ne.defaultZone),n=Re.fromObject(e),i=Ne.now();let s,a;if(Te(t.year))s=i;else{for(const o of tc)Te(t[o])&&(t[o]=ec[o]);const d=Xu(t)||Qu(t);if(d)return me.invalid(d);const u=r.offset(i);[s,a]=$n(t,u,r)}return new me({ts:s,zone:r,loc:n,o:a})}function No(t,e,r){const n=Te(r.round)?!0:r.round,i=(a,d)=>(a=na(a,n||r.calendary?0:2,!0),e.loc.clone(r).relFormatter(r).format(a,d)),s=a=>r.calendary?e.hasSame(t,a)?0:e.startOf(a).diff(t.startOf(a),a).get(a):e.diff(t,a).get(a);if(r.unit)return i(s(r.unit),r.unit);for(const a of r.units){const d=s(a);if(Math.abs(d)>=1)return i(d,a)}return i(t>e?-0:0,r.units[r.units.length-1])}function Uo(t){let e={},r;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],r=Array.from(t).slice(0,t.length-1)):r=Array.from(t),[e,r]}class me{constructor(e){const r=e.zone||Ne.defaultZone;let n=e.invalid||(Number.isNaN(e.ts)?new Tt("invalid input"):null)||(r.isValid?null:Un(r));this.ts=Te(e.ts)?Ne.now():e.ts;let i=null,s=null;if(!n)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(r))[i,s]=[e.old.c,e.old.o];else{const d=r.offset(this.ts);i=Bn(this.ts,d),n=Number.isNaN(i.year)?new Tt("invalid input"):null,i=n?null:i,s=n?null:d}this._zone=r,this.loc=e.loc||Re.create(),this.invalid=n,this.weekData=null,this.c=i,this.o=s,this.isLuxonDateTime=!0}static now(){return new me({})}static local(){const[e,r]=Uo(arguments),[n,i,s,a,d,u,o]=r;return Fo({year:n,month:i,day:s,hour:a,minute:d,second:u,millisecond:o},e)}static utc(){const[e,r]=Uo(arguments),[n,i,s,a,d,u,o]=r;return e.zone=Xe.utcInstance,Fo({year:n,month:i,day:s,hour:a,minute:d,second:u,millisecond:o},e)}static fromJSDate(e,r={}){const n=Mg(e)?e.valueOf():NaN;if(Number.isNaN(n))return me.invalid("invalid input");const i=Xt(r.zone,Ne.defaultZone);return i.isValid?new me({ts:n,zone:i,loc:Re.fromObject(r)}):me.invalid(Un(i))}static fromMillis(e,r={}){if(Sr(e))return e<-Oo||e>Oo?me.invalid("Timestamp out of range"):new me({ts:e,zone:Xt(r.zone,Ne.defaultZone),loc:Re.fromObject(r)});throw new ct(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,r={}){if(Sr(e))return new me({ts:e*1e3,zone:Xt(r.zone,Ne.defaultZone),loc:Re.fromObject(r)});throw new ct("fromSeconds requires a numerical input")}static fromObject(e,r={}){e=e||{};const n=Xt(r.zone,Ne.defaultZone);if(!n.isValid)return me.invalid(Un(n));const i=Ne.now(),s=Te(r.specificOffset)?n.offset(i):r.specificOffset,a=ci(e,Mo),d=!Te(a.ordinal),u=!Te(a.year),o=!Te(a.month)||!Te(a.day),y=u||o,m=a.weekYear||a.weekNumber,f=Re.fromObject(r);if((y||d)&&m)throw new rn("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(o&&d)throw new rn("Can't mix ordinal dates with month/day");const L=m||a.weekday&&!y;let _,E,l=Bn(i,s);L?(_=ap,E=ip,l=Rs(l)):d?(_=op,E=sp,l=Qi(l)):(_=tc,E=ec);let g=!1;for(const w of _){const k=a[w];Te(k)?g?a[w]=E[w]:a[w]=l[w]:g=!0}const c=L?rp(a):d?np(a):Xu(a),T=c||Qu(a);if(T)return me.invalid(T);const S=L?Io(a):d?Co(a):a,[p,A]=$n(S,s,n),D=new me({ts:p,zone:n,o:A,loc:f});return a.weekday&&y&&e.weekday!==D.weekday?me.invalid("mismatched weekday",`you can't specify both a weekday of ${a.weekday} and a date of ${D.toISO()}`):D}static fromISO(e,r={}){const[n,i]=Lm(e);return Xr(n,i,r,"ISO 8601",e)}static fromRFC2822(e,r={}){const[n,i]=wm(e);return Xr(n,i,r,"RFC 2822",e)}static fromHTTP(e,r={}){const[n,i]=_m(e);return Xr(n,i,r,"HTTP",r)}static fromFormat(e,r,n={}){if(Te(e)||Te(r))throw new ct("fromFormat requires an input string and a format");const{locale:i=null,numberingSystem:s=null}=n,a=Re.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0}),[d,u,o,y]=tp(a,e,r);return y?me.invalid(y):Xr(d,u,n,`format ${r}`,e,o)}static fromString(e,r,n={}){return me.fromFormat(e,r,n)}static fromSQL(e,r={}){const[n,i]=xm(e);return Xr(n,i,r,"SQL",e)}static invalid(e,r=null){if(!e)throw new ct("need to specify a reason the DateTime is invalid");const n=e instanceof Tt?e:new Tt(e,r);if(Ne.throwOnInvalid)throw new fg(n);return new me({invalid:n})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,r={}){const n=Wu(e,Re.fromObject(r));return n?n.map(i=>i?i.val:null).join(""):null}static expandFormat(e,r={}){return Hu(Ye.parseFormat(e),Re.fromObject(r)).map(i=>i.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?es(this).weekYear:NaN}get weekNumber(){return this.isValid?es(this).weekNumber:NaN}get weekday(){return this.isValid?es(this).weekday:NaN}get ordinal(){return this.isValid?Qi(this.c).ordinal:NaN}get monthShort(){return this.isValid?Fn.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Fn.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Fn.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Fn.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,r=6e4,n=xi(this.c),i=this.zone.offset(n-e),s=this.zone.offset(n+e),a=this.zone.offset(n-i*r),d=this.zone.offset(n-s*r);if(a===d)return[this];const u=n-a*r,o=n-d*r,y=Bn(u,a),m=Bn(o,d);return y.hour===m.hour&&y.minute===m.minute&&y.second===m.second&&y.millisecond===m.millisecond?[dr(this,{ts:u}),dr(this,{ts:o})]:[this]}get isInLeapYear(){return wn(this.year)}get daysInMonth(){return li(this.year,this.month)}get daysInYear(){return this.isValid?un(this.year):NaN}get weeksInWeekYear(){return this.isValid?ui(this.weekYear):NaN}resolvedLocaleOptions(e={}){const{locale:r,numberingSystem:n,calendar:i}=Ye.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:r,numberingSystem:n,outputCalendar:i}}toUTC(e=0,r={}){return this.setZone(Xe.instance(e),r)}toLocal(){return this.setZone(Ne.defaultZone)}setZone(e,{keepLocalTime:r=!1,keepCalendarTime:n=!1}={}){if(e=Xt(e,Ne.defaultZone),e.equals(this.zone))return this;if(e.isValid){let i=this.ts;if(r||n){const s=e.offset(this.ts),a=this.toObject();[i]=$n(a,s,e)}return dr(this,{ts:i,zone:e})}else return me.invalid(Un(e))}reconfigure({locale:e,numberingSystem:r,outputCalendar:n}={}){const i=this.loc.clone({locale:e,numberingSystem:r,outputCalendar:n});return dr(this,{loc:i})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const r=ci(e,Mo),n=!Te(r.weekYear)||!Te(r.weekNumber)||!Te(r.weekday),i=!Te(r.ordinal),s=!Te(r.year),a=!Te(r.month)||!Te(r.day),d=s||a,u=r.weekYear||r.weekNumber;if((d||i)&&u)throw new rn("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(a&&i)throw new rn("Can't mix ordinal dates with month/day");let o;n?o=Io({...Rs(this.c),...r}):Te(r.ordinal)?(o={...this.toObject(),...r},Te(r.day)&&(o.day=Math.min(li(o.year,o.month),o.day))):o=Co({...Qi(this.c),...r});const[y,m]=$n(o,this.o,this.zone);return dr(this,{ts:y,o:m})}plus(e){if(!this.isValid)return this;const r=Se.fromDurationLike(e);return dr(this,xo(this,r))}minus(e){if(!this.isValid)return this;const r=Se.fromDurationLike(e).negate();return dr(this,xo(this,r))}startOf(e){if(!this.isValid)return this;const r={},n=Se.normalizeUnit(e);switch(n){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(n==="weeks"&&(r.weekday=1),n==="quarters"){const i=Math.ceil(this.month/3);r.month=(i-1)*3+1}return this.set(r)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,r={}){return this.isValid?Ye.create(this.loc.redefaultToEN(r)).formatDateTimeFromString(this,e):Ji}toLocaleString(e=oi,r={}){return this.isValid?Ye.create(this.loc.clone(r),e).formatDateTime(this):Ji}toLocaleParts(e={}){return this.isValid?Ye.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:r=!1,suppressMilliseconds:n=!1,includeOffset:i=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const a=e==="extended";let d=ts(this,a);return d+="T",d+=Po(this,a,r,n,i,s),d}toISODate({format:e="extended"}={}){return this.isValid?ts(this,e==="extended"):null}toISOWeekDate(){return Gn(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:r=!1,includeOffset:n=!0,includePrefix:i=!1,extendedZone:s=!1,format:a="extended"}={}){return this.isValid?(i?"T":"")+Po(this,a==="extended",r,e,n,s):null}toRFC2822(){return Gn(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Gn(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?ts(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:r=!1,includeOffsetSpace:n=!0}={}){let i="HH:mm:ss.SSS";return(r||e)&&(n&&(i+=" "),r?i+="z":e&&(i+="ZZ")),Gn(this,i,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():Ji}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const r={...this.c};return e.includeConfig&&(r.outputCalendar=this.outputCalendar,r.numberingSystem=this.loc.numberingSystem,r.locale=this.loc.locale),r}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,r="milliseconds",n={}){if(!this.isValid||!e.isValid)return Se.invalid("created by diffing an invalid DateTime");const i={locale:this.locale,numberingSystem:this.numberingSystem,...n},s=Fg(r).map(Se.normalizeUnit),a=e.valueOf()>this.valueOf(),d=a?this:e,u=a?e:this,o=Gm(d,u,s,i);return a?o.negate():o}diffNow(e="milliseconds",r={}){return this.diff(me.now(),e,r)}until(e){return this.isValid?Oe.fromDateTimes(this,e):this}hasSame(e,r){if(!this.isValid)return!1;const n=e.valueOf(),i=this.setZone(e.zone,{keepLocalTime:!0});return i.startOf(r)<=n&&n<=i.endOf(r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const r=e.base||me.fromObject({},{zone:this.zone}),n=e.padding?this<r?-e.padding:e.padding:0;let i=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(i=e.unit,s=void 0),No(r,this.plus(n),{...e,numeric:"always",units:i,unit:s})}toRelativeCalendar(e={}){return this.isValid?No(e.base||me.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(me.isDateTime))throw new ct("min requires all arguments be DateTimes");return So(e,r=>r.valueOf(),Math.min)}static max(...e){if(!e.every(me.isDateTime))throw new ct("max requires all arguments be DateTimes");return So(e,r=>r.valueOf(),Math.max)}static fromFormatExplain(e,r,n={}){const{locale:i=null,numberingSystem:s=null}=n,a=Re.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return Ku(a,e,r)}static fromStringExplain(e,r,n={}){return me.fromFormatExplain(e,r,n)}static get DATE_SHORT(){return oi}static get DATE_MED(){return iu}static get DATE_MED_WITH_WEEKDAY(){return mg}static get DATE_FULL(){return su}static get DATE_HUGE(){return au}static get TIME_SIMPLE(){return ou}static get TIME_WITH_SECONDS(){return lu}static get TIME_WITH_SHORT_OFFSET(){return uu}static get TIME_WITH_LONG_OFFSET(){return cu}static get TIME_24_SIMPLE(){return du}static get TIME_24_WITH_SECONDS(){return fu}static get TIME_24_WITH_SHORT_OFFSET(){return hu}static get TIME_24_WITH_LONG_OFFSET(){return gu}static get DATETIME_SHORT(){return mu}static get DATETIME_SHORT_WITH_SECONDS(){return pu}static get DATETIME_MED(){return vu}static get DATETIME_MED_WITH_SECONDS(){return yu}static get DATETIME_MED_WITH_WEEKDAY(){return pg}static get DATETIME_FULL(){return Eu}static get DATETIME_FULL_WITH_SECONDS(){return Tu}static get DATETIME_HUGE(){return Su}static get DATETIME_HUGE_WITH_SECONDS(){return bu}}function Qr(t){if(me.isDateTime(t))return t;if(t&&t.valueOf&&Sr(t.valueOf()))return me.fromJSDate(t);if(t&&typeof t=="object")return me.fromObject(t);throw new ct(`Unknown datetime argument: ${t}, of type ${typeof t}`)}function lp(t){return{total:t.total,pageSize:t.limit,curPage:t.offset/t.limit+1}}function up(t){return me.fromISO(t).toFormat("yyyy-MM-dd")}const cp={class:"my-pagination"},dp={key:0},fp=["onClick"],hp={key:1},gp=at({__name:"PagePlugin",props:{total:{},pageSize:{default:24},currentPage:{default:1}},emits:["pageChanged"],setup(t,{emit:e}){const r=t,n=Ke(r.currentPage),i=Ce(()=>Math.ceil(r.total/r.pageSize)),s=Ce(()=>{const d=[];if(i.value<=5)for(let u=1;u<=i.value;u++)d.push(u);else if(n.value<=2)for(let u=1;u<=5;u++)d.push(u);else if(n.value>=3&&n.value<=i.value-2)for(let u=n.value-2;u<=n.value+2;u++)d.push(u);else if(n.value>i.value-2)for(let u=i.value-4;u<=i.value;u++)d.push(u);return d}),a=d=>{console.log("changePage ->",d),!(d<1||d>i.value)&&(n.value=d,e("pageChanged",n.value),console.log("emit changePaged ->",d))};return(d,u)=>(he(),ge("div",cp,[Q("a",{rel:"nofollow",href:"javascript:;",class:Je({disabled:n.value===1}),onClick:u[0]||(u[0]=o=>a(n.value-1))},"  ",2),n.value>3?(he(),ge("span",dp,"...")):Pe("",!0),(he(!0),ge(Be,null,br(s.value,o=>(he(),ge("a",{href:"javascript:;",key:o,class:Je({active:n.value===o}),onClick:y=>a(o)},Ae(o),11,fp))),128)),n.value<i.value-2?(he(),ge("span",hp,"...")):Pe("",!0),Q("a",{rel:"nofollow",href:"javascript:;",class:Je({disabled:n.value===i.value}),onClick:u[1]||(u[1]=o=>a(n.value+1))},"",2)]))}});const mp=Ii(gp,[["__scopeId","data-v-55bf8acf"]]),pp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEoAAABDCAYAAAA735O5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QThEQzhBMzNEMzhFMTFFNzkyRkJCNUM4ODA0OTM2QUQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QThEQzhBMzREMzhFMTFFNzkyRkJCNUM4ODA0OTM2QUQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBOERDOEEzMUQzOEUxMUU3OTJGQkI1Qzg4MDQ5MzZBRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOERDOEEzMkQzOEUxMUU3OTJGQkI1Qzg4MDQ5MzZBRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PldGaIYAAALZSURBVHja7Nyxi9NQHAfwVzmKSHto06Xi0MG2S5TrmBNsly7XdCkiLv4Bp7tOborg7p8g9weYc+jUwmGmUqHZziEFaZYmgg0iWep7RUEOal9yyXvv1/v9tqPl3ssn7/3yvVza3Gq1IklqPB4/8TzvxPd9EkURkVWlUok0Go2uruufeN5vWdZ7Ou9nccaoVCpkL+7EKMw+HewjxdknClQQBMS27Tf0xL00TbOnadqPLMa5lhDpIf3xgKhTB2xObG5sjtKh6Jl7+wdJyWJzGwwGH6RCua6r0719SBSvMAzvsLlKg3Ic51ix7bZxG9LtJw8Kwmr6p5fekwI1HA5fEEBFe9VNKVCz2awLZNtlVluhaG86UiUzKQ01nU6Pr/pq2grFLrPsckuw/g8FKBLIhYIUCaRBQYsE0qAwEnBAYSTghMJIwAGFkYATCiMBJxRGAg4ojAScUBgJOKAwEnBCYSTggMJIwAmFkYATCiMBBxRr4siwvfaWy+UpMnCsKPY0ClbCuwdYCIVQCIVQCLWbUOxBTiwOqGKxaCIDRzKv1+untm3/iqLo+hU67i8x3/95/fi0YRiPRqORtSsKhUJhtuk10zSfJ27mbFXpuv56V6DK5bKT2VWPrqpXnU7nkJ6Nb9C3Fb1AnaX9S3ObPuLhed7dLI7CsqzzLJFqtdpJu91+l3oz3/QCPStf0x4sK/y/SJqmOVkgCQ+cvu8/yBKp3+8/3YlkvlgsDIhIMlaUARFpDTWZTG6JggqC4D5EpDVUs9n8LmKglBu5UCShWy/FRi4cSSjUfD7vQkWCtqKkIQmFCsPwNlQkYVCXbOTSkYRB0f7Ug4wkDCph0FQGSeTW60FGEgYV8zazckhCoGI2ciWRhEDl8/kAOpIQKHrwAcftZaWRhPUowzAeQ0YSBlWtVu1Wq2VCRRL6Jwz7l9gFLDBIQqEuYIFCYpVL+o1klynXdW/Q7fiTAKrfAgwAPG1s3StAvD0AAAAASUVORK5CYII=",vp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEoAAABDCAYAAAA735O5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Qjg1MTg1RDREMzhFMTFFN0EzMURBREExMTU1MjY0MUMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Qjg1MTg1RDVEMzhFMTFFN0EzMURBREExMTU1MjY0MUMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCODUxODVEMkQzOEUxMUU3QTMxREFEQTExNTUyNjQxQyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCODUxODVEM0QzOEUxMUU3QTMxREFEQTExNTUyNjQxQyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pnv1b0MAAAK+SURBVHja7Nqxi9NwFAfwXChBpRWu6dIiNMPRKYUrnSKCnTpoXF0cuut+ILg56S73B7iISBdTlyztwTVjy5mlxaGD2KWtci0iWervSQMud3nN5Zc2v7zvdByX3I9P3u/93qV3sF6vpSRlMpnc0TTtd9y/V04SUrvdfm/b9vl4PH5MUNcgzedznX153Ov1rLix5KQh+d+LG0tOItL/WKxnGamHug7Jj+M4H1MNhUGCrFare+zn8qmEwiL58TwvfVDbIkGKxeK3VEGFQVIU5U+qelQYpE01fU4NVFgkiKqqTiqgboIEKZVK4lfUTZHiauQ7hYoCKZvN/hD6T5gokDb96VxYqKiQNv2pIyRUlEjCVlTUSHE28sFgcCgnFSmfz1/E9ZBrtdpPOYlIcQ6asWw9XkiQQqEgBhRPpLgbOSTD46bdbveEJ5Kf6XR6FPU9rzogDqL+XI8B3WXV1OONxDNs4v9uGMZTTdMcbluPPeUHSUaCwOtl27b7juO85gY1m810SZC4rvvK/0gsY1nWO1YF97fcx33TNF9c8TTKkkBhVfWpUqnchmb+PMT1fSkl8TzvFlSVLFECs1wuLYLCHVASQe3b2wOCIigKQREUQe00qqoSFCLDXC5Hkzkmuq5/ISjECwDqUYhtx6rplKACAm86NU1zCSqgmqrV6imNBwFRFOUSmjhBBVRTuVzu0MCJSKPReEtQyJGAoJAjAUEhRwKCQo4EBIUcCQgKORIQFHIkICjkSEBQyJGAoJAjAUEhRwKCQo4EBIUcCbhCsSf0S5SRgCuUqqpfRRkJeEPB6TEUYSTgCgXHLBy3SaimoJGAezNvNpvPWK862+OT7swwjJfbXMMFim2/S9M0n2yw9mkbDmFNsDZY4zYXZnitCBbSarUeuq77aDQadRaLxS4r6N8/WrDt9qZer38Ic4+/AgwAEHBOqZ50vZcAAAAASUVORK5CYII=",la=t=>(rr("data-v-6f93e6f2"),t=t(),nr(),t),yp={class:"top-info"},Ep={class:"info"},Tp={key:0},Sp={class:"search"},bp=la(()=>Q("option",{value:"-addedAt"},"",-1)),Ap=la(()=>Q("option",{value:"-popularity"},"",-1)),Lp=la(()=>Q("option",{value:"-createdAt"},"",-1)),wp=[bp,Ap,Lp],_p={class:"container"},kp={class:"thumb"},Dp=["src"],Rp={key:0,class:"hd"},Ip={class:"duration"},Cp={class:"title"},Op={class:"info"},xp={class:"info"},Pp={class:"info"},Mp={class:"info"},Fp=["src"],Np=["src"],Bo="http://localhost",Up=at({__name:"ListView",props:{category:{default:""}},setup(t){const e=t,r=Ct({category:e.category,videoTitle:"",sortBy:"-addedAt",orderByDesc:Ce(()=>r.sortBy=="-popularity"?"":""),offset:0,limit:24}),n=Ke(null);Ad(()=>{const a=`tag=${e.category}&title=${r.videoTitle}&sort_by=${r.sortBy}&limit=${r.limit}&offset=${r.offset}`,d=`${Bo}/api/v1/videos?${a}`;console.log(`fetch req => ${d}`),fetch(d).then(u=>u.json()).then(u=>{console.log(`${d} resp => `,u),n.value=u})});const i=Ce(()=>{if(n.value)return lp(n.value.meta)}),s=a=>{console.log("onPageChanged -> ",a),r.offset=r.limit*(a-1)};return(a,d)=>{var o,y,m,f;const u=wl("RouterLink");return he(),ge("div",null,[Q("div",yp,[Q("div",Ep,[We(Ae(a.category)+" "+Ae(r.orderByDesc)+" ",1),n.value?(he(),ge("span",Tp,Ae(((o=n.value)==null?void 0:o.meta.offset)+1)+" - "+Ae(((y=n.value)==null?void 0:y.meta.offset)+((m=n.value)==null?void 0:m.meta.limit)),1)):Pe("",!0)]),Q("div",Sp,[We(" SortBy: "),Ze(Q("select",{"onUpdate:modelValue":d[0]||(d[0]=L=>r.sortBy=L)},wp,512),[[Hf,r.sortBy]]),We(" Title: "),Ze(Q("input",{"onUpdate:modelValue":d[1]||(d[1]=L=>r.videoTitle=L)},null,512),[[jf,r.videoTitle]])])]),(he(!0),ge(Be,null,br((f=n.value)==null?void 0:f.data,L=>(he(),ge("div",{key:L.ViewKey,class:"videoItem"},[Q("div",_p,[pe(u,{to:`/videos/${L.ViewKey}`},{default:Fr(()=>[Q("div",kp,[Q("img",{src:`${Bo}/api/v1/videos/${L.ViewKey}/pic`,alt:""},null,8,Dp),L.IsHd==1?(he(),ge("div",Rp,"HD")):Pe("",!0),Q("span",Ip,Ae(L.Duration),1)]),Q("span",Cp,Ae(L.Title),1)]),_:2},1032,["to"]),Q("div",Op,": "+Ae(J(up)(L.CreatedAt)),1),Q("div",xp,": "+Ae(L.Popularity),1),Q("div",Pp,": "+Ae(L.Favorites),1),Q("div",Mp,[Q("img",{src:J(pp),alt:"like"},null,8,Fp),We(" "+Ae(L.Like)+" ",1),Q("img",{src:J(vp),alt:"dislike"},null,8,Np),We(" "+Ae(L.Unlike),1)])])]))),128)),i.value?(he(),$s(mp,{key:0,total:i.value.total,"page-size":i.value.pageSize,"current-page":i.value.curPage,onPageChanged:s},null,8,["total","page-size","current-page"])):Pe("",!0)])}}});const Bp=Ii(Up,[["__scopeId","data-v-6f93e6f2"]]);var Gp=Object.defineProperty,Vp=Object.defineProperties,jp=Object.getOwnPropertyDescriptors,Go=Object.getOwnPropertySymbols,Hp=Object.prototype.hasOwnProperty,Kp=Object.prototype.propertyIsEnumerable,Vo=(t,e,r)=>e in t?Gp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Is=(t,e)=>{for(var r in e||(e={}))Hp.call(e,r)&&Vo(t,r,e[r]);if(Go)for(var r of Go(e))Kp.call(e,r)&&Vo(t,r,e[r]);return t},Cs=(t,e)=>Vp(t,jp(e));function jo(t,e,r,n){var i,s=!1,a=0;function d(){i&&clearTimeout(i)}function u(){for(var o=arguments.length,y=new Array(o),m=0;m<o;m++)y[m]=arguments[m];var f=this,L=Date.now()-a;function _(){a=Date.now(),r.apply(f,y)}function E(){i=void 0}s||(n&&!i&&_(),d(),n===void 0&&L>t?_():e!==!0&&(i=setTimeout(n?E:_,n===void 0?t-L:t)))}return typeof e!="boolean"&&(n=r,r=e,e=void 0),u.cancel=function(){d(),s=!0},u}function Ho(t,e,r){return r===void 0?jo(t,e,!1):jo(t,r,e!==!1)}function Wp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rc={exports:{}};typeof window<"u"&&(rc.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(n,i,s){r.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:s})},r.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,i){if(1&i&&(n=r(n)),8&i||4&i&&typeof n=="object"&&n&&n.__esModule)return n;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:n}),2&i&&typeof n!="string")for(var a in n)r.d(s,a,(function(d){return n[d]}).bind(null,a));return s},r.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(i,"a",i),i},r.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(t,e,r){var n=Object.prototype.hasOwnProperty,i="~";function s(){}function a(y,m,f){this.fn=y,this.context=m,this.once=f||!1}function d(y,m,f,L,_){if(typeof f!="function")throw new TypeError("The listener must be a function");var E=new a(f,L||y,_),l=i?i+m:m;return y._events[l]?y._events[l].fn?y._events[l]=[y._events[l],E]:y._events[l].push(E):(y._events[l]=E,y._eventsCount++),y}function u(y,m){--y._eventsCount==0?y._events=new s:delete y._events[m]}function o(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(i=!1)),o.prototype.eventNames=function(){var y,m,f=[];if(this._eventsCount===0)return f;for(m in y=this._events)n.call(y,m)&&f.push(i?m.slice(1):m);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(y)):f},o.prototype.listeners=function(y){var m=i?i+y:y,f=this._events[m];if(!f)return[];if(f.fn)return[f.fn];for(var L=0,_=f.length,E=new Array(_);L<_;L++)E[L]=f[L].fn;return E},o.prototype.listenerCount=function(y){var m=i?i+y:y,f=this._events[m];return f?f.fn?1:f.length:0},o.prototype.emit=function(y,m,f,L,_,E){var l=i?i+y:y;if(!this._events[l])return!1;var g,c,T=this._events[l],S=arguments.length;if(T.fn){switch(T.once&&this.removeListener(y,T.fn,void 0,!0),S){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,m),!0;case 3:return T.fn.call(T.context,m,f),!0;case 4:return T.fn.call(T.context,m,f,L),!0;case 5:return T.fn.call(T.context,m,f,L,_),!0;case 6:return T.fn.call(T.context,m,f,L,_,E),!0}for(c=1,g=new Array(S-1);c<S;c++)g[c-1]=arguments[c];T.fn.apply(T.context,g)}else{var p,A=T.length;for(c=0;c<A;c++)switch(T[c].once&&this.removeListener(y,T[c].fn,void 0,!0),S){case 1:T[c].fn.call(T[c].context);break;case 2:T[c].fn.call(T[c].context,m);break;case 3:T[c].fn.call(T[c].context,m,f);break;case 4:T[c].fn.call(T[c].context,m,f,L);break;default:if(!g)for(p=1,g=new Array(S-1);p<S;p++)g[p-1]=arguments[p];T[c].fn.apply(T[c].context,g)}}return!0},o.prototype.on=function(y,m,f){return d(this,y,m,f,!1)},o.prototype.once=function(y,m,f){return d(this,y,m,f,!0)},o.prototype.removeListener=function(y,m,f,L){var _=i?i+y:y;if(!this._events[_])return this;if(!m)return u(this,_),this;var E=this._events[_];if(E.fn)E.fn!==m||L&&!E.once||f&&E.context!==f||u(this,_);else{for(var l=0,g=[],c=E.length;l<c;l++)(E[l].fn!==m||L&&!E[l].once||f&&E[l].context!==f)&&g.push(E[l]);g.length?this._events[_]=g.length===1?g[0]:g:u(this,_)}return this},o.prototype.removeAllListeners=function(y){var m;return y?(m=i?i+y:y,this._events[m]&&u(this,m)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o},"./node_modules/url-toolkit/src/url-toolkit.js":function(t,e,r){var n,i,s,a,d;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,i=/^([^\/?#]*)([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,d={buildAbsoluteURL:function(u,o,y){if(y=y||{},u=u.trim(),!(o=o.trim())){if(!y.alwaysNormalize)return u;var m=d.parseURL(u);if(!m)throw new Error("Error trying to parse base URL.");return m.path=d.normalizePath(m.path),d.buildURLFromParts(m)}var f=d.parseURL(o);if(!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return y.alwaysNormalize?(f.path=d.normalizePath(f.path),d.buildURLFromParts(f)):o;var L=d.parseURL(u);if(!L)throw new Error("Error trying to parse base URL.");if(!L.netLoc&&L.path&&L.path[0]!=="/"){var _=i.exec(L.path);L.netLoc=_[1],L.path=_[2]}L.netLoc&&!L.path&&(L.path="/");var E={scheme:L.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment};if(!f.netLoc&&(E.netLoc=L.netLoc,f.path[0]!=="/"))if(f.path){var l=L.path,g=l.substring(0,l.lastIndexOf("/")+1)+f.path;E.path=d.normalizePath(g)}else E.path=L.path,f.params||(E.params=L.params,f.query||(E.query=L.query));return E.path===null&&(E.path=y.alwaysNormalize?d.normalizePath(f.path):f.path),d.buildURLFromParts(E)},parseURL:function(u){var o=n.exec(u);return o?{scheme:o[1]||"",netLoc:o[2]||"",path:o[3]||"",params:o[4]||"",query:o[5]||"",fragment:o[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(s,"");u.length!==(u=u.replace(a,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}},t.exports=d},"./node_modules/webworkify-webpack/index.js":function(t,e,r){function n(o){var y={};function m(L){if(y[L])return y[L].exports;var _=y[L]={i:L,l:!1,exports:{}};return o[L].call(_.exports,_,_.exports,m),_.l=!0,_.exports}m.m=o,m.c=y,m.i=function(L){return L},m.d=function(L,_,E){m.o(L,_)||Object.defineProperty(L,_,{configurable:!1,enumerable:!0,get:E})},m.r=function(L){Object.defineProperty(L,"__esModule",{value:!0})},m.n=function(L){var _=L&&L.__esModule?function(){return L.default}:function(){return L};return m.d(_,"a",_),_},m.o=function(L,_){return Object.prototype.hasOwnProperty.call(L,_)},m.p="/",m.oe=function(L){throw console.error(L),L};var f=m(m.s=ENTRY_MODULE);return f.default||f}var i="[\\.|\\-|\\+|\\w|/|@]+",s="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function a(o){return(o+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function d(o,y,m){var f={};f[m]=[];var L=y.toString(),_=L.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!_)return f;for(var E,l=_[1],g=new RegExp("(\\\\n|\\W)"+a(l)+s,"g");E=g.exec(L);)E[3]!=="dll-reference"&&f[m].push(E[3]);for(g=new RegExp("\\("+a(l)+'\\("(dll-reference\\s('+i+'))"\\)\\)'+s,"g");E=g.exec(L);)o[E[2]]||(f[m].push(E[1]),o[E[2]]=r(E[1]).m),f[E[2]]=f[E[2]]||[],f[E[2]].push(E[4]);for(var c,T=Object.keys(f),S=0;S<T.length;S++)for(var p=0;p<f[T[S]].length;p++)c=f[T[S]][p],isNaN(1*c)||(f[T[S]][p]=1*f[T[S]][p]);return f}function u(o){return Object.keys(o).reduce(function(y,m){return y||o[m].length>0},!1)}t.exports=function(o,y){y=y||{};var m={main:r.m},f=y.all?{main:Object.keys(m.main)}:function(g,c){for(var T={main:[c]},S={main:[]},p={main:{}};u(T);)for(var A=Object.keys(T),D=0;D<A.length;D++){var w=A[D],k=T[w].pop();if(p[w]=p[w]||{},!p[w][k]&&g[w][k]){p[w][k]=!0,S[w]=S[w]||[],S[w].push(k);for(var h=d(g,g[w][k],w),v=Object.keys(h),b=0;b<v.length;b++)T[v[b]]=T[v[b]]||[],T[v[b]]=T[v[b]].concat(h[v[b]])}}return S}(m,o),L="";Object.keys(f).filter(function(g){return g!=="main"}).forEach(function(g){for(var c=0;f[g][c];)c++;f[g].push(c),m[g][c]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",L=L+"var "+g+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(c))+")({"+f[g].map(function(T){return JSON.stringify(T)+": "+m[g][T].toString()}).join(",")+`});
`}),L=L+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(o))+")({"+f.main.map(function(g){return JSON.stringify(g)+": "+m.main[g].toString()}).join(",")+"}))(self);";var _=new window.Blob([L],{type:"text/javascript"});if(y.bare)return _;var E=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(_),l=new window.Worker(E);return l.objectURL=E,l}},"./src/config.ts":function(t,e,r){r.r(e),r.d(e,"hlsDefaultConfig",function(){return A}),r.d(e,"mergeConfig",function(){return D}),r.d(e,"enableStreamingMode",function(){return w});var n=r("./src/controller/abr-controller.ts"),i=r("./src/controller/audio-stream-controller.ts"),s=r("./src/controller/audio-track-controller.ts"),a=r("./src/controller/subtitle-stream-controller.ts"),d=r("./src/controller/subtitle-track-controller.ts"),u=r("./src/controller/buffer-controller.ts"),o=r("./src/controller/timeline-controller.ts"),y=r("./src/controller/cap-level-controller.ts"),m=r("./src/controller/fps-controller.ts"),f=r("./src/controller/eme-controller.ts"),L=r("./src/utils/xhr-loader.ts"),_=r("./src/utils/fetch-loader.ts"),E=r("./src/utils/cues.ts"),l=r("./src/utils/mediakeys-helper.ts"),g=r("./src/utils/logger.ts");function c(){return(c=Object.assign||function(k){for(var h=1;h<arguments.length;h++){var v=arguments[h];for(var b in v)Object.prototype.hasOwnProperty.call(v,b)&&(k[b]=v[b])}return k}).apply(this,arguments)}function T(k,h){var v=Object.keys(k);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(k);h&&(b=b.filter(function(R){return Object.getOwnPropertyDescriptor(k,R).enumerable})),v.push.apply(v,b)}return v}function S(k){for(var h=1;h<arguments.length;h++){var v=arguments[h]!=null?arguments[h]:{};h%2?T(Object(v),!0).forEach(function(b){p(k,b,v[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(k,Object.getOwnPropertyDescriptors(v)):T(Object(v)).forEach(function(b){Object.defineProperty(k,b,Object.getOwnPropertyDescriptor(v,b))})}return k}function p(k,h,v){return h in k?Object.defineProperty(k,h,{value:v,enumerable:!0,configurable:!0,writable:!0}):k[h]=v,k}var A=S(S({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:L.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:n.default,bufferController:u.default,capLevelController:y.default,fpsController:m.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:l.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0},{cueHandler:E.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:a.SubtitleStreamController,subtitleTrackController:d.default,timelineController:o.TimelineController,audioStreamController:i.default,audioTrackController:s.default,emeController:f.default});function D(k,h){if((h.liveSyncDurationCount||h.liveMaxLatencyDurationCount)&&(h.liveSyncDuration||h.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(h.liveMaxLatencyDurationCount!==void 0&&(h.liveSyncDurationCount===void 0||h.liveMaxLatencyDurationCount<=h.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(h.liveMaxLatencyDuration!==void 0&&(h.liveSyncDuration===void 0||h.liveMaxLatencyDuration<=h.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return c({},k,h)}function w(k){var h=k.loader;h!==_.default&&h!==L.default?(g.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),k.progressive=!1):Object(_.fetchSupported)()&&(k.loader=_.default,k.progressive=!0,k.enableSoftwareAES=!0,g.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}},"./src/controller/abr-controller.ts":function(t,e,r){r.r(e);var n=r("./src/polyfills/number.ts"),i=r("./src/utils/ewma-bandwidth-estimator.ts"),s=r("./src/events.ts"),a=r("./src/utils/buffer-helper.ts"),d=r("./src/errors.ts"),u=r("./src/types/loader.ts"),o=r("./src/utils/logger.ts");function y(f,L){for(var _=0;_<L.length;_++){var E=L[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}var m=function(){function f(l){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=l;var g=l.config;this.bwEstimator=new i.default(g.abrEwmaSlowVoD,g.abrEwmaFastVoD,g.abrEwmaDefaultEstimate),this.registerListeners()}var L,_,E=f.prototype;return E.registerListeners=function(){var l=this.hls;l.on(s.Events.FRAG_LOADING,this.onFragLoading,this),l.on(s.Events.FRAG_LOADED,this.onFragLoaded,this),l.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),l.on(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.on(s.Events.ERROR,this.onError,this)},E.unregisterListeners=function(){var l=this.hls;l.off(s.Events.FRAG_LOADING,this.onFragLoading,this),l.off(s.Events.FRAG_LOADED,this.onFragLoaded,this),l.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),l.off(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.off(s.Events.ERROR,this.onError,this)},E.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},E.onFragLoading=function(l,g){var c,T=g.frag;T.type===u.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=T,this.partCurrent=(c=g.part)!=null?c:null,this.timer=self.setInterval(this.onCheck,100)))},E.onLevelLoaded=function(l,g){var c=this.hls.config;g.details.live?this.bwEstimator.update(c.abrEwmaSlowLive,c.abrEwmaFastLive):this.bwEstimator.update(c.abrEwmaSlowVoD,c.abrEwmaFastVoD)},E._abandonRulesCheck=function(){var l=this.fragCurrent,g=this.partCurrent,c=this.hls,T=c.autoLevelEnabled,S=c.config,p=c.media;if(l&&p){var A=g?g.stats:l.stats,D=g?g.duration:l.duration;if(A.aborted)return o.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(T&&!p.paused&&p.playbackRate&&p.readyState){var w=performance.now()-A.loading.start,k=Math.abs(p.playbackRate);if(!(w<=500*D/k)){var h=c.levels,v=c.minAutoLevel,b=h[l.level],R=A.total||Math.max(A.loaded,Math.round(D*b.maxBitrate/8)),I=Math.max(1,A.bwEstimate?A.bwEstimate/8:1e3*A.loaded/w),C=(R-A.loaded)/I,x=p.currentTime,O=(a.BufferHelper.bufferInfo(p,x,S.maxBufferHole).end-x)/k;if(!(O>=2*D/k||C<=O)){var P,M=Number.POSITIVE_INFINITY;for(P=l.level-1;P>v&&!((M=D*h[P].maxBitrate/(6.4*I))<O);P--);if(!(M>=C)){var F=this.bwEstimator.getEstimate();o.logger.warn("Fragment "+l.sn+(g?" part "+g.index:"")+" of level "+l.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+P+`
      Current BW estimate: `+(Object(n.isFiniteNumber)(F)?(F/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+C.toFixed(3)+` s
      Estimated load time for the next fragment: `+M.toFixed(3)+` s
      Time to underbuffer: `+O.toFixed(3)+" s"),c.nextLoadLevel=P,this.bwEstimator.sample(w,A.loaded),this.clearTimer(),l.loader&&(this.fragCurrent=this.partCurrent=null,l.loader.abort()),c.trigger(s.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:l,part:g,stats:A})}}}}}},E.onFragLoaded=function(l,g){var c=g.frag,T=g.part;if(c.type===u.PlaylistLevelType.MAIN&&Object(n.isFiniteNumber)(c.sn)){var S=T?T.stats:c.stats,p=T?T.duration:c.duration;if(this.clearTimer(),this.lastLoadedFragLevel=c.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var A=this.hls.levels[c.level],D=(A.loaded?A.loaded.bytes:0)+S.loaded,w=(A.loaded?A.loaded.duration:0)+p;A.loaded={bytes:D,duration:w},A.realBitrate=Math.round(8*D/w)}if(c.bitrateTest){var k={stats:S,frag:c,part:T,id:c.type};this.onFragBuffered(s.Events.FRAG_BUFFERED,k),c.bitrateTest=!1}}},E.onFragBuffered=function(l,g){var c=g.frag,T=g.part,S=T?T.stats:c.stats;if(!S.aborted&&c.type===u.PlaylistLevelType.MAIN&&c.sn!=="initSegment"){var p=S.parsing.end-S.loading.start;this.bwEstimator.sample(p,S.loaded),S.bwEstimate=this.bwEstimator.getEstimate(),c.bitrateTest?this.bitrateTestDelay=p/1e3:this.bitrateTestDelay=0}},E.onError=function(l,g){switch(g.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},E.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},E.getNextABRAutoLevel=function(){var l=this.fragCurrent,g=this.partCurrent,c=this.hls,T=c.maxAutoLevel,S=c.config,p=c.minAutoLevel,A=c.media,D=g?g.duration:l?l.duration:0,w=A?A.currentTime:0,k=A&&A.playbackRate!==0?Math.abs(A.playbackRate):1,h=this.bwEstimator?this.bwEstimator.getEstimate():S.abrEwmaDefaultEstimate,v=(a.BufferHelper.bufferInfo(A,w,S.maxBufferHole).end-w)/k,b=this.findBestLevel(h,p,T,v,S.abrBandWidthFactor,S.abrBandWidthUpFactor);if(b>=0)return b;o.logger.trace((v?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var R=D?Math.min(D,S.maxStarvationDelay):S.maxStarvationDelay,I=S.abrBandWidthFactor,C=S.abrBandWidthUpFactor;if(!v){var x=this.bitrateTestDelay;x&&(R=(D?Math.min(D,S.maxLoadingDelay):S.maxLoadingDelay)-x,o.logger.trace("bitrate test took "+Math.round(1e3*x)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*R)+" ms"),I=C=1)}return b=this.findBestLevel(h,p,T,v+R,I,C),Math.max(b,0)},E.findBestLevel=function(l,g,c,T,S,p){for(var A,D=this.fragCurrent,w=this.partCurrent,k=this.lastLoadedFragLevel,h=this.hls.levels,v=h[k],b=!(v==null||(A=v.details)===null||A===void 0||!A.live),R=v==null?void 0:v.codecSet,I=w?w.duration:D?D.duration:0,C=c;C>=g;C--){var x=h[C];if(x&&(!R||x.codecSet===R)){var O=x.details,P=(w?O==null?void 0:O.partTarget:O==null?void 0:O.averagetargetduration)||I,M=void 0;M=C<=k?S*l:p*l;var F=h[C].maxBitrate,B=F*P/M;if(o.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+C+"/"+Math.round(M)+"/"+F+"/"+P+"/"+T+"/"+B),M>F&&(!B||b&&!this.bitrateTestDelay||B<T))return C}}return-1},L=f,(_=[{key:"nextAutoLevel",get:function(){var l=this._nextAutoLevel,g=this.bwEstimator;if(!(l===-1||g&&g.canEstimate()))return l;var c=this.getNextABRAutoLevel();return l!==-1&&(c=Math.min(l,c)),c},set:function(l){this._nextAutoLevel=l}}])&&y(L.prototype,_),f}();e.default=m},"./src/controller/audio-stream-controller.ts":function(t,e,r){r.r(e);var n=r("./src/polyfills/number.ts"),i=r("./src/controller/base-stream-controller.ts"),s=r("./src/events.ts"),a=r("./src/utils/buffer-helper.ts"),d=r("./src/controller/fragment-tracker.ts"),u=r("./src/types/level.ts"),o=r("./src/types/loader.ts"),y=r("./src/loader/fragment.ts"),m=r("./src/demux/chunk-cache.ts"),f=r("./src/demux/transmuxer-interface.ts"),L=r("./src/types/transmuxer.ts"),_=r("./src/controller/fragment-finders.ts"),E=r("./src/utils/discontinuities.ts"),l=r("./src/errors.ts"),g=r("./src/utils/logger.ts");function c(){return(c=Object.assign||function(p){for(var A=1;A<arguments.length;A++){var D=arguments[A];for(var w in D)Object.prototype.hasOwnProperty.call(D,w)&&(p[w]=D[w])}return p}).apply(this,arguments)}function T(p,A){return(T=Object.setPrototypeOf||function(D,w){return D.__proto__=w,D})(p,A)}var S=function(p){var A,D;function w(h,v){var b;return(b=p.call(this,h,v,"[audio-stream-controller]")||this).videoBuffer=null,b.videoTrackCC=-1,b.waitingVideoCC=-1,b.audioSwitch=!1,b.trackId=-1,b.waitingData=null,b.mainDetails=null,b.bufferFlushed=!1,b._registerListeners(),b}D=p,(A=w).prototype=Object.create(D.prototype),A.prototype.constructor=A,T(A,D);var k=w.prototype;return k.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},k._registerListeners=function(){var h=this.hls;h.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),h.on(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),h.on(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.on(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),h.on(s.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),h.on(s.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),h.on(s.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),h.on(s.Events.ERROR,this.onError,this),h.on(s.Events.BUFFER_RESET,this.onBufferReset,this),h.on(s.Events.BUFFER_CREATED,this.onBufferCreated,this),h.on(s.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),h.on(s.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),h.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this)},k._unregisterListeners=function(){var h=this.hls;h.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),h.off(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),h.off(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.off(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),h.off(s.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),h.off(s.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),h.off(s.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),h.off(s.Events.ERROR,this.onError,this),h.off(s.Events.BUFFER_RESET,this.onBufferReset,this),h.off(s.Events.BUFFER_CREATED,this.onBufferCreated,this),h.off(s.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),h.off(s.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),h.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this)},k.onInitPtsFound=function(h,v){var b=v.frag,R=v.id,I=v.initPTS;if(R==="main"){var C=b.cc;this.initPTS[b.cc]=I,this.log("InitPTS for cc: "+C+" found from main: "+I),this.videoTrackCC=C,this.state===i.State.WAITING_INIT_PTS&&this.tick()}},k.startLoad=function(h){if(!this.levels)return this.startPosition=h,void(this.state=i.State.STOPPED);var v=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,v>0&&h===-1?(this.log("Override startPosition with lastCurrentTime @"+v.toFixed(3)),this.state=i.State.IDLE):(this.loadedmetadata=!1,this.state=i.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=h,this.tick()},k.doTick=function(){switch(this.state){case i.State.IDLE:this.doTickIdle();break;case i.State.WAITING_TRACK:var h,v=this.levels,b=this.trackId,R=v==null||(h=v[b])===null||h===void 0?void 0:h.details;if(R){if(this.waitForCdnTuneIn(R))break;this.state=i.State.WAITING_INIT_PTS}break;case i.State.FRAG_LOADING_WAITING_RETRY:var I,C=performance.now(),x=this.retryDate;(!x||C>=x||(I=this.media)!==null&&I!==void 0&&I.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=i.State.IDLE);break;case i.State.WAITING_INIT_PTS:var O=this.waitingData;if(O){var P=O.frag,M=O.part,F=O.cache,B=O.complete;if(this.initPTS[P.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=i.State.FRAG_LOADING;var j={frag:P,part:M,payload:F.flush(),networkDetails:null};this._handleFragmentLoadProgress(j),B&&p.prototype._handleFragmentLoadComplete.call(this,j)}else if(this.videoTrackCC!==this.waitingVideoCC)g.logger.log("Waiting fragment cc ("+P.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var K=this.getLoadPosition(),z=a.BufferHelper.bufferInfo(this.mediaBuffer,K,this.config.maxBufferHole);Object(_.fragmentWithinToleranceTest)(z.end,this.config.maxFragLookUpTolerance,P)<0&&(g.logger.log("Waiting fragment cc ("+P.cc+") @ "+P.start+" cancelled because another fragment at "+z.end+" is needed"),this.clearWaitingFragment())}}else this.state=i.State.IDLE}this.onTickEnd()},k.clearWaitingFragment=function(){var h=this.waitingData;h&&(this.fragmentTracker.removeFragment(h.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=i.State.IDLE)},k.onTickEnd=function(){var h=this.media;if(h&&h.readyState){var v=(this.mediaBuffer?this.mediaBuffer:h).buffered;!this.loadedmetadata&&v.length&&(this.loadedmetadata=!0),this.lastCurrentTime=h.currentTime}},k.doTickIdle=function(){var h,v,b=this.hls,R=this.levels,I=this.media,C=this.trackId,x=b.config;if(R&&R[C]&&(I||!this.startFragRequested&&x.startFragPrefetch)){var O=R[C].details;if(!O||O.live&&this.levelLastLoaded!==C||this.waitForCdnTuneIn(O))this.state=i.State.WAITING_TRACK;else{this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,y.ElementaryStreamTypes.AUDIO,o.PlaylistLevelType.AUDIO));var P=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,o.PlaylistLevelType.AUDIO);if(P!==null){var M=P.len,F=this.getMaxBufferLength(),B=this.audioSwitch;if(!(M>=F)||B){if(!B&&this._streamEnded(P,O))return b.trigger(s.Events.BUFFER_EOS,{type:"audio"}),void(this.state=i.State.ENDED);var j=O.fragments[0].start,K=P.end;if(B){var z=this.getLoadPosition();K=z,O.PTSKnown&&z<j&&(P.end>j||P.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),I.currentTime=j+.05)}var re=this.getNextFragment(K,O);re?((h=re.decryptdata)===null||h===void 0?void 0:h.keyFormat)!=="identity"||(v=re.decryptdata)!==null&&v!==void 0&&v.key?this.loadFragment(re,O,K):this.loadKey(re,O):this.bufferFlushed=!0}}}}},k.getMaxBufferLength=function(){var h=p.prototype.getMaxBufferLength.call(this),v=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,o.PlaylistLevelType.MAIN);return v===null?h:Math.max(h,v.len)},k.onMediaDetaching=function(){this.videoBuffer=null,p.prototype.onMediaDetaching.call(this)},k.onAudioTracksUpdated=function(h,v){var b=v.audioTracks;this.resetTransmuxer(),this.levels=b.map(function(R){return new u.Level(R)})},k.onAudioTrackSwitching=function(h,v){var b=!!v.url;this.trackId=v.id;var R=this.fragCurrent;R!=null&&R.loader&&R.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),b?this.setInterval(100):this.resetTransmuxer(),b?(this.audioSwitch=!0,this.state=i.State.IDLE):this.state=i.State.STOPPED,this.tick()},k.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},k.onLevelLoaded=function(h,v){this.mainDetails=v.details},k.onAudioTrackLoaded=function(h,v){var b,R=this.levels,I=v.details,C=v.id;if(R){this.log("Track "+C+" loaded ["+I.startSN+","+I.endSN+"],duration:"+I.totalduration);var x=R[C],O=0;if(I.live||(b=x.details)!==null&&b!==void 0&&b.live){var P=this.mainDetails;if(I.fragments[0]||(I.deltaUpdateFailed=!0),I.deltaUpdateFailed||!P)return;!x.details&&I.hasProgramDateTime&&P.hasProgramDateTime?(Object(E.alignPDT)(I,P),O=I.fragments[0].start):O=this.alignPlaylists(I,x.details)}x.details=I,this.levelLastLoaded=C,this.startFragRequested||!this.mainDetails&&I.live||this.setStartPosition(x.details,O),this.state!==i.State.WAITING_TRACK||this.waitForCdnTuneIn(I)||(this.state=i.State.IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+C)},k._handleFragmentLoadProgress=function(h){var v,b=h.frag,R=h.part,I=h.payload,C=this.config,x=this.trackId,O=this.levels;if(O){var P=O[x];console.assert(P,"Audio track is defined on fragment load progress");var M=P.details;console.assert(M,"Audio track details are defined on fragment load progress");var F=C.defaultAudioCodec||P.audioCodec||"mp4a.40.2",B=this.transmuxer;B||(B=this.transmuxer=new f.default(this.hls,o.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var j=this.initPTS[b.cc],K=(v=b.initSegment)===null||v===void 0?void 0:v.data;if(j!==void 0){var z=R?R.index:-1,re=z!==-1,ne=new L.ChunkMetadata(b.level,b.sn,b.stats.chunkCount,I.byteLength,z,re);B.push(I,K,F,"",b,R,M.totalduration,!1,ne,j)}else g.logger.log("Unknown video PTS for cc "+b.cc+", waiting for video PTS before demuxing audio frag "+b.sn+" of ["+M.startSN+" ,"+M.endSN+"],track "+x),(this.waitingData=this.waitingData||{frag:b,part:R,cache:new m.default,complete:!1}).cache.push(new Uint8Array(I)),this.waitingVideoCC=this.videoTrackCC,this.state=i.State.WAITING_INIT_PTS}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+b.sn+" of level "+b.level+" will not be buffered")},k._handleFragmentLoadComplete=function(h){this.waitingData?this.waitingData.complete=!0:p.prototype._handleFragmentLoadComplete.call(this,h)},k.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},k.onBufferCreated=function(h,v){var b=v.tracks.audio;b&&(this.mediaBuffer=b.buffer),v.tracks.video&&(this.videoBuffer=v.tracks.video.buffer)},k.onFragBuffered=function(h,v){var b=v.frag,R=v.part;b.type===o.PlaylistLevelType.AUDIO&&(this.fragContextChanged(b)?this.warn("Fragment "+b.sn+(R?" p: "+R.index:"")+" of level "+b.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):(b.sn!=="initSegment"&&(this.fragPrevious=b,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(s.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(b,R)))},k.onError=function(h,v){switch(v.details){case l.ErrorDetails.FRAG_LOAD_ERROR:case l.ErrorDetails.FRAG_LOAD_TIMEOUT:case l.ErrorDetails.KEY_LOAD_ERROR:case l.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(o.PlaylistLevelType.AUDIO,v);break;case l.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case l.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==i.State.ERROR&&this.state!==i.State.STOPPED&&(this.state=v.fatal?i.State.ERROR:i.State.IDLE,this.warn(v.details+" while loading frag, switching to "+this.state+" state"));break;case l.ErrorDetails.BUFFER_FULL_ERROR:if(v.parent==="audio"&&(this.state===i.State.PARSING||this.state===i.State.PARSED)){var b=!0,R=this.getFwdBufferInfo(this.mediaBuffer,o.PlaylistLevelType.AUDIO);R&&R.len>.5&&(b=!this.reduceMaxBufferLength(R.len)),b&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,p.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}},k.onBufferFlushed=function(h,v){v.type===y.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},k._handleTransmuxComplete=function(h){var v,b="audio",R=this.hls,I=h.remuxResult,C=h.chunkMeta,x=this.getCurrentContext(C);if(!x)return this.warn("The loading context changed while buffering fragment "+C.sn+" of level "+C.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(C.level);var O=x.frag,P=x.part,M=I.audio,F=I.text,B=I.id3,j=I.initSegment;if(!this.fragContextChanged(O)){if(this.state=i.State.PARSING,this.audioSwitch&&M&&this.completeAudioSwitch(),j!=null&&j.tracks&&(this._bufferInitSegment(j.tracks,O,C),R.trigger(s.Events.FRAG_PARSING_INIT_SEGMENT,{frag:O,id:b,tracks:j.tracks})),M){var K=M.startPTS,z=M.endPTS,re=M.startDTS,ne=M.endDTS;P&&(P.elementaryStreams[y.ElementaryStreamTypes.AUDIO]={startPTS:K,endPTS:z,startDTS:re,endDTS:ne}),O.setElementaryStreamInfo(y.ElementaryStreamTypes.AUDIO,K,z,re,ne),this.bufferFragmentData(M,O,P,C)}if(B!=null&&(v=B.samples)!==null&&v!==void 0&&v.length){var V=c({frag:O,id:b},B);R.trigger(s.Events.FRAG_PARSING_METADATA,V)}if(F){var q=c({frag:O,id:b},F);R.trigger(s.Events.FRAG_PARSING_USERDATA,q)}}},k._bufferInitSegment=function(h,v,b){if(this.state===i.State.PARSING){h.video&&delete h.video;var R=h.audio;if(R){R.levelCodec=R.codec,R.id="audio",this.log("Init audio buffer, container:"+R.container+", codecs[parsed]=["+R.codec+"]"),this.hls.trigger(s.Events.BUFFER_CODECS,h);var I=R.initSegment;if(I!=null&&I.byteLength){var C={type:"audio",frag:v,part:null,chunkMeta:b,parent:v.type,data:I};this.hls.trigger(s.Events.BUFFER_APPENDING,C)}this.tick()}}},k.loadFragment=function(h,v,b){var R=this.fragmentTracker.getState(h);this.fragCurrent=h,(this.audioSwitch||R===d.FragmentState.NOT_LOADED||R===d.FragmentState.PARTIAL)&&(h.sn==="initSegment"?this._loadInitSegment(h):v.live&&!Object(n.isFiniteNumber)(this.initPTS[h.cc])?(this.log("Waiting for video PTS in continuity counter "+h.cc+" of live stream before loading audio fragment "+h.sn+" of level "+this.trackId),this.state=i.State.WAITING_INIT_PTS):(this.startFragRequested=!0,p.prototype.loadFragment.call(this,h,v,b)))},k.completeAudioSwitch=function(){var h=this.hls,v=this.media,b=this.trackId;v&&(this.log("Switching audio track : flushing all audio"),p.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,h.trigger(s.Events.AUDIO_TRACK_SWITCHED,{id:b})},w}(i.default);e.default=S},"./src/controller/audio-track-controller.ts":function(t,e,r){r.r(e);var n=r("./src/events.ts"),i=r("./src/errors.ts"),s=r("./src/controller/base-playlist-controller.ts"),a=r("./src/types/loader.ts");function d(y,m){for(var f=0;f<m.length;f++){var L=m[f];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(y,L.key,L)}}function u(y,m){return(u=Object.setPrototypeOf||function(f,L){return f.__proto__=L,f})(y,m)}var o=function(y){var m,f;function L(g){var c;return(c=y.call(this,g,"[audio-track-controller]")||this).tracks=[],c.groupId=null,c.tracksInGroup=[],c.trackId=-1,c.trackName="",c.selectDefaultTrack=!0,c.registerListeners(),c}f=y,(m=L).prototype=Object.create(f.prototype),m.prototype.constructor=m,u(m,f);var _,E,l=L.prototype;return l.registerListeners=function(){var g=this.hls;g.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),g.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),g.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),g.on(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),g.on(n.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),g.on(n.Events.ERROR,this.onError,this)},l.unregisterListeners=function(){var g=this.hls;g.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),g.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),g.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),g.off(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),g.off(n.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),g.off(n.Events.ERROR,this.onError,this)},l.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,y.prototype.destroy.call(this)},l.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},l.onManifestParsed=function(g,c){this.tracks=c.audioTracks||[]},l.onAudioTrackLoaded=function(g,c){var T=c.id,S=c.details,p=this.tracksInGroup[T];if(p){var A=p.details;p.details=c.details,this.log("audioTrack "+T+" loaded ["+S.startSN+"-"+S.endSN+"]"),T===this.trackId&&(this.retryCount=0,this.playlistLoaded(T,c,A))}else this.warn("Invalid audio track id "+T)},l.onLevelLoading=function(g,c){this.switchLevel(c.level)},l.onLevelSwitching=function(g,c){this.switchLevel(c.level)},l.switchLevel=function(g){var c=this.hls.levels[g];if(c!=null&&c.audioGroupIds){var T=c.audioGroupIds[c.urlId];if(this.groupId!==T){this.groupId=T;var S=this.tracks.filter(function(A){return!T||A.groupId===T});this.selectDefaultTrack&&!S.some(function(A){return A.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=S;var p={audioTracks:S};this.log("Updating audio tracks, "+S.length+' track(s) found in "'+T+'" group-id'),this.hls.trigger(n.Events.AUDIO_TRACKS_UPDATED,p),this.selectInitialTrack()}}},l.onError=function(g,c){y.prototype.onError.call(this,g,c),!c.fatal&&c.context&&c.context.type===a.PlaylistContextType.AUDIO_TRACK&&c.context.id===this.trackId&&c.context.groupId===this.groupId&&this.retryLoadingOrFail(c)},l.setAudioTrack=function(g){var c=this.tracksInGroup;if(g<0||g>=c.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var T=c[this.trackId];this.log("Now switching to audio-track index "+g);var S=c[g],p=S.id,A=S.groupId,D=A===void 0?"":A,w=S.name,k=S.type,h=S.url;if(this.trackId=g,this.trackName=w,this.selectDefaultTrack=!1,this.hls.trigger(n.Events.AUDIO_TRACK_SWITCHING,{id:p,groupId:D,name:w,type:k,url:h}),!S.details||S.details.live){var v=this.switchParams(S.url,T==null?void 0:T.details);this.loadPlaylist(v)}}},l.selectInitialTrack=function(){var g=this.tracksInGroup;console.assert(g.length,"Initial audio track should be selected when tracks are known");var c=this.trackName,T=this.findTrackId(c)||this.findTrackId();T!==-1?this.setAudioTrack(T):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},l.findTrackId=function(g){for(var c=this.tracksInGroup,T=0;T<c.length;T++){var S=c[T];if((!this.selectDefaultTrack||S.default)&&(!g||g===S.name))return S.id}return-1},l.loadPlaylist=function(g){var c=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(c)){var T=c.id,S=c.groupId,p=c.url;if(g)try{p=g.addDirectives(p)}catch(A){this.warn("Could not construct new URL with HLS Delivery Directives: "+A)}this.log("loading audio-track playlist for id: "+T),this.clearTimer(),this.hls.trigger(n.Events.AUDIO_TRACK_LOADING,{url:p,id:T,groupId:S,deliveryDirectives:g||null})}},_=L,(E=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(g){this.selectDefaultTrack=!1,this.setAudioTrack(g)}}])&&d(_.prototype,E),L}(s.default);e.default=o},"./src/controller/base-playlist-controller.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return u});var n=r("./src/polyfills/number.ts"),i=r("./src/types/level.ts"),s=r("./src/controller/level-helper.ts"),a=r("./src/utils/logger.ts"),d=r("./src/errors.ts"),u=function(){function o(m,f){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=a.logger.log.bind(a.logger,f+":"),this.warn=a.logger.warn.bind(a.logger,f+":"),this.hls=m}var y=o.prototype;return y.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},y.onError=function(m,f){f.fatal&&f.type===d.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},y.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},y.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},y.stopLoad=function(){this.canLoad=!1,this.clearTimer()},y.switchParams=function(m,f){var L=f==null?void 0:f.renditionReports;if(L)for(var _=0;_<L.length;_++){var E=L[_],l=""+E.URI;if(l===m.substr(-l.length)){var g=parseInt(E["LAST-MSN"]),c=parseInt(E["LAST-PART"]);if(f&&this.hls.config.lowLatencyMode){var T=Math.min(f.age-f.partTarget,f.targetduration);c!==void 0&&T>f.partTarget&&(c+=1)}if(Object(n.isFiniteNumber)(g))return new i.HlsUrlParameters(g,Object(n.isFiniteNumber)(c)?c:void 0,i.HlsSkip.No)}}},y.loadPlaylist=function(m){},y.shouldLoadTrack=function(m){return this.canLoad&&m&&!!m.url&&(!m.details||m.details.live)},y.playlistLoaded=function(m,f,L){var _=this,E=f.details,l=f.stats,g=l.loading.end?Math.max(0,self.performance.now()-l.loading.end):0;if(E.advancedDateTime=Date.now()-g,E.live||L!=null&&L.live){if(E.reloaded(L),L&&this.log("live playlist "+m+" "+(E.advanced?"REFRESHED "+E.lastPartSn+"-"+E.lastPartIndex:"MISSED")),L&&E.fragments.length>0&&Object(s.mergeDetails)(L,E),!this.canLoad||!E.live)return;var c,T=void 0,S=void 0;if(E.canBlockReload&&E.endSN&&E.advanced){var p=this.hls.config.lowLatencyMode,A=E.lastPartSn,D=E.endSN,w=E.lastPartIndex,k=A===D;w!==-1?(T=k?D+1:A,S=k?p?0:w:w+1):T=D+1;var h=E.age,v=h+E.ageHeader,b=Math.min(v-E.partTarget,1.5*E.targetduration);if(b>0){if(L&&b>L.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+L.tuneInGoal+" to: "+b+" with playlist age: "+E.age),b=0;else{var R=Math.floor(b/E.targetduration);T+=R,S!==void 0&&(S+=Math.round(b%E.targetduration/E.partTarget)),this.log("CDN Tune-in age: "+E.ageHeader+"s last advanced "+h.toFixed(2)+"s goal: "+b+" skip sn "+R+" to part "+S)}E.tuneInGoal=b}if(c=this.getDeliveryDirectives(E,f.deliveryDirectives,T,S),p||!k)return void this.loadPlaylist(c)}else c=this.getDeliveryDirectives(E,f.deliveryDirectives,T,S);var I=Object(s.computeReloadInterval)(E,l);T!==void 0&&E.canBlockReload&&(I-=E.partTarget||1),this.log("reload live playlist "+m+" in "+Math.round(I)+" ms"),this.timer=self.setTimeout(function(){return _.loadPlaylist(c)},I)}else this.clearTimer()},y.getDeliveryDirectives=function(m,f,L,_){var E=Object(i.getSkipValue)(m,L);return f!=null&&f.skip&&m.deltaUpdateFailed&&(L=f.msn,_=f.part,E=i.HlsSkip.No),new i.HlsUrlParameters(L,_,E)},y.retryLoadingOrFail=function(m){var f,L=this,_=this.hls.config,E=this.retryCount<_.levelLoadingMaxRetry;if(E)if(this.retryCount++,m.details.indexOf("LoadTimeOut")>-1&&(f=m.context)!==null&&f!==void 0&&f.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+m.details+'"'),this.loadPlaylist();else{var l=Math.min(Math.pow(2,this.retryCount)*_.levelLoadingRetryDelay,_.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return L.loadPlaylist()},l),this.warn("retry playlist loading #"+this.retryCount+" in "+l+' ms after "'+m.details+'"')}else this.warn('cannot recover from error "'+m.details+'"'),this.clearTimer(),m.fatal=!0;return E},o}()},"./src/controller/base-stream-controller.ts":function(t,e,r){r.r(e),r.d(e,"State",function(){return p}),r.d(e,"default",function(){return A});var n=r("./src/polyfills/number.ts"),i=r("./src/task-loop.ts"),s=r("./src/controller/fragment-tracker.ts"),a=r("./src/utils/buffer-helper.ts"),d=r("./src/utils/logger.ts"),u=r("./src/events.ts"),o=r("./src/errors.ts"),y=r("./src/types/transmuxer.ts"),m=r("./src/utils/mp4-tools.ts"),f=r("./src/utils/discontinuities.ts"),L=r("./src/controller/fragment-finders.ts"),_=r("./src/controller/level-helper.ts"),E=r("./src/loader/fragment-loader.ts"),l=r("./src/crypt/decrypter.ts"),g=r("./src/utils/time-ranges.ts"),c=r("./src/types/loader.ts");function T(D,w){for(var k=0;k<w.length;k++){var h=w[k];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(D,h.key,h)}}function S(D,w){return(S=Object.setPrototypeOf||function(k,h){return k.__proto__=h,k})(D,w)}var p={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},A=function(D){var w,k;function h(I,C,x){var O;return(O=D.call(this)||this).hls=void 0,O.fragPrevious=null,O.fragCurrent=null,O.fragmentTracker=void 0,O.transmuxer=null,O._state=p.STOPPED,O.media=void 0,O.mediaBuffer=void 0,O.config=void 0,O.bitrateTest=!1,O.lastCurrentTime=0,O.nextLoadPosition=0,O.startPosition=0,O.loadedmetadata=!1,O.fragLoadError=0,O.retryDate=0,O.levels=null,O.fragmentLoader=void 0,O.levelLastLoaded=null,O.startFragRequested=!1,O.decrypter=void 0,O.initPTS=[],O.onvseeking=null,O.onvended=null,O.logPrefix="",O.log=void 0,O.warn=void 0,O.logPrefix=x,O.log=d.logger.log.bind(d.logger,x+":"),O.warn=d.logger.warn.bind(d.logger,x+":"),O.hls=I,O.fragmentLoader=new E.default(I.config),O.fragmentTracker=C,O.config=I.config,O.decrypter=new l.default(I,I.config),I.on(u.Events.KEY_LOADED,O.onKeyLoaded,function(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}(O)),O}k=D,(w=h).prototype=Object.create(k.prototype),w.prototype.constructor=w,S(w,k);var v,b,R=h.prototype;return R.doTick=function(){this.onTickEnd()},R.onTickEnd=function(){},R.startLoad=function(I){},R.stopLoad=function(){this.fragmentLoader.abort();var I=this.fragCurrent;I&&this.fragmentTracker.removeFragment(I),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=p.STOPPED},R._streamEnded=function(I,C){var x=this.fragCurrent,O=this.fragmentTracker;if(!C.live&&x&&x.sn===C.endSN&&!I.nextStart){var P=O.getState(x);return P===s.FragmentState.PARTIAL||P===s.FragmentState.OK}return!1},R.onMediaAttached=function(I,C){var x=this.media=this.mediaBuffer=C.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),x.addEventListener("seeking",this.onvseeking),x.addEventListener("ended",this.onvended);var O=this.config;this.levels&&O.autoStartLoad&&this.state===p.STOPPED&&this.startLoad(O.startPosition)},R.onMediaDetaching=function(){var I=this.media;I!=null&&I.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),I&&(I.removeEventListener("seeking",this.onvseeking),I.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},R.onMediaSeeking=function(){var I=this.config,C=this.fragCurrent,x=this.media,O=this.mediaBuffer,P=this.state,M=x?x.currentTime:0,F=a.BufferHelper.bufferInfo(O||x,M,I.maxBufferHole);if(this.log("media seeking to "+(Object(n.isFiniteNumber)(M)?M.toFixed(3):M)+", state: "+P),P===p.ENDED)this.resetLoadingState();else if(C&&!F.len){var B=I.maxFragLookUpTolerance,j=C.start-B,K=M>C.start+C.duration+B;(M<j||K)&&(K&&C.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),C.loader.abort()),this.resetLoadingState())}x&&(this.lastCurrentTime=M),this.loadedmetadata||F.len||(this.nextLoadPosition=this.startPosition=M),this.tickImmediate()},R.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},R.onKeyLoaded=function(I,C){if(this.state===p.KEY_LOADING&&C.frag===this.fragCurrent&&this.levels){this.state=p.IDLE;var x=this.levels[C.frag.level].details;x&&this.loadFragment(C.frag,x,C.frag.start)}},R.onHandlerDestroying=function(){this.stopLoad(),D.prototype.onHandlerDestroying.call(this)},R.onHandlerDestroyed=function(){this.state=p.STOPPED,this.hls.off(u.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,D.prototype.onHandlerDestroyed.call(this)},R.loadKey=function(I,C){this.log("Loading key for "+I.sn+" of ["+C.startSN+"-"+C.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level),this.state=p.KEY_LOADING,this.fragCurrent=I,this.hls.trigger(u.Events.KEY_LOADING,{frag:I})},R.loadFragment=function(I,C,x){this._loadFragForPlayback(I,C,x)},R._loadFragForPlayback=function(I,C,x){var O=this;this._doFragLoad(I,C,x,function(P){if(O.fragContextChanged(I))return O.warn("Fragment "+I.sn+(P.part?" p: "+P.part.index:"")+" of level "+I.level+" was dropped during download."),void O.fragmentTracker.removeFragment(I);I.stats.chunkCount++,O._handleFragmentLoadProgress(P)}).then(function(P){if(P){O.fragLoadError=0;var M=O.state;if(!O.fragContextChanged(I))return"payload"in P&&(O.log("Loaded fragment "+I.sn+" of level "+I.level),O.hls.trigger(u.Events.FRAG_LOADED,P),O.state===p.BACKTRACKING)?(O.fragmentTracker.backtrack(I,P),void O.resetFragmentLoading(I)):void O._handleFragmentLoadComplete(P);(M===p.FRAG_LOADING||M===p.BACKTRACKING||!O.fragCurrent&&M===p.PARSING)&&(O.fragmentTracker.removeFragment(I),O.state=p.IDLE)}}).catch(function(P){O.warn(P),O.resetFragmentLoading(I)})},R.flushMainBuffer=function(I,C,x){if(x===void 0&&(x=null),I-C){var O={startOffset:I,endOffset:C,type:x};this.fragLoadError=0,this.hls.trigger(u.Events.BUFFER_FLUSHING,O)}},R._loadInitSegment=function(I){var C=this;this._doFragLoad(I).then(function(x){if(!x||C.fragContextChanged(I)||!C.levels)throw new Error("init load aborted");return x}).then(function(x){var O=C.hls,P=x.payload,M=I.decryptdata;if(P&&P.byteLength>0&&M&&M.key&&M.iv&&M.method==="AES-128"){var F=self.performance.now();return C.decrypter.webCryptoDecrypt(new Uint8Array(P),M.key.buffer,M.iv.buffer).then(function(B){var j=self.performance.now();return O.trigger(u.Events.FRAG_DECRYPTED,{frag:I,payload:B,stats:{tstart:F,tdecrypt:j}}),x.payload=B,x})}return x}).then(function(x){var O=C.fragCurrent,P=C.hls,M=C.levels;if(!M)throw new Error("init load aborted, missing levels");var F=M[I.level].details;console.assert(F,"Level details are defined when init segment is loaded");var B=I.stats;C.state=p.IDLE,C.fragLoadError=0,I.data=new Uint8Array(x.payload),B.parsing.start=B.buffering.start=self.performance.now(),B.parsing.end=B.buffering.end=self.performance.now(),x.frag===O&&P.trigger(u.Events.FRAG_BUFFERED,{stats:B,frag:O,part:null,id:I.type}),C.tick()}).catch(function(x){C.warn(x),C.resetFragmentLoading(I)})},R.fragContextChanged=function(I){var C=this.fragCurrent;return!I||!C||I.level!==C.level||I.sn!==C.sn||I.urlId!==C.urlId},R.fragBufferedComplete=function(I,C){var x=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+I.type+" sn: "+I.sn+(C?" part: "+C.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level+" "+g.default.toString(a.BufferHelper.getBuffered(x))),this.state=p.IDLE,this.tick()},R._handleFragmentLoadComplete=function(I){var C=this.transmuxer;if(C){var x=I.frag,O=I.part,P=I.partsLoaded,M=!P||P.length===0||P.some(function(B){return!B}),F=new y.ChunkMetadata(x.level,x.sn,x.stats.chunkCount+1,0,O?O.index:-1,!M);C.flush(F)}},R._handleFragmentLoadProgress=function(I){},R._doFragLoad=function(I,C,x,O){var P=this;if(x===void 0&&(x=null),!this.levels)throw new Error("frag load aborted, missing levels");if(x=Math.max(I.start,x||0),this.config.lowLatencyMode&&C){var M=C.partList;if(M&&O){x>I.end&&C.fragmentHint&&(I=C.fragmentHint);var F=this.getNextPart(M,I,x);if(F>-1){var B=M[F];return this.log("Loading part sn: "+I.sn+" p: "+B.index+" cc: "+I.cc+" of playlist ["+C.startSN+"-"+C.endSN+"] parts [0-"+F+"-"+(M.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(x.toFixed(3))),this.nextLoadPosition=B.start+B.duration,this.state=p.FRAG_LOADING,this.hls.trigger(u.Events.FRAG_LOADING,{frag:I,part:M[F],targetBufferTime:x}),this.doFragPartsLoad(I,M,F,O).catch(function(j){return P.handleFragLoadError(j)})}if(!I.url||this.loadedEndOfParts(M,x))return Promise.resolve(null)}}return this.log("Loading fragment "+I.sn+" cc: "+I.cc+" "+(C?"of ["+C.startSN+"-"+C.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(x.toFixed(3))),Object(n.isFiniteNumber)(I.sn)&&!this.bitrateTest&&(this.nextLoadPosition=I.start+I.duration),this.state=p.FRAG_LOADING,this.hls.trigger(u.Events.FRAG_LOADING,{frag:I,targetBufferTime:x}),this.fragmentLoader.load(I,O).catch(function(j){return P.handleFragLoadError(j)})},R.doFragPartsLoad=function(I,C,x,O){var P=this;return new Promise(function(M,F){var B=[];(function j(K){var z=C[K];P.fragmentLoader.loadPart(I,z,O).then(function(re){B[z.index]=re;var ne=re.part;P.hls.trigger(u.Events.FRAG_LOADED,re);var V=C[K+1];if(!V||V.fragment!==I)return M({frag:I,part:ne,partsLoaded:B});j(K+1)}).catch(F)})(x)})},R.handleFragLoadError=function(I){var C=I.data;return C&&C.details===o.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(C.frag,C.part):this.hls.trigger(u.Events.ERROR,C),null},R._handleTransmuxerFlush=function(I){var C=this.getCurrentContext(I);if(C&&this.state===p.PARSING){var x=C.frag,O=C.part,P=C.level,M=self.performance.now();x.stats.parsing.end=M,O&&(O.stats.parsing.end=M),this.updateLevelTiming(x,O,P,I.partial)}else this.fragCurrent||(this.state=p.IDLE)},R.getCurrentContext=function(I){var C=this.levels,x=I.level,O=I.sn,P=I.part;if(!C||!C[x])return this.warn("Levels object was unset while buffering fragment "+O+" of level "+x+". The current chunk will not be buffered."),null;var M=C[x],F=P>-1?Object(_.getPartWith)(M,O,P):null,B=F?F.fragment:Object(_.getFragmentWithSN)(M,O,this.fragCurrent);return B?{frag:B,part:F,level:M}:null},R.bufferFragmentData=function(I,C,x,O){if(I&&this.state===p.PARSING){var P=I.data1,M=I.data2,F=P;if(P&&M&&(F=Object(m.appendUint8Array)(P,M)),F&&F.length){var B={type:I.type,frag:C,part:x,chunkMeta:O,parent:C.type,data:F};this.hls.trigger(u.Events.BUFFER_APPENDING,B),I.dropped&&I.independent&&!x&&this.flushBufferGap(C)}}},R.flushBufferGap=function(I){var C=this.media;if(C)if(a.BufferHelper.isBuffered(C,C.currentTime)){var x=C.currentTime,O=a.BufferHelper.bufferInfo(C,x,0),P=I.duration,M=Math.min(2*this.config.maxFragLookUpTolerance,.25*P),F=Math.max(Math.min(I.start-M,O.end-M),x+M);I.start-F>M&&this.flushMainBuffer(F,I.start)}else this.flushMainBuffer(0,I.start)},R.getFwdBufferInfo=function(I,C){var x=this.config,O=this.getLoadPosition();if(!Object(n.isFiniteNumber)(O))return null;var P=a.BufferHelper.bufferInfo(I,O,x.maxBufferHole);if(P.len===0&&P.nextStart!==void 0){var M=this.fragmentTracker.getBufferedFrag(O,C);if(M&&P.nextStart<M.end)return a.BufferHelper.bufferInfo(I,O,Math.max(P.nextStart,x.maxBufferHole))}return P},R.getMaxBufferLength=function(I){var C,x=this.config;return C=I?Math.max(8*x.maxBufferSize/I,x.maxBufferLength):x.maxBufferLength,Math.min(C,x.maxMaxBufferLength)},R.reduceMaxBufferLength=function(I){var C=this.config,x=I||C.maxBufferLength;return C.maxMaxBufferLength>=x&&(C.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+C.maxMaxBufferLength+"s"),!0)},R.getNextFragment=function(I,C){var x,O,P=C.fragments,M=P.length;if(!M)return null;var F,B=this.config,j=P[0].start;if(C.live){var K=B.initialLiveManifestSize;if(M<K)return this.warn("Not enough fragments to start playback (have: "+M+", need: "+K+")"),null;C.PTSKnown||this.startFragRequested||this.startPosition!==-1||(F=this.getInitialLiveFragment(C,P),this.startPosition=F?this.hls.liveSyncPosition||F.start:I)}else I<=j&&(F=P[0]);if(!F){var z=B.lowLatencyMode?C.partEnd:C.fragmentEnd;F=this.getFragmentAtPosition(I,z,C)}return(x=F)===null||x===void 0||!x.initSegment||(O=F)!==null&&O!==void 0&&O.initSegment.data||this.bitrateTest||(F=F.initSegment),F},R.getNextPart=function(I,C,x){for(var O=-1,P=!1,M=!0,F=0,B=I.length;F<B;F++){var j=I[F];if(M=M&&!j.independent,O>-1&&x<j.start)break;var K=j.loaded;!K&&(P||j.independent||M)&&j.fragment===C&&(O=F),P=K}return O},R.loadedEndOfParts=function(I,C){var x=I[I.length-1];return x&&C>x.start&&x.loaded},R.getInitialLiveFragment=function(I,C){var x=this.fragPrevious,O=null;if(x){if(I.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+x.programDateTime),O=Object(L.findFragmentByPDT)(C,x.endProgramDateTime,this.config.maxFragLookUpTolerance)),!O){var P=x.sn+1;if(P>=I.startSN&&P<=I.endSN){var M=C[P-I.startSN];x.cc===M.cc&&(O=M,this.log("Live playlist, switching playlist, load frag with next SN: "+O.sn))}O||(O=Object(L.findFragWithCC)(C,x.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+O.sn)}}else{var F=this.hls.liveSyncPosition;F!==null&&(O=this.getFragmentAtPosition(F,this.bitrateTest?I.fragmentEnd:I.edge,I))}return O},R.getFragmentAtPosition=function(I,C,x){var O,P=this.config,M=this.fragPrevious,F=x.fragments,B=x.endSN,j=x.fragmentHint,K=P.maxFragLookUpTolerance,z=!!(P.lowLatencyMode&&x.partList&&j);if(z&&j&&!this.bitrateTest&&(F=F.concat(j),B=j.sn),I<C){var re=I>C-K?0:K;O=Object(L.findFragmentByPTS)(M,F,I,re)}else O=F[F.length-1];if(O){var ne=O.sn-x.startSN,V=M&&O.level===M.level,q=F[ne+1];if(this.fragmentTracker.getState(O)===s.FragmentState.BACKTRACKED){O=null;for(var Y=ne;F[Y]&&this.fragmentTracker.getState(F[Y])===s.FragmentState.BACKTRACKED;)O=M?F[Y--]:F[--Y];O||(O=q)}else M&&O.sn===M.sn&&!z&&V&&(O.sn<B&&this.fragmentTracker.getState(q)!==s.FragmentState.OK?(this.log("SN "+O.sn+" just loaded, load next one: "+q.sn),O=q):O=null)}return O},R.synchronizeToLiveEdge=function(I){var C=this.config,x=this.media;if(x){var O=this.hls.liveSyncPosition,P=x.currentTime,M=I.fragments[0].start,F=I.edge,B=P>=M-C.maxFragLookUpTolerance&&P<=F;if(O!==null&&x.duration>O&&(P<O||!B)){var j=C.liveMaxLatencyDuration!==void 0?C.liveMaxLatencyDuration:C.liveMaxLatencyDurationCount*I.targetduration;(!B&&x.readyState<4||P<F-j)&&(this.loadedmetadata||(this.nextLoadPosition=O),x.readyState&&(this.warn("Playback: "+P.toFixed(3)+" is located too far from the end of live sliding playlist: "+F+", reset currentTime to : "+O.toFixed(3)),x.currentTime=O))}}},R.alignPlaylists=function(I,C){var x=this.levels,O=this.levelLastLoaded,P=this.fragPrevious,M=O!==null?x[O]:null,F=I.fragments.length;if(!F)return this.warn("No fragments in live playlist"),0;var B=I.fragments[0].start,j=!C,K=I.alignedSliding&&Object(n.isFiniteNumber)(B);if(j||!K&&!B){Object(f.alignStream)(P,M,I);var z=I.fragments[0].start;return this.log("Live playlist sliding: "+z.toFixed(2)+" start-sn: "+(C?C.startSN:"na")+"->"+I.startSN+" prev-sn: "+(P?P.sn:"na")+" fragments: "+F),z}return B},R.waitForCdnTuneIn=function(I){return I.live&&I.canBlockReload&&I.tuneInGoal>Math.max(I.partHoldBack,3*I.partTarget)},R.setStartPosition=function(I,C){var x=this.startPosition;if(x<C&&(x=-1),x===-1||this.lastCurrentTime===-1){var O=I.startTimeOffset;Object(n.isFiniteNumber)(O)?(x=C+O,O<0&&(x+=I.totalduration),x=Math.min(Math.max(C,x),C+I.totalduration),this.log("Start time offset "+O+" found in playlist, adjust startPosition to "+x),this.startPosition=x):I.live?x=this.hls.liveSyncPosition||C:this.startPosition=x=0,this.lastCurrentTime=x}this.nextLoadPosition=x},R.getLoadPosition=function(){var I=this.media,C=0;return this.loadedmetadata&&I?C=I.currentTime:this.nextLoadPosition&&(C=this.nextLoadPosition),C},R.handleFragLoadAborted=function(I,C){this.transmuxer&&I.sn!=="initSegment"&&I.stats.aborted&&(this.warn("Fragment "+I.sn+(C?" part"+C.index:"")+" of level "+I.level+" was aborted"),this.resetFragmentLoading(I))},R.resetFragmentLoading=function(I){this.fragCurrent&&this.fragContextChanged(I)||(this.state=p.IDLE)},R.onFragmentOrKeyLoadError=function(I,C){if(!C.fatal){var x=C.frag;if(x&&x.type===I){var O=this.fragCurrent;console.assert(O&&x.sn===O.sn&&x.level===O.level&&x.urlId===O.urlId,"Frag load error must match current frag to retry");var P=this.config;if(this.fragLoadError+1<=P.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(x.level))return;var M=Math.min(Math.pow(2,this.fragLoadError)*P.fragLoadingRetryDelay,P.fragLoadingMaxRetryTimeout);this.warn("Fragment "+x.sn+" of "+I+" "+x.level+" failed to load, retrying in "+M+"ms"),this.retryDate=self.performance.now()+M,this.fragLoadError++,this.state=p.FRAG_LOADING_WAITING_RETRY}else C.levelRetry?(I===c.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=p.IDLE):(d.logger.error(C.details+" reaches max retry, redispatch as fatal ..."),C.fatal=!0,this.hls.stopLoad(),this.state=p.ERROR)}}},R.afterBufferFlushed=function(I,C,x){if(I){var O=a.BufferHelper.getBuffered(I);this.fragmentTracker.detectEvictedFragments(C,O,x),this.state===p.ENDED&&this.resetLoadingState()}},R.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=p.IDLE},R.resetLiveStartWhenNotLoaded=function(I){if(!this.loadedmetadata){this.startFragRequested=!1;var C=this.levels?this.levels[I].details:null;if(C!=null&&C.live)return this.startPosition=-1,this.setStartPosition(C,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},R.updateLevelTiming=function(I,C,x,O){var P=this,M=x.details;console.assert(!!M,"level.details must be defined"),Object.keys(I.elementaryStreams).reduce(function(F,B){var j=I.elementaryStreams[B];if(j){var K=j.endPTS-j.startPTS;if(K<=0)return P.warn("Could not parse fragment "+I.sn+" "+B+" duration reliably ("+K+") resetting transmuxer to fallback to playlist timing"),P.resetTransmuxer(),F||!1;var z=O?0:Object(_.updateFragPTSDTS)(M,I,j.startPTS,j.endPTS,j.startDTS,j.endDTS);return P.hls.trigger(u.Events.LEVEL_PTS_UPDATED,{details:M,level:x,drift:z,type:B,frag:I,start:j.startPTS,end:j.endPTS}),!0}return F},!1)?(this.state=p.PARSED,this.hls.trigger(u.Events.FRAG_PARSED,{frag:I,part:C})):this.resetLoadingState()},R.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},v=h,(b=[{key:"state",get:function(){return this._state},set:function(I){var C=this._state;C!==I&&(this._state=I,this.log(C+"->"+I))}}])&&T(v.prototype,b),h}(i.default)},"./src/controller/buffer-controller.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return L});var n=r("./src/polyfills/number.ts"),i=r("./src/events.ts"),s=r("./src/utils/logger.ts"),a=r("./src/errors.ts"),d=r("./src/utils/buffer-helper.ts"),u=r("./src/utils/mediasource-helper.ts"),o=r("./src/loader/fragment.ts"),y=r("./src/controller/buffer-operation-queue.ts"),m=Object(u.getMediaSource)(),f=/([ha]vc.)(?:\.[^.,]+)+/,L=function(){function _(l){var g=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var c=g.hls,T=g.media,S=g.mediaSource;s.logger.log("[buffer-controller]: Media source opened"),T&&(g.updateMediaElementDuration(),c.trigger(i.Events.MEDIA_ATTACHED,{media:T})),S&&S.removeEventListener("sourceopen",g._onMediaSourceOpen),g.checkPendingTracks()},this._onMediaSourceClose=function(){s.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){s.logger.log("[buffer-controller]: Media source ended")},this.hls=l,this._initSourceBuffer(),this.registerListeners()}var E=_.prototype;return E.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},E.destroy=function(){this.unregisterListeners(),this.details=null},E.registerListeners=function(){var l=this.hls;l.on(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),l.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.on(i.Events.BUFFER_RESET,this.onBufferReset,this),l.on(i.Events.BUFFER_APPENDING,this.onBufferAppending,this),l.on(i.Events.BUFFER_CODECS,this.onBufferCodecs,this),l.on(i.Events.BUFFER_EOS,this.onBufferEos,this),l.on(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),l.on(i.Events.LEVEL_UPDATED,this.onLevelUpdated,this),l.on(i.Events.FRAG_PARSED,this.onFragParsed,this),l.on(i.Events.FRAG_CHANGED,this.onFragChanged,this)},E.unregisterListeners=function(){var l=this.hls;l.off(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),l.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.off(i.Events.BUFFER_RESET,this.onBufferReset,this),l.off(i.Events.BUFFER_APPENDING,this.onBufferAppending,this),l.off(i.Events.BUFFER_CODECS,this.onBufferCodecs,this),l.off(i.Events.BUFFER_EOS,this.onBufferEos,this),l.off(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),l.off(i.Events.LEVEL_UPDATED,this.onLevelUpdated,this),l.off(i.Events.FRAG_PARSED,this.onFragParsed,this),l.off(i.Events.FRAG_CHANGED,this.onFragChanged,this)},E._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new y.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},E.onManifestParsed=function(l,g){var c=2;(g.audio&&!g.video||!g.altAudio)&&(c=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=c,this.details=null,s.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},E.onMediaAttaching=function(l,g){var c=this.media=g.media;if(c&&m){var T=this.mediaSource=new m;T.addEventListener("sourceopen",this._onMediaSourceOpen),T.addEventListener("sourceended",this._onMediaSourceEnded),T.addEventListener("sourceclose",this._onMediaSourceClose),c.src=self.URL.createObjectURL(T),this._objectUrl=c.src}},E.onMediaDetaching=function(){var l=this.media,g=this.mediaSource,c=this._objectUrl;if(g){if(s.logger.log("[buffer-controller]: media source detaching"),g.readyState==="open")try{g.endOfStream()}catch(T){s.logger.warn("[buffer-controller]: onMediaDetaching: "+T.message+" while calling endOfStream")}this.onBufferReset(),g.removeEventListener("sourceopen",this._onMediaSourceOpen),g.removeEventListener("sourceended",this._onMediaSourceEnded),g.removeEventListener("sourceclose",this._onMediaSourceClose),l&&(c&&self.URL.revokeObjectURL(c),l.src===c?(l.removeAttribute("src"),l.load()):s.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(i.Events.MEDIA_DETACHED,void 0)},E.onBufferReset=function(){var l=this;this.getSourceBufferTypes().forEach(function(g){var c=l.sourceBuffer[g];try{c&&(l.removeBufferListeners(g),l.mediaSource&&l.mediaSource.removeSourceBuffer(c),l.sourceBuffer[g]=void 0)}catch(T){s.logger.warn("[buffer-controller]: Failed to reset the "+g+" buffer",T)}}),this._initSourceBuffer()},E.onBufferCodecs=function(l,g){var c=this,T=this.getSourceBufferTypes().length;Object.keys(g).forEach(function(S){if(T){var p=c.tracks[S];if(p&&typeof p.buffer.changeType=="function"){var A=g[S],D=A.codec,w=A.levelCodec,k=A.container;if((p.levelCodec||p.codec).replace(f,"$1")!==(w||D).replace(f,"$1")){var h=k+";codecs="+(w||D);c.appendChangeType(S,h)}}}else c.pendingTracks[S]=g[S]}),T||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},E.appendChangeType=function(l,g){var c=this,T=this.operationQueue,S={execute:function(){var p=c.sourceBuffer[l];p&&(s.logger.log("[buffer-controller]: changing "+l+" sourceBuffer type to "+g),p.changeType(g)),T.shiftAndExecuteNext(l)},onStart:function(){},onComplete:function(){},onError:function(p){s.logger.warn("[buffer-controller]: Failed to change "+l+" SourceBuffer type",p)}};T.append(S,l)},E.onBufferAppending=function(l,g){var c=this,T=this.hls,S=this.operationQueue,p=this.tracks,A=g.data,D=g.type,w=g.frag,k=g.part,h=g.chunkMeta,v=h.buffering[D],b=self.performance.now();v.start=b;var R=w.stats.buffering,I=k?k.stats.buffering:null;R.start===0&&(R.start=b),I&&I.start===0&&(I.start=b);var C=p.audio,x=D==="audio"&&h.id===1&&(C==null?void 0:C.container)==="audio/mpeg",O={execute:function(){if(v.executeStart=self.performance.now(),x){var P=c.sourceBuffer[D];if(P){var M=w.start-P.timestampOffset;Math.abs(M)>=.1&&(s.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+w.start+" (delta: "+M+") sn: "+w.sn+")"),P.timestampOffset=w.start)}}c.appendExecutor(A,D)},onStart:function(){},onComplete:function(){var P=self.performance.now();v.executeEnd=v.end=P,R.first===0&&(R.first=P),I&&I.first===0&&(I.first=P);var M=c.sourceBuffer,F={};for(var B in M)F[B]=d.BufferHelper.getBuffered(M[B]);c.appendError=0,c.hls.trigger(i.Events.BUFFER_APPENDED,{type:D,frag:w,part:k,chunkMeta:h,parent:w.type,timeRanges:F})},onError:function(P){s.logger.error("[buffer-controller]: Error encountered while trying to append to the "+D+" SourceBuffer",P);var M={type:a.ErrorTypes.MEDIA_ERROR,parent:w.type,details:a.ErrorDetails.BUFFER_APPEND_ERROR,err:P,fatal:!1};P.code===DOMException.QUOTA_EXCEEDED_ERR?M.details=a.ErrorDetails.BUFFER_FULL_ERROR:(c.appendError++,M.details=a.ErrorDetails.BUFFER_APPEND_ERROR,c.appendError>T.config.appendErrorMaxRetry&&(s.logger.error("[buffer-controller]: Failed "+T.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),M.fatal=!0)),T.trigger(i.Events.ERROR,M)}};S.append(O,D)},E.onBufferFlushing=function(l,g){var c=this,T=this.operationQueue,S=function(p){return{execute:c.removeExecutor.bind(c,p,g.startOffset,g.endOffset),onStart:function(){},onComplete:function(){c.hls.trigger(i.Events.BUFFER_FLUSHED,{type:p})},onError:function(A){s.logger.warn("[buffer-controller]: Failed to remove from "+p+" SourceBuffer",A)}}};g.type?T.append(S(g.type),g.type):this.getSourceBufferTypes().forEach(function(p){T.append(S(p),p)})},E.onFragParsed=function(l,g){var c=this,T=g.frag,S=g.part,p=[],A=S?S.elementaryStreams:T.elementaryStreams;A[o.ElementaryStreamTypes.AUDIOVIDEO]?p.push("audiovideo"):(A[o.ElementaryStreamTypes.AUDIO]&&p.push("audio"),A[o.ElementaryStreamTypes.VIDEO]&&p.push("video")),p.length===0&&s.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+T.type+" level: "+T.level+" sn: "+T.sn),this.blockBuffers(function(){var D=self.performance.now();T.stats.buffering.end=D,S&&(S.stats.buffering.end=D);var w=S?S.stats:T.stats;c.hls.trigger(i.Events.FRAG_BUFFERED,{frag:T,part:S,stats:w,id:T.type})},p)},E.onFragChanged=function(l,g){this.flushBackBuffer()},E.onBufferEos=function(l,g){var c=this;this.getSourceBufferTypes().reduce(function(T,S){var p=c.sourceBuffer[S];return g.type&&g.type!==S||p&&!p.ended&&(p.ended=!0,s.logger.log("[buffer-controller]: "+S+" sourceBuffer now EOS")),T&&!(p&&!p.ended)},!0)&&this.blockBuffers(function(){var T=c.mediaSource;T&&T.readyState==="open"&&T.endOfStream()})},E.onLevelUpdated=function(l,g){var c=g.details;c.fragments.length&&(this.details=c,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},E.flushBackBuffer=function(){var l=this.hls,g=this.details,c=this.media,T=this.sourceBuffer;if(c&&g!==null){var S=this.getSourceBufferTypes();if(S.length){var p=g.live&&l.config.liveBackBufferLength!==null?l.config.liveBackBufferLength:l.config.backBufferLength;if(Object(n.isFiniteNumber)(p)&&!(p<0)){var A=c.currentTime,D=g.levelTargetDuration,w=Math.max(p,D),k=Math.floor(A/D)*D-w;S.forEach(function(h){var v=T[h];if(v){var b=d.BufferHelper.getBuffered(v);b.length>0&&k>b.start(0)&&(l.trigger(i.Events.BACK_BUFFER_REACHED,{bufferEnd:k}),g.live&&l.trigger(i.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:k}),l.trigger(i.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:k,type:h}))}})}}}},E.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&this.mediaSource.readyState==="open"){var l=this.details,g=this.hls,c=this.media,T=this.mediaSource,S=l.fragments[0].start+l.totalduration,p=c.duration,A=Object(n.isFiniteNumber)(T.duration)?T.duration:0;l.live&&g.config.liveDurationInfinity?(s.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),T.duration=1/0,this.updateSeekableRange(l)):(S>A&&S>p||!Object(n.isFiniteNumber)(p))&&(s.logger.log("[buffer-controller]: Updating Media Source duration to "+S.toFixed(3)),T.duration=S)}},E.updateSeekableRange=function(l){var g=this.mediaSource,c=l.fragments;if(c.length&&l.live&&g!=null&&g.setLiveSeekableRange){var T=Math.max(0,c[0].start),S=Math.max(T,T+l.totalduration);g.setLiveSeekableRange(T,S)}},E.checkPendingTracks=function(){var l=this.bufferCodecEventsExpected,g=this.operationQueue,c=this.pendingTracks,T=Object.keys(c).length;if(T&&!l||T===2){this.createSourceBuffers(c),this.pendingTracks={};var S=this.getSourceBufferTypes();if(S.length===0)return void this.hls.trigger(i.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});S.forEach(function(p){g.executeNext(p)})}},E.createSourceBuffers=function(l){var g=this.sourceBuffer,c=this.mediaSource;if(!c)throw Error("createSourceBuffers called when mediaSource was null");var T=0;for(var S in l)if(!g[S]){var p=l[S];if(!p)throw Error("source buffer exists for track "+S+", however track does not");var A=p.levelCodec||p.codec,D=p.container+";codecs="+A;s.logger.log("[buffer-controller]: creating sourceBuffer("+D+")");try{var w=g[S]=c.addSourceBuffer(D),k=S;this.addBufferListener(k,"updatestart",this._onSBUpdateStart),this.addBufferListener(k,"updateend",this._onSBUpdateEnd),this.addBufferListener(k,"error",this._onSBUpdateError),this.tracks[S]={buffer:w,codec:A,container:p.container,levelCodec:p.levelCodec,id:p.id},T++}catch(h){s.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+h.message),this.hls.trigger(i.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,mimeType:D})}}T&&this.hls.trigger(i.Events.BUFFER_CREATED,{tracks:this.tracks})},E._onSBUpdateStart=function(l){this.operationQueue.current(l).onStart()},E._onSBUpdateEnd=function(l){var g=this.operationQueue;g.current(l).onComplete(),g.shiftAndExecuteNext(l)},E._onSBUpdateError=function(l,g){s.logger.error("[buffer-controller]: "+l+" SourceBuffer error",g),this.hls.trigger(i.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var c=this.operationQueue.current(l);c&&c.onError(g)},E.removeExecutor=function(l,g,c){var T=this.media,S=this.mediaSource,p=this.operationQueue,A=this.sourceBuffer[l];if(!T||!S||!A)return s.logger.warn("[buffer-controller]: Attempting to remove from the "+l+" SourceBuffer, but it does not exist"),void p.shiftAndExecuteNext(l);var D=Object(n.isFiniteNumber)(T.duration)?T.duration:1/0,w=Object(n.isFiniteNumber)(S.duration)?S.duration:1/0,k=Math.max(0,g),h=Math.min(c,D,w);h>k?(s.logger.log("[buffer-controller]: Removing ["+k+","+h+"] from the "+l+" SourceBuffer"),console.assert(!A.updating,l+" sourceBuffer must not be updating"),A.remove(k,h)):p.shiftAndExecuteNext(l)},E.appendExecutor=function(l,g){var c=this.operationQueue,T=this.sourceBuffer[g];if(!T)return s.logger.warn("[buffer-controller]: Attempting to append to the "+g+" SourceBuffer, but it does not exist"),void c.shiftAndExecuteNext(g);T.ended=!1,console.assert(!T.updating,g+" sourceBuffer must not be updating"),T.appendBuffer(l)},E.blockBuffers=function(l,g){var c=this;if(g===void 0&&(g=this.getSourceBufferTypes()),!g.length)return s.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve(l);var T=this.operationQueue,S=g.map(function(p){return T.appendBlocker(p)});Promise.all(S).then(function(){l(),g.forEach(function(p){var A=c.sourceBuffer[p];A&&A.updating||T.shiftAndExecuteNext(p)})})},E.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},E.addBufferListener=function(l,g,c){var T=this.sourceBuffer[l];if(T){var S=c.bind(this,l);this.listeners[l].push({event:g,listener:S}),T.addEventListener(g,S)}},E.removeBufferListeners=function(l){var g=this.sourceBuffer[l];g&&this.listeners[l].forEach(function(c){g.removeEventListener(c.event,c.listener)})},_}()},"./src/controller/buffer-operation-queue.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return i});var n=r("./src/utils/logger.ts"),i=function(){function s(d){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=d}var a=s.prototype;return a.append=function(d,u){var o=this.queues[u];o.push(d),o.length===1&&this.buffers[u]&&this.executeNext(u)},a.insertAbort=function(d,u){this.queues[u].unshift(d),this.executeNext(u)},a.appendBlocker=function(d){var u,o=new Promise(function(m){u=m}),y={execute:u,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(y,d),o},a.executeNext=function(d){var u=this.buffers,o=this.queues,y=u[d],m=o[d];if(m.length){var f=m[0];try{f.execute()}catch(L){n.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),f.onError(L),y&&y.updating||(m.shift(),this.executeNext(d))}}},a.shiftAndExecuteNext=function(d){this.queues[d].shift(),this.executeNext(d)},a.current=function(d){return this.queues[d][0]},s}()},"./src/controller/cap-level-controller.ts":function(t,e,r){r.r(e);var n=r("./src/events.ts");function i(a,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(a,o.key,o)}}var s=function(){function a(m){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=m,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var d,u,o,y=a.prototype;return y.setStreamController=function(m){this.streamController=m},y.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},y.registerListeners=function(){var m=this.hls;m.on(n.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),m.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),m.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),m.on(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),m.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},y.unregisterListener=function(){var m=this.hls;m.off(n.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),m.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),m.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),m.off(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),m.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},y.onFpsDropLevelCapping=function(m,f){a.isLevelAllowed(f.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(f.droppedLevel)},y.onMediaAttaching=function(m,f){this.media=f.media instanceof HTMLVideoElement?f.media:null},y.onManifestParsed=function(m,f){var L=this.hls;this.restrictedLevels=[],this.firstLevel=f.firstLevel,L.config.capLevelToPlayerSize&&f.video&&this.startCapping()},y.onBufferCodecs=function(m,f){this.hls.config.capLevelToPlayerSize&&f.video&&this.startCapping()},y.onMediaDetaching=function(){this.stopCapping()},y.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var m=this.hls.levels;if(m.length){var f=this.hls;f.autoLevelCapping=this.getMaxLevel(m.length-1),f.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=f.autoLevelCapping}}},y.getMaxLevel=function(m){var f=this,L=this.hls.levels;if(!L.length)return-1;var _=L.filter(function(E,l){return a.isLevelAllowed(l,f.restrictedLevels)&&l<=m});return this.clientRect=null,a.getMaxLevelByMediaSize(_,this.mediaWidth,this.mediaHeight)},y.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},y.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},y.getDimensions=function(){if(this.clientRect)return this.clientRect;var m=this.media,f={width:0,height:0};if(m){var L=m.getBoundingClientRect();f.width=L.width,f.height=L.height,f.width||f.height||(f.width=L.right-L.left||m.width||0,f.height=L.bottom-L.top||m.height||0)}return this.clientRect=f,f},a.isLevelAllowed=function(m,f){return f===void 0&&(f=[]),f.indexOf(m)===-1},a.getMaxLevelByMediaSize=function(m,f,L){if(!m||!m.length)return-1;for(var _,E,l=m.length-1,g=0;g<m.length;g+=1){var c=m[g];if((c.width>=f||c.height>=L)&&(_=c,!(E=m[g+1])||_.width!==E.width||_.height!==E.height)){l=g;break}}return l},d=a,o=[{key:"contentScaleFactor",get:function(){var m=1;try{m=self.devicePixelRatio}catch{}return m}}],(u=[{key:"mediaWidth",get:function(){return this.getDimensions().width*a.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*a.contentScaleFactor}}])&&i(d.prototype,u),o&&i(d,o),a}();e.default=s},"./src/controller/eme-controller.ts":function(t,e,r){r.r(e);var n=r("./src/events.ts"),i=r("./src/errors.ts"),s=r("./src/utils/logger.ts"),a=r("./src/utils/mediakeys-helper.ts");function d(o,y){for(var m=0;m<y.length;m++){var f=y[m];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(o,f.key,f)}}var u=function(){function o(L){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=L,this._config=L.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var y,m,f=o.prototype;return f.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},f._registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this)},f._unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this)},f.getLicenseServerUrl=function(L){switch(L){case a.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+L+'"')},f._attemptKeySystemAccess=function(L,_,E){var l=this,g=function(T,S,p,A){switch(T){case a.KeySystems.WIDEVINE:return function(D,w,k){var h={audioCapabilities:[],videoCapabilities:[]};return D.forEach(function(v){h.audioCapabilities.push({contentType:'audio/mp4; codecs="'+v+'"',robustness:k.audioRobustness||""})}),w.forEach(function(v){h.videoCapabilities.push({contentType:'video/mp4; codecs="'+v+'"',robustness:k.videoRobustness||""})}),[h]}(S,p,A);default:throw new Error("Unknown key-system: "+T)}}(L,_,E,this._drmSystemOptions);s.logger.log("Requesting encrypted media key-system access");var c=this.requestMediaKeySystemAccess(L,g);this.mediaKeysPromise=c.then(function(T){return l._onMediaKeySystemAccessObtained(L,T)}),c.catch(function(T){s.logger.error('Failed to obtain key-system "'+L+'" access:',T)})},f._onMediaKeySystemAccessObtained=function(L,_){var E=this;s.logger.log('Access for key-system "'+L+'" obtained');var l={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:_,mediaKeySystemDomain:L};this._mediaKeysList.push(l);var g=Promise.resolve().then(function(){return _.createMediaKeys()}).then(function(c){return l.mediaKeys=c,s.logger.log('Media-keys created for key-system "'+L+'"'),E._onMediaKeysCreated(),c});return g.catch(function(c){s.logger.error("Failed to create media-keys:",c)}),g},f._onMediaKeysCreated=function(){var L=this;this._mediaKeysList.forEach(function(_){_.mediaKeysSession||(_.mediaKeysSession=_.mediaKeys.createSession(),L._onNewMediaKeySession(_.mediaKeysSession))})},f._onNewMediaKeySession=function(L){var _=this;s.logger.log("New key-system session "+L.sessionId),L.addEventListener("message",function(E){_._onKeySessionMessage(L,E.message)},!1)},f._onKeySessionMessage=function(L,_){s.logger.log("Got EME message event, creating license request"),this._requestLicense(_,function(E){s.logger.log("Received license data (length: "+(E&&E.byteLength)+"), updating key-session"),L.update(E)})},f.onMediaEncrypted=function(L){var _=this;if(s.logger.log('Media is encrypted using "'+L.initDataType+'" init data type'),!this.mediaKeysPromise)return s.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var E=function(l){_._media&&(_._attemptSetMediaKeys(l),_._generateRequestWithPreferredKeySession(L.initDataType,L.initData))};this.mediaKeysPromise.then(E).catch(E)},f._attemptSetMediaKeys=function(L){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var _=this._mediaKeysList[0];if(!_||!_.mediaKeys)return s.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});s.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(_.mediaKeys),this._hasSetMediaKeys=!0}},f._generateRequestWithPreferredKeySession=function(L,_){var E=this,l=this._mediaKeysList[0];if(!l)return s.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(l.mediaKeysSessionInitialized)s.logger.warn("Key-Session already initialized but requested again");else{var g=l.mediaKeysSession;if(!g)return s.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!_)return s.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});s.logger.log('Generating key-session request for "'+L+'" init data type'),l.mediaKeysSessionInitialized=!0,g.generateRequest(L,_).then(function(){s.logger.debug("Key-session generation succeeded")}).catch(function(c){s.logger.error("Error generating key-session request:",c),E.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},f._createLicenseXhr=function(L,_,E){var l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,l,L,_,E);var g=this._licenseXhrSetup;if(g)try{g.call(this.hls,l,L),g=void 0}catch(c){s.logger.error(c)}try{l.readyState||l.open("POST",L,!0),g&&g.call(this.hls,l,L)}catch(c){throw new Error("issue setting up KeySystem license XHR "+c)}return l},f._onLicenseRequestReadyStageChange=function(L,_,E,l){switch(L.readyState){case 4:if(L.status===200){this._requestLicenseFailureCount=0,s.logger.log("License request succeeded");var g=L.response,c=this._licenseResponseCallback;if(c)try{g=c.call(this.hls,L,_)}catch(S){s.logger.error(S)}l(g)}else{if(s.logger.error("License Request XHR failed ("+_+"). Status: "+L.status+" ("+L.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var T=3-this._requestLicenseFailureCount+1;s.logger.warn("Retrying license request, "+T+" attempts left"),this._requestLicense(E,l)}}},f._generateLicenseRequestChallenge=function(L,_){switch(L.mediaKeySystemDomain){case a.KeySystems.WIDEVINE:return _}throw new Error("unsupported key-system: "+L.mediaKeySystemDomain)},f._requestLicense=function(L,_){s.logger.log("Requesting content license for key-system");var E=this._mediaKeysList[0];if(!E)return s.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var l=this.getLicenseServerUrl(E.mediaKeySystemDomain),g=this._createLicenseXhr(l,L,_);s.logger.log("Sending license request to URL: "+l);var c=this._generateLicenseRequestChallenge(E,L);g.send(c)}catch(T){s.logger.error("Failure requesting DRM license: "+T),this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},f.onMediaAttached=function(L,_){if(this._emeEnabled){var E=_.media;this._media=E,E.addEventListener("encrypted",this._onMediaEncrypted)}},f.onMediaDetached=function(){var L=this._media,_=this._mediaKeysList;L&&(L.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(_.map(function(E){if(E.mediaKeysSession)return E.mediaKeysSession.close().catch(function(){})})).then(function(){return L.setMediaKeys(null)}).catch(function(){}))},f.onManifestParsed=function(L,_){if(this._emeEnabled){var E=_.levels.map(function(g){return g.audioCodec}).filter(function(g){return!!g}),l=_.levels.map(function(g){return g.videoCodec}).filter(function(g){return!!g});this._attemptKeySystemAccess(a.KeySystems.WIDEVINE,E,l)}},y=o,(m=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&d(y.prototype,m),o}();e.default=u},"./src/controller/fps-controller.ts":function(t,e,r){r.r(e);var n=r("./src/events.ts"),i=r("./src/utils/logger.ts"),s=function(){function a(u){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=u,this.registerListeners()}var d=a.prototype;return d.setStreamController=function(u){this.streamController=u},d.registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},d.unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching)},d.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},d.onMediaAttaching=function(u,o){var y=this.hls.config;if(y.capLevelOnFPSDrop){var m=o.media instanceof self.HTMLVideoElement?o.media:null;this.media=m,m&&typeof m.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),y.fpsDroppedMonitoringPeriod)}},d.checkFPS=function(u,o,y){var m=performance.now();if(o){if(this.lastTime){var f=m-this.lastTime,L=y-this.lastDroppedFrames,_=o-this.lastDecodedFrames,E=1e3*L/f,l=this.hls;if(l.trigger(n.Events.FPS_DROP,{currentDropped:L,currentDecoded:_,totalDroppedFrames:y}),E>0&&L>l.config.fpsDroppedMonitoringThreshold*_){var g=l.currentLevel;i.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+g),g>0&&(l.autoLevelCapping===-1||l.autoLevelCapping>=g)&&(g-=1,l.trigger(n.Events.FPS_DROP_LEVEL_CAPPING,{level:g,droppedLevel:l.currentLevel}),l.autoLevelCapping=g,this.streamController.nextLevelSwitch())}}this.lastTime=m,this.lastDroppedFrames=y,this.lastDecodedFrames=o}},d.checkFPSInterval=function(){var u=this.media;if(u)if(this.isVideoPlaybackQualityAvailable){var o=u.getVideoPlaybackQuality();this.checkFPS(u,o.totalVideoFrames,o.droppedVideoFrames)}else this.checkFPS(u,u.webkitDecodedFrameCount,u.webkitDroppedFrameCount)},a}();e.default=s},"./src/controller/fragment-finders.ts":function(t,e,r){r.r(e),r.d(e,"findFragmentByPDT",function(){return s}),r.d(e,"findFragmentByPTS",function(){return a}),r.d(e,"fragmentWithinToleranceTest",function(){return d}),r.d(e,"pdtWithinToleranceTest",function(){return u}),r.d(e,"findFragWithCC",function(){return o});var n=r("./src/polyfills/number.ts"),i=r("./src/utils/binary-search.ts");function s(y,m,f){if(m===null||!Array.isArray(y)||!y.length||!Object(n.isFiniteNumber)(m)||m<(y[0].programDateTime||0)||m>=(y[y.length-1].endProgramDateTime||0))return null;f=f||0;for(var L=0;L<y.length;++L){var _=y[L];if(u(m,f,_))return _}return null}function a(y,m,f,L){f===void 0&&(f=0),L===void 0&&(L=0);var _=null;if(y?_=m[y.sn-m[0].sn+1]||null:f===0&&m[0].start===0&&(_=m[0]),_&&d(f,L,_)===0)return _;var E=i.default.search(m,d.bind(null,f,L));return E||_}function d(y,m,f){y===void 0&&(y=0),m===void 0&&(m=0);var L=Math.min(m,f.duration+(f.deltaPTS?f.deltaPTS:0));return f.start+f.duration-L<=y?1:f.start-L>y&&f.start?-1:0}function u(y,m,f){var L=1e3*Math.min(m,f.duration+(f.deltaPTS?f.deltaPTS:0));return(f.endProgramDateTime||0)-L>y}function o(y,m){return i.default.search(y,function(f){return f.cc<m?1:f.cc>m?-1:0})}},"./src/controller/fragment-tracker.ts":function(t,e,r){r.r(e),r.d(e,"FragmentState",function(){return n}),r.d(e,"FragmentTracker",function(){return d});var n,i,s=r("./src/events.ts"),a=r("./src/types/loader.ts");(i=n||(n={})).NOT_LOADED="NOT_LOADED",i.BACKTRACKED="BACKTRACKED",i.APPENDING="APPENDING",i.PARTIAL="PARTIAL",i.OK="OK";var d=function(){function y(f){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=f,this._registerListeners()}var m=y.prototype;return m._registerListeners=function(){var f=this.hls;f.on(s.Events.BUFFER_APPENDED,this.onBufferAppended,this),f.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),f.on(s.Events.FRAG_LOADED,this.onFragLoaded,this)},m._unregisterListeners=function(){var f=this.hls;f.off(s.Events.BUFFER_APPENDED,this.onBufferAppended,this),f.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),f.off(s.Events.FRAG_LOADED,this.onFragLoaded,this)},m.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},m.getAppendedFrag=function(f,L){if(L===a.PlaylistLevelType.MAIN){var _=this.activeFragment,E=this.activeParts;if(!_)return null;if(E)for(var l=E.length;l--;){var g=E[l],c=g?g.end:_.appendedPTS;if(g.start<=f&&c!==void 0&&f<=c)return l>9&&(this.activeParts=E.slice(l-9)),g}else if(_.start<=f&&_.appendedPTS!==void 0&&f<=_.appendedPTS)return _}return this.getBufferedFrag(f,L)},m.getBufferedFrag=function(f,L){for(var _=this.fragments,E=Object.keys(_),l=E.length;l--;){var g=_[E[l]];if((g==null?void 0:g.body.type)===L&&g.buffered){var c=g.body;if(c.start<=f&&f<=c.end)return c}}return null},m.detectEvictedFragments=function(f,L,_){var E=this;Object.keys(this.fragments).forEach(function(l){var g=E.fragments[l];if(g)if(g.buffered){var c=g.range[f];c&&c.time.some(function(T){var S=!E.isTimeBuffered(T.startPTS,T.endPTS,L);return S&&E.removeFragment(g.body),S})}else g.body.type===_&&E.removeFragment(g.body)})},m.detectPartialFragments=function(f){var L=this,_=this.timeRanges,E=f.frag,l=f.part;if(_&&E.sn!=="initSegment"){var g=o(E),c=this.fragments[g];c&&(Object.keys(_).forEach(function(T){var S=E.elementaryStreams[T];if(S){var p=_[T],A=l!==null||S.partial===!0;c.range[T]=L.getBufferedTimes(E,l,A,p)}}),c.backtrack=c.loaded=null,Object.keys(c.range).length?c.buffered=!0:this.removeFragment(c.body))}},m.fragBuffered=function(f){var L=o(f),_=this.fragments[L];_&&(_.backtrack=_.loaded=null,_.buffered=!0)},m.getBufferedTimes=function(f,L,_,E){for(var l={time:[],partial:_},g=L?L.start:f.start,c=L?L.end:f.end,T=f.minEndPTS||c,S=f.maxStartPTS||g,p=0;p<E.length;p++){var A=E.start(p)-this.bufferPadding,D=E.end(p)+this.bufferPadding;if(S>=A&&T<=D){l.time.push({startPTS:Math.max(g,E.start(p)),endPTS:Math.min(c,E.end(p))});break}if(g<D&&c>A)l.partial=!0,l.time.push({startPTS:Math.max(g,E.start(p)),endPTS:Math.min(c,E.end(p))});else if(c<=A)break}return l},m.getPartialFragment=function(f){var L,_,E,l=null,g=0,c=this.bufferPadding,T=this.fragments;return Object.keys(T).forEach(function(S){var p=T[S];p&&u(p)&&(_=p.body.start-c,E=p.body.end+c,f>=_&&f<=E&&(L=Math.min(f-_,E-f),g<=L&&(l=p.body,g=L)))}),l},m.getState=function(f){var L=o(f),_=this.fragments[L];return _?_.buffered?u(_)?n.PARTIAL:n.OK:_.backtrack?n.BACKTRACKED:n.APPENDING:n.NOT_LOADED},m.backtrack=function(f,L){var _=o(f),E=this.fragments[_];if(!E||E.backtrack)return null;var l=E.backtrack=L||E.loaded;return E.loaded=null,l},m.getBacktrackData=function(f){var L=o(f),_=this.fragments[L];if(_){var E,l=_.backtrack;if(l!=null&&(E=l.payload)!==null&&E!==void 0&&E.byteLength)return l;this.removeFragment(f)}return null},m.isTimeBuffered=function(f,L,_){for(var E,l,g=0;g<_.length;g++){if(E=_.start(g)-this.bufferPadding,l=_.end(g)+this.bufferPadding,f>=E&&L<=l)return!0;if(L<=E)return!1}return!1},m.onFragLoaded=function(f,L){var _=L.frag,E=L.part;if(_.sn!=="initSegment"&&!_.bitrateTest&&!E){var l=o(_);this.fragments[l]={body:_,loaded:L,backtrack:null,buffered:!1,range:Object.create(null)}}},m.onBufferAppended=function(f,L){var _=this,E=L.frag,l=L.part,g=L.timeRanges;if(E.type===a.PlaylistLevelType.MAIN)if(this.activeFragment=E,l){var c=this.activeParts;c||(this.activeParts=c=[]),c.push(l)}else this.activeParts=null;this.timeRanges=g,Object.keys(g).forEach(function(T){var S=g[T];if(_.detectEvictedFragments(T,S),!l)for(var p=0;p<S.length;p++)E.appendedPTS=Math.max(S.end(p),E.appendedPTS||0)})},m.onFragBuffered=function(f,L){this.detectPartialFragments(L)},m.hasFragment=function(f){var L=o(f);return!!this.fragments[L]},m.removeFragmentsInRange=function(f,L,_){var E=this;Object.keys(this.fragments).forEach(function(l){var g=E.fragments[l];if(g&&g.buffered){var c=g.body;c.type===_&&c.start<L&&c.end>f&&E.removeFragment(c)}})},m.removeFragment=function(f){var L=o(f);f.stats.loaded=0,f.clearElementaryStreamInfo(),delete this.fragments[L]},m.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},y}();function u(y){var m,f;return y.buffered&&(((m=y.range.video)===null||m===void 0?void 0:m.partial)||((f=y.range.audio)===null||f===void 0?void 0:f.partial))}function o(y){return y.type+"_"+y.level+"_"+y.urlId+"_"+y.sn}},"./src/controller/gap-controller.ts":function(t,e,r){r.r(e),r.d(e,"STALL_MINIMUM_DURATION_MS",function(){return d}),r.d(e,"MAX_START_GAP_JUMP",function(){return u}),r.d(e,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return o}),r.d(e,"SKIP_BUFFER_RANGE_START",function(){return y}),r.d(e,"default",function(){return m});var n=r("./src/utils/buffer-helper.ts"),i=r("./src/errors.ts"),s=r("./src/events.ts"),a=r("./src/utils/logger.ts"),d=250,u=2,o=.1,y=.05,m=function(){function f(_,E,l,g){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=_,this.media=E,this.fragmentTracker=l,this.hls=g}var L=f.prototype;return L.destroy=function(){this.hls=this.fragmentTracker=this.media=null},L.poll=function(_){var E=this.config,l=this.media,g=this.stalled,c=l.currentTime,T=l.seeking,S=this.seeking&&!T,p=!this.seeking&&T;if(this.seeking=T,c===_){if((p||S)&&(this.stalled=null),!l.paused&&!l.ended&&l.playbackRate!==0&&n.BufferHelper.getBuffered(l).length){var A=n.BufferHelper.bufferInfo(l,c,0),D=A.len>0,w=A.nextStart||0;if(D||w){if(T){var k=A.len>u,h=!w||w-c>u&&!this.fragmentTracker.getPartialFragment(c);if(k||h)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var v,b=Math.max(w,A.start||0)-c,R=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,I=!(R==null||(v=R.details)===null||v===void 0)&&v.live?2*R.details.targetduration:u;if(b>0&&b<=I)return void this._trySkipBufferHole(null)}var C=self.performance.now();if(g!==null){var x=C-g;!T&&x>=d&&this._reportStall(A.len);var O=n.BufferHelper.bufferInfo(l,c,E.maxBufferHole);this._tryFixBufferStall(O,x)}else this.stalled=C}}}else if(this.moved=!0,g!==null){if(this.stallReported){var P=self.performance.now()-g;a.logger.warn("playback not stuck anymore @"+c+", after "+Math.round(P)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},L._tryFixBufferStall=function(_,E){var l=this.config,g=this.fragmentTracker,c=this.media.currentTime,T=g.getPartialFragment(c);T&&this._trySkipBufferHole(T)||_.len>l.maxBufferHole&&E>1e3*l.highBufferWatchdogPeriod&&(a.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},L._reportStall=function(_){var E=this.hls,l=this.media;this.stallReported||(this.stallReported=!0,a.logger.warn("Playback stalling at @"+l.currentTime+" due to low buffer (buffer="+_+")"),E.trigger(s.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:_}))},L._trySkipBufferHole=function(_){for(var E=this.config,l=this.hls,g=this.media,c=g.currentTime,T=0,S=n.BufferHelper.getBuffered(g),p=0;p<S.length;p++){var A=S.start(p);if(c+E.maxBufferHole>=T&&c<A){var D=Math.max(A+y,g.currentTime+o);return a.logger.warn("skipping hole, adjusting currentTime from "+c+" to "+D),this.moved=!0,this.stalled=null,g.currentTime=D,_&&l.trigger(s.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+c+" to "+D,frag:_}),D}T=S.end(p)}return 0},L._tryNudgeBuffer=function(){var _=this.config,E=this.hls,l=this.media,g=l.currentTime,c=(this.nudgeRetry||0)+1;if(this.nudgeRetry=c,c<_.nudgeMaxRetry){var T=g+c*_.nudgeOffset;a.logger.warn("Nudging 'currentTime' from "+g+" to "+T),l.currentTime=T,E.trigger(s.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else a.logger.error("Playhead still not moving while enough data buffered @"+g+" after "+_.nudgeMaxRetry+" nudges"),E.trigger(s.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},f}()},"./src/controller/id3-track-controller.ts":function(t,e,r){r.r(e);var n=r("./src/events.ts"),i=r("./src/utils/texttrack-utils.ts"),s=r("./src/demux/id3.ts"),a=function(){function d(o){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=o,this._registerListeners()}var u=d.prototype;return u.destroy=function(){this._unregisterListeners()},u._registerListeners=function(){var o=this.hls;o.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(n.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),o.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u._unregisterListeners=function(){var o=this.hls;o.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(n.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),o.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u.onMediaAttached=function(o,y){this.media=y.media},u.onMediaDetaching=function(){this.id3Track&&(Object(i.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},u.getID3Track=function(o){if(this.media){for(var y=0;y<o.length;y++){var m=o[y];if(m.kind==="metadata"&&m.label==="id3")return Object(i.sendAddTrackEvent)(m,this.media),m}return this.media.addTextTrack("metadata","id3")}},u.onFragParsingMetadata=function(o,y){if(this.media){var m=y.frag,f=y.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var L=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,_=0;_<f.length;_++){var E=s.getID3Frames(f[_].data);if(E){var l=f[_].pts,g=_<f.length-1?f[_+1].pts:m.end;g-l<=0&&(g=l+.25);for(var c=0;c<E.length;c++){var T=E[c];if(!s.isTimeStampFrame(T)){var S=new L(l,g,"");S.value=T,this.id3Track.addCue(S)}}}}}},u.onBufferFlushing=function(o,y){var m=y.startOffset,f=y.endOffset,L=y.type;if(!L||L==="audio"){var _=this.id3Track;_&&Object(i.removeCuesInRange)(_,m,f)}},d}();e.default=a},"./src/controller/latency-controller.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return d});var n=r("./src/errors.ts"),i=r("./src/events.ts"),s=r("./src/utils/logger.ts");function a(u,o){for(var y=0;y<o.length;y++){var m=o[y];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(u,m.key,m)}}var d=function(){function u(f){var L=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return L.timeupdate()},this.hls=f,this.config=f.config,this.registerListeners()}var o,y,m=u.prototype;return m.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},m.registerListeners=function(){this.hls.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(i.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(i.Events.ERROR,this.onError,this)},m.unregisterListeners=function(){this.hls.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(i.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(i.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(i.Events.ERROR,this.onError)},m.onMediaAttached=function(f,L){this.media=L.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},m.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},m.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},m.onLevelUpdated=function(f,L){var _=L.details;this.levelDetails=_,_.advanced&&this.timeupdate(),!_.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},m.onError=function(f,L){L.details===n.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,s.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},m.timeupdate=function(){var f=this.media,L=this.levelDetails;if(f&&L){this.currentTime=f.currentTime;var _=this.computeLatency();if(_!==null){this._latency=_;var E=this.config,l=E.lowLatencyMode,g=E.maxLiveSyncPlaybackRate;if(l&&g!==1){var c=this.targetLatency;if(c!==null){var T=_-c,S=T<Math.min(this.maxLatency,c+L.targetduration);if(L.live&&S&&T>.05&&this.forwardBufferLength>1){var p=Math.min(2,Math.max(1,g)),A=Math.round(2/(1+Math.exp(-.75*T-this.edgeStalled))*20)/20;f.playbackRate=Math.min(p,Math.max(1,A))}else f.playbackRate!==1&&f.playbackRate!==0&&(f.playbackRate=1)}}}}},m.estimateLiveEdge=function(){var f=this.levelDetails;return f===null?null:f.edge+f.age},m.computeLatency=function(){var f=this.estimateLiveEdge();return f===null?null:f-this.currentTime},o=u,(y=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var f=this.config,L=this.levelDetails;return f.liveMaxLatencyDuration!==void 0?f.liveMaxLatencyDuration:L?f.liveMaxLatencyDurationCount*L.targetduration:0}},{key:"targetLatency",get:function(){var f=this.levelDetails;if(f===null)return null;var L=f.holdBack,_=f.partHoldBack,E=f.targetduration,l=this.config,g=l.liveSyncDuration,c=l.liveSyncDurationCount,T=l.lowLatencyMode,S=this.hls.userConfig,p=T&&_||L;(S.liveSyncDuration||S.liveSyncDurationCount||p===0)&&(p=g!==void 0?g:c*E);var A=E;return p+Math.min(1*this.stallCount,A)}},{key:"liveSyncPosition",get:function(){var f=this.estimateLiveEdge(),L=this.targetLatency,_=this.levelDetails;if(f===null||L===null||_===null)return null;var E=_.edge,l=f-L-this.edgeStalled,g=E-_.totalduration,c=E-(this.config.lowLatencyMode&&_.partTarget||_.targetduration);return Math.min(Math.max(g,l),c)}},{key:"drift",get:function(){var f=this.levelDetails;return f===null?1:f.drift}},{key:"edgeStalled",get:function(){var f=this.levelDetails;if(f===null)return 0;var L=3*(this.config.lowLatencyMode&&f.partTarget||f.targetduration);return Math.max(f.age-L,0)}},{key:"forwardBufferLength",get:function(){var f=this.media,L=this.levelDetails;if(!f||!L)return 0;var _=f.buffered.length;return _?f.buffered.end(_-1):L.edge-this.currentTime}}])&&a(o.prototype,y),u}()},"./src/controller/level-controller.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return _});var n=r("./src/types/level.ts"),i=r("./src/events.ts"),s=r("./src/errors.ts"),a=r("./src/utils/codecs.ts"),d=r("./src/controller/level-helper.ts"),u=r("./src/controller/base-playlist-controller.ts"),o=r("./src/types/loader.ts");function y(){return(y=Object.assign||function(E){for(var l=1;l<arguments.length;l++){var g=arguments[l];for(var c in g)Object.prototype.hasOwnProperty.call(g,c)&&(E[c]=g[c])}return E}).apply(this,arguments)}function m(E,l){for(var g=0;g<l.length;g++){var c=l[g];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(E,c.key,c)}}function f(E,l){return(f=Object.setPrototypeOf||function(g,c){return g.__proto__=c,g})(E,l)}var L=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),_=function(E){var l,g;function c(A){var D;return(D=E.call(this,A,"[level-controller]")||this)._levels=[],D._firstLevel=-1,D._startLevel=void 0,D.currentLevelIndex=-1,D.manualLevelIndex=-1,D.onParsedComplete=void 0,D._registerListeners(),D}g=E,(l=c).prototype=Object.create(g.prototype),l.prototype.constructor=l,f(l,g);var T,S,p=c.prototype;return p._registerListeners=function(){var A=this.hls;A.on(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),A.on(i.Events.LEVEL_LOADED,this.onLevelLoaded,this),A.on(i.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),A.on(i.Events.FRAG_LOADED,this.onFragLoaded,this),A.on(i.Events.ERROR,this.onError,this)},p._unregisterListeners=function(){var A=this.hls;A.off(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),A.off(i.Events.LEVEL_LOADED,this.onLevelLoaded,this),A.off(i.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),A.off(i.Events.FRAG_LOADED,this.onFragLoaded,this),A.off(i.Events.ERROR,this.onError,this)},p.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,E.prototype.destroy.call(this)},p.startLoad=function(){this._levels.forEach(function(A){A.loadError=0}),E.prototype.startLoad.call(this)},p.onManifestLoaded=function(A,D){var w,k,h=[],v=[],b=[],R={},I=!1,C=!1,x=!1;if(D.levels.forEach(function(F){var B=F.attrs;I=I||!(!F.width||!F.height),C=C||!!F.videoCodec,x=x||!!F.audioCodec,L&&F.audioCodec&&F.audioCodec.indexOf("mp4a.40.34")!==-1&&(F.audioCodec=void 0);var j=F.bitrate+"-"+F.attrs.RESOLUTION+"-"+F.attrs.CODECS;(k=R[j])?k.url.push(F.url):(k=new n.Level(F),R[j]=k,h.push(k)),B&&(B.AUDIO&&Object(d.addGroupId)(k,"audio",B.AUDIO),B.SUBTITLES&&Object(d.addGroupId)(k,"text",B.SUBTITLES))}),(I||C)&&x&&(h=h.filter(function(F){var B=F.videoCodec,j=F.width,K=F.height;return!!B||!(!j||!K)})),h=h.filter(function(F){var B=F.audioCodec,j=F.videoCodec;return(!B||Object(a.isCodecSupportedInMp4)(B,"audio"))&&(!j||Object(a.isCodecSupportedInMp4)(j,"video"))}),D.audioTracks&&(v=D.audioTracks.filter(function(F){return!F.audioCodec||Object(a.isCodecSupportedInMp4)(F.audioCodec,"audio")}),Object(d.assignTrackIdsByGroup)(v)),D.subtitles&&(b=D.subtitles,Object(d.assignTrackIdsByGroup)(b)),h.length>0){w=h[0].bitrate,h.sort(function(F,B){return F.bitrate-B.bitrate}),this._levels=h;for(var O=0;O<h.length;O++)if(h[O].bitrate===w){this._firstLevel=O,this.log("manifest loaded, "+h.length+" level(s) found, first bitrate: "+w);break}var P=x&&!C,M={levels:h,audioTracks:v,subtitleTracks:b,firstLevel:this._firstLevel,stats:D.stats,audio:x,video:C,altAudio:!P&&v.some(function(F){return!!F.url})};this.hls.trigger(i.Events.MANIFEST_PARSED,M),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(i.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:D.url,reason:"no level with compatible codecs found in manifest"})},p.onError=function(A,D){if(E.prototype.onError.call(this,A,D),!D.fatal){var w=D.context,k=this._levels[this.currentLevelIndex];if(w&&(w.type===o.PlaylistContextType.AUDIO_TRACK&&k.audioGroupIds&&w.groupId===k.audioGroupIds[k.urlId]||w.type===o.PlaylistContextType.SUBTITLE_TRACK&&k.textGroupIds&&w.groupId===k.textGroupIds[k.urlId]))this.redundantFailover(this.currentLevelIndex);else{var h,v=!1,b=!0;switch(D.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:if(D.frag){var R=this._levels[D.frag.level];R?(R.fragmentError++,R.fragmentError>this.hls.config.fragLoadingMaxRetry&&(h=D.frag.level)):h=D.frag.level}break;case s.ErrorDetails.LEVEL_LOAD_ERROR:case s.ErrorDetails.LEVEL_LOAD_TIMEOUT:w&&(w.deliveryDirectives&&(b=!1),h=w.level),v=!0;break;case s.ErrorDetails.REMUX_ALLOC_ERROR:h=D.level,v=!0}h!==void 0&&this.recoverLevel(D,h,v,b)}}},p.recoverLevel=function(A,D,w,k){var h=A.details,v=this._levels[D];if(v.loadError++,w){if(!this.retryLoadingOrFail(A))return void(this.currentLevelIndex=-1);A.levelRetry=!0}if(k){var b=v.url.length;if(b>1&&v.loadError<b)A.levelRetry=!0,this.redundantFailover(D);else if(this.manualLevelIndex===-1){var R=D===0?this._levels.length-1:D-1;this.currentLevelIndex!==R&&this._levels[R].loadError===0&&(this.warn(h+": switch to "+R),A.levelRetry=!0,this.hls.nextAutoLevel=R)}}},p.redundantFailover=function(A){var D=this._levels[A],w=D.url.length;if(w>1){var k=(D.urlId+1)%w;this.warn("Switching to redundant URL-id "+k),this._levels.forEach(function(h){h.urlId=k}),this.level=A}},p.onFragLoaded=function(A,D){var w=D.frag;if(w!==void 0&&w.type===o.PlaylistLevelType.MAIN){var k=this._levels[w.level];k!==void 0&&(k.fragmentError=0,k.loadError=0)}},p.onLevelLoaded=function(A,D){var w,k,h=D.level,v=D.details,b=this._levels[h];if(!b)return this.warn("Invalid level index "+h),void((k=D.deliveryDirectives)!==null&&k!==void 0&&k.skip&&(v.deltaUpdateFailed=!0));h===this.currentLevelIndex?(b.fragmentError===0&&(b.loadError=0,this.retryCount=0),this.playlistLoaded(h,D,b.details)):(w=D.deliveryDirectives)!==null&&w!==void 0&&w.skip&&(v.deltaUpdateFailed=!0)},p.onAudioTrackSwitched=function(A,D){var w=this.hls.levels[this.currentLevelIndex];if(w&&w.audioGroupIds){for(var k=-1,h=this.hls.audioTracks[D.id].groupId,v=0;v<w.audioGroupIds.length;v++)if(w.audioGroupIds[v]===h){k=v;break}k!==w.urlId&&(w.urlId=k,this.startLoad())}},p.loadPlaylist=function(A){var D=this.currentLevelIndex,w=this._levels[D];if(this.canLoad&&w&&w.url.length>0){var k=w.urlId,h=w.url[k];if(A)try{h=A.addDirectives(h)}catch(v){this.warn("Could not construct new URL with HLS Delivery Directives: "+v)}this.log("Attempt loading level index "+D+(A?" at sn "+A.msn+" part "+A.part:"")+" with URL-id "+k+" "+h),this.clearTimer(),this.hls.trigger(i.Events.LEVEL_LOADING,{url:h,level:D,id:k,deliveryDirectives:A||null})}},p.removeLevel=function(A,D){var w=function(h,v){return v!==D},k=this._levels.filter(function(h,v){return v!==A||h.url.length>1&&D!==void 0&&(h.url=h.url.filter(w),h.audioGroupIds&&(h.audioGroupIds=h.audioGroupIds.filter(w)),h.textGroupIds&&(h.textGroupIds=h.textGroupIds.filter(w)),h.urlId=0,!0)}).map(function(h,v){var b=h.details;return b!=null&&b.fragments&&b.fragments.forEach(function(R){R.level=v}),h});this._levels=k,this.hls.trigger(i.Events.LEVELS_UPDATED,{levels:k})},T=c,(S=[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(A){var D,w=this._levels;if(w.length!==0&&(this.currentLevelIndex!==A||(D=w[A])===null||D===void 0||!D.details)){if(A<0||A>=w.length){var k=A<0;if(this.hls.trigger(i.Events.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.LEVEL_SWITCH_ERROR,level:A,fatal:k,reason:"invalid level idx"}),k)return;A=Math.min(A,w.length-1)}this.clearTimer();var h=this.currentLevelIndex,v=w[h],b=w[A];this.log("switching to level "+A+" from "+h),this.currentLevelIndex=A;var R=y({},b,{level:A,maxBitrate:b.maxBitrate,uri:b.uri,urlId:b.urlId});delete R._urlId,this.hls.trigger(i.Events.LEVEL_SWITCHING,R);var I=b.details;if(!I||I.live){var C=this.switchParams(b.uri,v==null?void 0:v.details);this.loadPlaylist(C)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(A){this.manualLevelIndex=A,this._startLevel===void 0&&(this._startLevel=A),A!==-1&&(this.level=A)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(A){this._firstLevel=A}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var A=this.hls.config.startLevel;return A!==void 0?A:this._firstLevel}return this._startLevel},set:function(A){this._startLevel=A}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(A){this.level=A,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=A)}}])&&m(T.prototype,S),c}(u.default)},"./src/controller/level-helper.ts":function(t,e,r){r.r(e),r.d(e,"addGroupId",function(){return s}),r.d(e,"assignTrackIdsByGroup",function(){return a}),r.d(e,"updatePTS",function(){return d}),r.d(e,"updateFragPTSDTS",function(){return o}),r.d(e,"mergeDetails",function(){return y}),r.d(e,"mapPartIntersection",function(){return m}),r.d(e,"mapFragmentIntersection",function(){return f}),r.d(e,"adjustSliding",function(){return L}),r.d(e,"addSliding",function(){return _}),r.d(e,"computeReloadInterval",function(){return E}),r.d(e,"getFragmentWithSN",function(){return l}),r.d(e,"getPartWith",function(){return g});var n=r("./src/polyfills/number.ts"),i=r("./src/utils/logger.ts");function s(c,T,S){switch(T){case"audio":c.audioGroupIds||(c.audioGroupIds=[]),c.audioGroupIds.push(S);break;case"text":c.textGroupIds||(c.textGroupIds=[]),c.textGroupIds.push(S)}}function a(c){var T={};c.forEach(function(S){var p=S.groupId||"";S.id=T[p]=T[p]||0,T[p]++})}function d(c,T,S){u(c[T],c[S])}function u(c,T){var S=T.startPTS;if(Object(n.isFiniteNumber)(S)){var p,A=0;T.sn>c.sn?(A=S-c.start,p=c):(A=c.start-S,p=T),p.duration!==A&&(p.duration=A)}else T.sn>c.sn?c.cc===T.cc&&c.minEndPTS?T.start=c.start+(c.minEndPTS-c.start):T.start=c.start+c.duration:T.start=Math.max(c.start-T.duration,0)}function o(c,T,S,p,A,D){p-S<=0&&(i.logger.warn("Fragment should have a positive duration",T),p=S+T.duration,D=A+T.duration);var w=S,k=p,h=T.startPTS,v=T.endPTS;if(Object(n.isFiniteNumber)(h)){var b=Math.abs(h-S);Object(n.isFiniteNumber)(T.deltaPTS)?T.deltaPTS=Math.max(b,T.deltaPTS):T.deltaPTS=b,w=Math.max(S,h),S=Math.min(S,h),A=Math.min(A,T.startDTS),k=Math.min(p,v),p=Math.max(p,v),D=Math.max(D,T.endDTS)}T.duration=p-S;var R=S-T.start;T.appendedPTS=p,T.start=T.startPTS=S,T.maxStartPTS=w,T.startDTS=A,T.endPTS=p,T.minEndPTS=k,T.endDTS=D;var I,C=T.sn;if(!c||C<c.startSN||C>c.endSN)return 0;var x=C-c.startSN,O=c.fragments;for(O[x]=T,I=x;I>0;I--)u(O[I],O[I-1]);for(I=x;I<O.length-1;I++)u(O[I],O[I+1]);return c.fragmentHint&&u(O[O.length-1],c.fragmentHint),c.PTSKnown=c.alignedSliding=!0,R}function y(c,T){for(var S=null,p=c.fragments,A=p.length-1;A>=0;A--){var D=p[A].initSegment;if(D){S=D;break}}c.fragmentHint&&delete c.fragmentHint.endPTS;var w,k=0;if(f(c,T,function(C,x){var O;C.relurl&&(k=C.cc-x.cc),Object(n.isFiniteNumber)(C.startPTS)&&Object(n.isFiniteNumber)(C.endPTS)&&(x.start=x.startPTS=C.startPTS,x.startDTS=C.startDTS,x.appendedPTS=C.appendedPTS,x.maxStartPTS=C.maxStartPTS,x.endPTS=C.endPTS,x.endDTS=C.endDTS,x.minEndPTS=C.minEndPTS,x.duration=C.endPTS-C.startPTS,x.duration&&(w=x),T.PTSKnown=T.alignedSliding=!0),x.elementaryStreams=C.elementaryStreams,x.loader=C.loader,x.stats=C.stats,x.urlId=C.urlId,C.initSegment?(x.initSegment=C.initSegment,S=C.initSegment):x.initSegment&&x.initSegment.relurl!=((O=S)===null||O===void 0?void 0:O.relurl)||(x.initSegment=S)}),T.skippedSegments&&(T.deltaUpdateFailed=T.fragments.some(function(C){return!C}),T.deltaUpdateFailed)){i.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var h=T.skippedSegments;h--;)T.fragments.shift();T.startSN=T.fragments[0].sn,T.startCC=T.fragments[0].cc}var v=T.fragments;if(k){i.logger.warn("discontinuity sliding from playlist, take drift into account");for(var b=0;b<v.length;b++)v[b].cc+=k}T.skippedSegments&&(T.startCC=T.fragments[0].cc),m(c.partList,T.partList,function(C,x){x.elementaryStreams=C.elementaryStreams,x.stats=C.stats}),w?o(T,w,w.startPTS,w.endPTS,w.startDTS,w.endDTS):L(c,T),v.length&&(T.totalduration=T.edge-v[0].start),T.driftStartTime=c.driftStartTime,T.driftStart=c.driftStart;var R=T.advancedDateTime;if(T.advanced&&R){var I=T.edge;T.driftStart||(T.driftStartTime=R,T.driftStart=I),T.driftEndTime=R,T.driftEnd=I}else T.driftEndTime=c.driftEndTime,T.driftEnd=c.driftEnd,T.advancedDateTime=c.advancedDateTime}function m(c,T,S){if(c&&T)for(var p=0,A=0,D=c.length;A<=D;A++){var w=c[A],k=T[A+p];w&&k&&w.index===k.index&&w.fragment.sn===k.fragment.sn?S(w,k):p--}}function f(c,T,S){for(var p=T.skippedSegments,A=Math.max(c.startSN,T.startSN)-T.startSN,D=(c.fragmentHint?1:0)+(p?T.endSN:Math.min(c.endSN,T.endSN))-T.startSN,w=T.startSN-c.startSN,k=T.fragmentHint?T.fragments.concat(T.fragmentHint):T.fragments,h=c.fragmentHint?c.fragments.concat(c.fragmentHint):c.fragments,v=A;v<=D;v++){var b=h[w+v],R=k[v];p&&!R&&v<p&&(R=T.fragments[v]=b),b&&R&&S(b,R)}}function L(c,T){var S=T.startSN+T.skippedSegments-c.startSN,p=c.fragments;S<0||S>=p.length||_(T,p[S].start)}function _(c,T){if(T){for(var S=c.fragments,p=c.skippedSegments;p<S.length;p++)S[p].start+=T;c.fragmentHint&&(c.fragmentHint.start+=T)}}function E(c,T){var S,p=1e3*c.levelTargetDuration,A=p/2,D=c.age,w=D>0&&D<3*p,k=T.loading.end-T.loading.start,h=c.availabilityDelay;if(c.updated===!1)if(w){var v=333*c.misses;S=Math.max(Math.min(A,2*k),v),c.availabilityDelay=(c.availabilityDelay||0)+S}else S=A;else w?(h=Math.min(h||p/2,D),c.availabilityDelay=h,S=h+p-D):S=p-k;return Math.round(S)}function l(c,T,S){if(!c||!c.details)return null;var p=c.details,A=p.fragments[T-p.startSN];return A||((A=p.fragmentHint)&&A.sn===T?A:T<p.startSN&&S&&S.sn===T?S:null)}function g(c,T,S){if(!c||!c.details)return null;var p=c.details.partList;if(p)for(var A=p.length;A--;){var D=p[A];if(D.index===S&&D.fragment.sn===T)return D}return null}},"./src/controller/stream-controller.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return c});var n=r("./src/polyfills/number.ts"),i=r("./src/controller/base-stream-controller.ts"),s=r("./src/is-supported.ts"),a=r("./src/events.ts"),d=r("./src/utils/buffer-helper.ts"),u=r("./src/controller/fragment-tracker.ts"),o=r("./src/types/loader.ts"),y=r("./src/loader/fragment.ts"),m=r("./src/demux/transmuxer-interface.ts"),f=r("./src/types/transmuxer.ts"),L=r("./src/controller/gap-controller.ts"),_=r("./src/errors.ts"),E=r("./src/utils/logger.ts");function l(T,S){for(var p=0;p<S.length;p++){var A=S[p];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(T,A.key,A)}}function g(T,S){return(g=Object.setPrototypeOf||function(p,A){return p.__proto__=A,p})(T,S)}var c=function(T){var S,p;function A(h,v){var b;return(b=T.call(this,h,v,"[stream-controller]")||this).audioCodecSwap=!1,b.gapController=null,b.level=-1,b._forceStartLoad=!1,b.altAudio=!1,b.audioOnly=!1,b.fragPlaying=null,b.onvplaying=null,b.onvseeked=null,b.fragLastKbps=0,b.stalled=!1,b.couldBacktrack=!1,b.audioCodecSwitch=!1,b.videoBuffer=null,b._registerListeners(),b}p=T,(S=A).prototype=Object.create(p.prototype),S.prototype.constructor=S,g(S,p);var D,w,k=A.prototype;return k._registerListeners=function(){var h=this.hls;h.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),h.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),h.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.on(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),h.on(a.Events.LEVEL_LOADING,this.onLevelLoading,this),h.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),h.on(a.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),h.on(a.Events.ERROR,this.onError,this),h.on(a.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),h.on(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),h.on(a.Events.BUFFER_CREATED,this.onBufferCreated,this),h.on(a.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),h.on(a.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),h.on(a.Events.FRAG_BUFFERED,this.onFragBuffered,this)},k._unregisterListeners=function(){var h=this.hls;h.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),h.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),h.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.off(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),h.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),h.off(a.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),h.off(a.Events.ERROR,this.onError,this),h.off(a.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),h.off(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),h.off(a.Events.BUFFER_CREATED,this.onBufferCreated,this),h.off(a.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),h.off(a.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),h.off(a.Events.FRAG_BUFFERED,this.onFragBuffered,this)},k.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},k.startLoad=function(h){if(this.levels){var v=this.lastCurrentTime,b=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var R=b.startLevel;R===-1&&(b.config.testBandwidth?(R=0,this.bitrateTest=!0):R=b.nextAutoLevel),this.level=b.nextLoadLevel=R,this.loadedmetadata=!1}v>0&&h===-1&&(this.log("Override startPosition with lastCurrentTime @"+v.toFixed(3)),h=v),this.state=i.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=h,this.tick()}else this._forceStartLoad=!0,this.state=i.State.STOPPED},k.stopLoad=function(){this._forceStartLoad=!1,T.prototype.stopLoad.call(this)},k.doTick=function(){switch(this.state){case i.State.IDLE:this.doTickIdle();break;case i.State.WAITING_LEVEL:var h,v=this.levels,b=this.level,R=v==null||(h=v[b])===null||h===void 0?void 0:h.details;if(R&&(!R.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(R))break;this.state=i.State.IDLE;break}break;case i.State.FRAG_LOADING_WAITING_RETRY:var I,C=self.performance.now(),x=this.retryDate;(!x||C>=x||(I=this.media)!==null&&I!==void 0&&I.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=i.State.IDLE)}this.onTickEnd()},k.onTickEnd=function(){T.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},k.doTickIdle=function(){var h,v,b=this.hls,R=this.levelLastLoaded,I=this.levels,C=this.media,x=b.config,O=b.nextLoadLevel;if(R!==null&&(C||!this.startFragRequested&&x.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&I&&I[O]){var P=I[O];this.level=b.nextLoadLevel=O;var M=P.details;if(!M||this.state===i.State.WAITING_LEVEL||M.live&&this.levelLastLoaded!==O)this.state=i.State.WAITING_LEVEL;else{var F=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:C,o.PlaylistLevelType.MAIN);if(F!==null&&!(F.len>=this.getMaxBufferLength(P.maxBitrate))){if(this._streamEnded(F,M)){var B={};return this.altAudio&&(B.type="video"),this.hls.trigger(a.Events.BUFFER_EOS,B),void(this.state=i.State.ENDED)}var j=F.end,K=this.getNextFragment(j,M);if(this.couldBacktrack&&!this.fragPrevious&&K&&K.sn!=="initSegment"){var z=K.sn-M.startSN;z>1&&(K=M.fragments[z-1],this.fragmentTracker.removeFragment(K))}if(K&&this.fragmentTracker.getState(K)===u.FragmentState.OK&&this.nextLoadPosition>j){var re=this.audioOnly&&!this.altAudio?y.ElementaryStreamTypes.AUDIO:y.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(C,re,o.PlaylistLevelType.MAIN),K=this.getNextFragment(this.nextLoadPosition,M)}K&&(!K.initSegment||K.initSegment.data||this.bitrateTest||(K=K.initSegment),((h=K.decryptdata)===null||h===void 0?void 0:h.keyFormat)!=="identity"||(v=K.decryptdata)!==null&&v!==void 0&&v.key?this.loadFragment(K,M,j):this.loadKey(K,M))}}}},k.loadFragment=function(h,v,b){var R,I=this.fragmentTracker.getState(h);if(this.fragCurrent=h,I===u.FragmentState.BACKTRACKED){var C=this.fragmentTracker.getBacktrackData(h);if(C)return this._handleFragmentLoadProgress(C),void this._handleFragmentLoadComplete(C);I=u.FragmentState.NOT_LOADED}I===u.FragmentState.NOT_LOADED||I===u.FragmentState.PARTIAL?h.sn==="initSegment"?this._loadInitSegment(h):this.bitrateTest?(h.bitrateTest=!0,this.log("Fragment "+h.sn+" of level "+h.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(h)):(this.startFragRequested=!0,T.prototype.loadFragment.call(this,h,v,b)):I===u.FragmentState.APPENDING?this.reduceMaxBufferLength(h.duration)&&this.fragmentTracker.removeFragment(h):((R=this.media)===null||R===void 0?void 0:R.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},k.getAppendedFrag=function(h){var v=this.fragmentTracker.getAppendedFrag(h,o.PlaylistLevelType.MAIN);return v&&"fragment"in v?v.fragment:v},k.getBufferedFrag=function(h){return this.fragmentTracker.getBufferedFrag(h,o.PlaylistLevelType.MAIN)},k.followingBufferedFrag=function(h){return h?this.getBufferedFrag(h.end+.5):null},k.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},k.nextLevelSwitch=function(){var h=this.levels,v=this.media;if(v!=null&&v.readyState){var b,R=this.getAppendedFrag(v.currentTime);if(R&&R.start>1&&this.flushMainBuffer(0,R.start-1),!v.paused&&h){var I=h[this.hls.nextLoadLevel],C=this.fragLastKbps;b=C&&this.fragCurrent?this.fragCurrent.duration*I.maxBitrate/(1e3*C)+1:0}else b=0;var x=this.getBufferedFrag(v.currentTime+b);if(x){var O=this.followingBufferedFrag(x);if(O){this.abortCurrentFrag();var P=O.maxStartPTS?O.maxStartPTS:O.start,M=O.duration,F=Math.max(x.end,P+Math.min(Math.max(M-this.config.maxFragLookUpTolerance,.5*M),.75*M));this.flushMainBuffer(F,Number.POSITIVE_INFINITY)}}}},k.abortCurrentFrag=function(){var h=this.fragCurrent;this.fragCurrent=null,h!=null&&h.loader&&h.loader.abort(),this.state===i.State.KEY_LOADING&&(this.state=i.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},k.flushMainBuffer=function(h,v){T.prototype.flushMainBuffer.call(this,h,v,this.altAudio?"video":null)},k.onMediaAttached=function(h,v){T.prototype.onMediaAttached.call(this,h,v);var b=v.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),b.addEventListener("playing",this.onvplaying),b.addEventListener("seeked",this.onvseeked),this.gapController=new L.default(this.config,b,this.fragmentTracker,this.hls)},k.onMediaDetaching=function(){var h=this.media;h&&(h.removeEventListener("playing",this.onvplaying),h.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),T.prototype.onMediaDetaching.call(this)},k.onMediaPlaying=function(){this.tick()},k.onMediaSeeked=function(){var h=this.media,v=h?h.currentTime:null;Object(n.isFiniteNumber)(v)&&this.log("Media seeked to "+v.toFixed(3)),this.tick()},k.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(a.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},k.onManifestParsed=function(h,v){var b,R=!1,I=!1;v.levels.forEach(function(C){(b=C.audioCodec)&&(b.indexOf("mp4a.40.2")!==-1&&(R=!0),b.indexOf("mp4a.40.5")!==-1&&(I=!0))}),this.audioCodecSwitch=R&&I&&!Object(s.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=v.levels,this.startFragRequested=!1},k.onLevelLoading=function(h,v){var b=this.levels;if(b&&this.state===i.State.IDLE){var R=b[v.level];(!R.details||R.details.live&&this.levelLastLoaded!==v.level||this.waitForCdnTuneIn(R.details))&&(this.state=i.State.WAITING_LEVEL)}},k.onLevelLoaded=function(h,v){var b,R=this.levels,I=v.level,C=v.details,x=C.totalduration;if(R){this.log("Level "+I+" loaded ["+C.startSN+","+C.endSN+"], cc ["+C.startCC+", "+C.endCC+"] duration:"+x);var O=this.fragCurrent;!O||this.state!==i.State.FRAG_LOADING&&this.state!==i.State.FRAG_LOADING_WAITING_RETRY||O.level!==v.level&&O.loader&&(this.state=i.State.IDLE,O.loader.abort());var P=R[I],M=0;if(C.live||(b=P.details)!==null&&b!==void 0&&b.live){if(C.fragments[0]||(C.deltaUpdateFailed=!0),C.deltaUpdateFailed)return;M=this.alignPlaylists(C,P.details)}if(P.details=C,this.levelLastLoaded=I,this.hls.trigger(a.Events.LEVEL_UPDATED,{details:C,level:I}),this.state===i.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(C))return;this.state=i.State.IDLE}this.startFragRequested?C.live&&this.synchronizeToLiveEdge(C):this.setStartPosition(C,M),this.tick()}else this.warn("Levels were reset while loading level "+I)},k._handleFragmentLoadProgress=function(h){var v,b=h.frag,R=h.part,I=h.payload,C=this.levels;if(C){var x=C[b.level],O=x.details;if(O){var P=x.videoCodec,M=O.PTSKnown||!O.live,F=(v=b.initSegment)===null||v===void 0?void 0:v.data,B=this._getAudioCodec(x),j=this.transmuxer=this.transmuxer||new m.default(this.hls,o.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),K=R?R.index:-1,z=K!==-1,re=new f.ChunkMetadata(b.level,b.sn,b.stats.chunkCount,I.byteLength,K,z),ne=this.initPTS[b.cc];j.push(I,F,B,P,b,R,O.totalduration,M,re,ne)}else this.warn("Dropping fragment "+b.sn+" of level "+b.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+b.sn+" of level "+b.level+" will not be buffered")},k.onAudioTrackSwitching=function(h,v){var b=this.altAudio,R=!!v.url,I=v.id;if(!R){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var C=this.fragCurrent;C!=null&&C.loader&&(this.log("Switching to main audio track, cancel main fragment load"),C.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var x=this.hls;b&&x.trigger(a.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),x.trigger(a.Events.AUDIO_TRACK_SWITCHED,{id:I})}},k.onAudioTrackSwitched=function(h,v){var b=v.id,R=!!this.hls.audioTracks[b].url;if(R){var I=this.videoBuffer;I&&this.mediaBuffer!==I&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=I)}this.altAudio=R,this.tick()},k.onBufferCreated=function(h,v){var b,R,I=v.tracks,C=!1;for(var x in I){var O=I[x];if(O.id==="main"){if(R=x,b=O,x==="video"){var P=I[x];P&&(this.videoBuffer=P.buffer)}}else C=!0}C&&b?(this.log("Alternate track found, use "+R+".buffered to schedule main fragment loading"),this.mediaBuffer=b.buffer):this.mediaBuffer=this.media},k.onFragBuffered=function(h,v){var b=v.frag,R=v.part;if(!b||b.type===o.PlaylistLevelType.MAIN){if(this.fragContextChanged(b))return this.warn("Fragment "+b.sn+(R?" p: "+R.index:"")+" of level "+b.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===i.State.PARSED&&(this.state=i.State.IDLE));var I=R?R.stats:b.stats;this.fragLastKbps=Math.round(8*I.total/(I.buffering.end-I.loading.first)),b.sn!=="initSegment"&&(this.fragPrevious=b),this.fragBufferedComplete(b,R)}},k.onError=function(h,v){switch(v.details){case _.ErrorDetails.FRAG_LOAD_ERROR:case _.ErrorDetails.FRAG_LOAD_TIMEOUT:case _.ErrorDetails.KEY_LOAD_ERROR:case _.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(o.PlaylistLevelType.MAIN,v);break;case _.ErrorDetails.LEVEL_LOAD_ERROR:case _.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==i.State.ERROR&&(v.fatal?(this.warn(""+v.details),this.state=i.State.ERROR):v.levelRetry||this.state!==i.State.WAITING_LEVEL||(this.state=i.State.IDLE));break;case _.ErrorDetails.BUFFER_FULL_ERROR:if(v.parent==="main"&&(this.state===i.State.PARSING||this.state===i.State.PARSED)){var b=!0,R=this.getFwdBufferInfo(this.media,o.PlaylistLevelType.MAIN);R&&R.len>.5&&(b=!this.reduceMaxBufferLength(R.len)),b&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}},k.checkBuffer=function(){var h=this.media,v=this.gapController;if(h&&v&&h.readyState){var b=d.BufferHelper.getBuffered(h);!this.loadedmetadata&&b.length?(this.loadedmetadata=!0,this.seekToStartPos()):v.poll(this.lastCurrentTime),this.lastCurrentTime=h.currentTime}},k.onFragLoadEmergencyAborted=function(){this.state=i.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},k.onBufferFlushed=function(h,v){var b=v.type;if(b!==y.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var R=(b===y.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(R,b,o.PlaylistLevelType.MAIN)}},k.onLevelsUpdated=function(h,v){this.levels=v.levels},k.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},k.seekToStartPos=function(){var h=this.media,v=h.currentTime,b=this.startPosition;if(b>=0&&v<b){if(h.seeking)return void E.logger.log("could not seek to "+b+", already seeking at "+v);var R=d.BufferHelper.getBuffered(h),I=(R.length?R.start(0):0)-b;I>0&&I<this.config.maxBufferHole&&(E.logger.log("adjusting start position by "+I+" to match buffer start"),b+=I,this.startPosition=b),this.log("seek to target start position "+b+" from current time "+v),h.currentTime=b}},k._getAudioCodec=function(h){var v=this.config.defaultAudioCodec||h.audioCodec;return this.audioCodecSwap&&v&&(this.log("Swapping audio codec"),v=v.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),v},k._loadBitrateTestFrag=function(h){var v=this;this._doFragLoad(h).then(function(b){var R=v.hls;if(b&&!R.nextLoadLevel&&!v.fragContextChanged(h)){v.fragLoadError=0,v.state=i.State.IDLE,v.startFragRequested=!1,v.bitrateTest=!1;var I=h.stats;I.parsing.start=I.parsing.end=I.buffering.start=I.buffering.end=self.performance.now(),R.trigger(a.Events.FRAG_LOADED,b)}})},k._handleTransmuxComplete=function(h){var v,b="main",R=this.hls,I=h.remuxResult,C=h.chunkMeta,x=this.getCurrentContext(C);if(!x)return this.warn("The loading context changed while buffering fragment "+C.sn+" of level "+C.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(C.level);var O=x.frag,P=x.part,M=x.level,F=I.video,B=I.text,j=I.id3,K=I.initSegment,z=this.altAudio?void 0:I.audio;if(!this.fragContextChanged(O)){if(this.state=i.State.PARSING,K){K.tracks&&(this._bufferInitSegment(M,K.tracks,O,C),R.trigger(a.Events.FRAG_PARSING_INIT_SEGMENT,{frag:O,id:b,tracks:K.tracks}));var re=K.initPTS,ne=K.timescale;Object(n.isFiniteNumber)(re)&&(this.initPTS[O.cc]=re,R.trigger(a.Events.INIT_PTS_FOUND,{frag:O,id:b,initPTS:re,timescale:ne}))}if(F&&I.independent!==!1){if(M.details){var V=F.startPTS,q=F.endPTS,Y=F.startDTS,ie=F.endDTS;if(P)P.elementaryStreams[F.type]={startPTS:V,endPTS:q,startDTS:Y,endDTS:ie};else if(F.firstKeyFrame&&F.independent&&(this.couldBacktrack=!0),F.dropped&&F.independent){if(this.getLoadPosition()+this.config.maxBufferHole<V)return void this.backtrack(O);O.setElementaryStreamInfo(F.type,O.start,q,O.start,ie,!0)}O.setElementaryStreamInfo(F.type,V,q,Y,ie),this.bufferFragmentData(F,O,P,C)}}else if(I.independent===!1)return void this.backtrack(O);if(z){var ue=z.startPTS,N=z.endPTS,U=z.startDTS,G=z.endDTS;P&&(P.elementaryStreams[y.ElementaryStreamTypes.AUDIO]={startPTS:ue,endPTS:N,startDTS:U,endDTS:G}),O.setElementaryStreamInfo(y.ElementaryStreamTypes.AUDIO,ue,N,U,G),this.bufferFragmentData(z,O,P,C)}if(j!=null&&(v=j.samples)!==null&&v!==void 0&&v.length){var H={frag:O,id:b,samples:j.samples};R.trigger(a.Events.FRAG_PARSING_METADATA,H)}if(B){var W={frag:O,id:b,samples:B.samples};R.trigger(a.Events.FRAG_PARSING_USERDATA,W)}}},k._bufferInitSegment=function(h,v,b,R){var I=this;if(this.state===i.State.PARSING){this.audioOnly=!!v.audio&&!v.video,this.altAudio&&!this.audioOnly&&delete v.audio;var C=v.audio,x=v.video,O=v.audiovideo;if(C){var P=h.audioCodec,M=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(P&&(P=P.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),C.metadata.channelCount!==1&&M.indexOf("firefox")===-1&&(P="mp4a.40.5")),M.indexOf("android")!==-1&&C.container!=="audio/mpeg"&&(P="mp4a.40.2",this.log("Android: force audio codec to "+P)),h.audioCodec&&h.audioCodec!==P&&this.log('Swapping manifest audio codec "'+h.audioCodec+'" for "'+P+'"'),C.levelCodec=P,C.id="main",this.log("Init audio buffer, container:"+C.container+", codecs[selected/level/parsed]=["+(P||"")+"/"+(h.audioCodec||"")+"/"+C.codec+"]")}x&&(x.levelCodec=h.videoCodec,x.id="main",this.log("Init video buffer, container:"+x.container+", codecs[level/parsed]=["+(h.videoCodec||"")+"/"+x.codec+"]")),O&&this.log("Init audiovideo buffer, container:"+O.container+", codecs[level/parsed]=["+(h.attrs.CODECS||"")+"/"+O.codec+"]"),this.hls.trigger(a.Events.BUFFER_CODECS,v),Object.keys(v).forEach(function(F){var B=v[F].initSegment;B!=null&&B.byteLength&&I.hls.trigger(a.Events.BUFFER_APPENDING,{type:F,data:B,frag:b,part:null,chunkMeta:R,parent:b.type})}),this.tick()}},k.backtrack=function(h){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(h);var v=this.fragmentTracker.backtrack(h);this.fragPrevious=null,this.nextLoadPosition=h.start,v?this.resetFragmentLoading(h):this.state=i.State.BACKTRACKING},k.checkFragmentChanged=function(){var h=this.media,v=null;if(h&&h.readyState>1&&h.seeking===!1){var b=h.currentTime;if(d.BufferHelper.isBuffered(h,b)?v=this.getAppendedFrag(b):d.BufferHelper.isBuffered(h,b+.1)&&(v=this.getAppendedFrag(b+.1)),v){var R=this.fragPlaying,I=v.level;R&&v.sn===R.sn&&R.level===I&&v.urlId===R.urlId||(this.hls.trigger(a.Events.FRAG_CHANGED,{frag:v}),R&&R.level===I||this.hls.trigger(a.Events.LEVEL_SWITCHED,{level:I}),this.fragPlaying=v)}}},D=A,(w=[{key:"nextLevel",get:function(){var h=this.nextBufferedFrag;return h?h.level:-1}},{key:"currentLevel",get:function(){var h=this.media;if(h){var v=this.getAppendedFrag(h.currentTime);if(v)return v.level}return-1}},{key:"nextBufferedFrag",get:function(){var h=this.media;if(h){var v=this.getAppendedFrag(h.currentTime);return this.followingBufferedFrag(v)}return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&l(D.prototype,w),A}(i.default)},"./src/controller/subtitle-stream-controller.ts":function(t,e,r){r.r(e),r.d(e,"SubtitleStreamController",function(){return E});var n=r("./src/events.ts"),i=r("./src/utils/logger.ts"),s=r("./src/utils/buffer-helper.ts"),a=r("./src/controller/fragment-finders.ts"),d=r("./src/utils/discontinuities.ts"),u=r("./src/controller/level-helper.ts"),o=r("./src/controller/fragment-tracker.ts"),y=r("./src/controller/base-stream-controller.ts"),m=r("./src/types/loader.ts"),f=r("./src/types/level.ts");function L(l,g){for(var c=0;c<g.length;c++){var T=g[c];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(l,T.key,T)}}function _(l,g){return(_=Object.setPrototypeOf||function(c,T){return c.__proto__=T,c})(l,g)}var E=function(l){var g,c;function T(D,w){var k;return(k=l.call(this,D,w,"[subtitle-stream-controller]")||this).levels=[],k.currentTrackId=-1,k.tracksBuffered=[],k.mainDetails=null,k._registerListeners(),k}c=l,(g=T).prototype=Object.create(c.prototype),g.prototype.constructor=g,_(g,c);var S,p,A=T.prototype;return A.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},A._registerListeners=function(){var D=this.hls;D.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),D.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),D.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),D.on(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),D.on(n.Events.ERROR,this.onError,this),D.on(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),D.on(n.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),D.on(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),D.on(n.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),D.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},A._unregisterListeners=function(){var D=this.hls;D.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),D.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),D.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),D.off(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),D.off(n.Events.ERROR,this.onError,this),D.off(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),D.off(n.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),D.off(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),D.off(n.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),D.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},A.startLoad=function(){this.stopLoad(),this.state=y.State.IDLE,this.setInterval(500),this.tick()},A.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},A.onLevelLoaded=function(D,w){this.mainDetails=w.details},A.onSubtitleFragProcessed=function(D,w){var k=w.frag,h=w.success;if(this.fragPrevious=k,this.state=y.State.IDLE,h){var v=this.tracksBuffered[this.currentTrackId];if(v){for(var b,R=k.start,I=0;I<v.length;I++)if(R>=v[I].start&&R<=v[I].end){b=v[I];break}var C=k.start+k.duration;b?b.end=C:(b={start:R,end:C},v.push(b)),this.fragmentTracker.fragBuffered(k)}}},A.onBufferFlushing=function(D,w){var k=w.startOffset,h=w.endOffset;if(k===0&&h!==Number.POSITIVE_INFINITY){var v=this.currentTrackId,b=this.levels;if(!b.length||!b[v]||!b[v].details)return;var R=h-b[v].details.targetduration;if(R<=0)return;w.endOffsetSubtitles=Math.max(0,R),this.tracksBuffered.forEach(function(I){for(var C=0;C<I.length;)if(I[C].end<=R)I.shift();else{if(!(I[C].start<R))break;I[C].start=R,C++}}),this.fragmentTracker.removeFragmentsInRange(k,R,m.PlaylistLevelType.SUBTITLE)}},A.onError=function(D,w){var k,h=w.frag;h&&h.type===m.PlaylistLevelType.SUBTITLE&&((k=this.fragCurrent)!==null&&k!==void 0&&k.loader&&this.fragCurrent.loader.abort(),this.state=y.State.IDLE)},A.onSubtitleTracksUpdated=function(D,w){var k=this,h=w.subtitleTracks;this.tracksBuffered=[],this.levels=h.map(function(v){return new f.Level(v)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(v){k.tracksBuffered[v.id]=[]}),this.mediaBuffer=null},A.onSubtitleTrackSwitch=function(D,w){if(this.currentTrackId=w.id,this.levels.length&&this.currentTrackId!==-1){var k=this.levels[this.currentTrackId];k!=null&&k.details?(this.mediaBuffer=this.mediaBufferTimeRanges,this.setInterval(500)):this.mediaBuffer=null}else this.clearInterval()},A.onSubtitleTrackLoaded=function(D,w){var k,h=w.details,v=w.id,b=this.currentTrackId,R=this.levels;if(R.length){var I=R[b];if(!(v>=R.length||v!==b)&&I){if(this.mediaBuffer=this.mediaBufferTimeRanges,h.live||(k=I.details)!==null&&k!==void 0&&k.live){var C=this.mainDetails;if(h.deltaUpdateFailed||!C)return;var x=C.fragments[0];I.details?this.alignPlaylists(h,I.details)===0&&x&&Object(u.addSliding)(h,x.start):h.hasProgramDateTime&&C.hasProgramDateTime?Object(d.alignPDT)(h,C):x&&Object(u.addSliding)(h,x.start)}I.details=h,this.levelLastLoaded=v,this.tick(),h.live&&!this.fragCurrent&&this.media&&this.state===y.State.IDLE&&(Object(a.findFragmentByPTS)(null,h.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),I.details=void 0))}}},A._handleFragmentLoadComplete=function(D){var w=D.frag,k=D.payload,h=w.decryptdata,v=this.hls;if(!this.fragContextChanged(w)&&k&&k.byteLength>0&&h&&h.key&&h.iv&&h.method==="AES-128"){var b=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(k),h.key.buffer,h.iv.buffer).then(function(R){var I=performance.now();v.trigger(n.Events.FRAG_DECRYPTED,{frag:w,payload:R,stats:{tstart:b,tdecrypt:I}})})}},A.doTick=function(){if(this.media){if(this.state===y.State.IDLE){var D,w=this.currentTrackId,k=this.levels;if(!k.length||!k[w]||!k[w].details)return;var h=k[w].details,v=h.targetduration,b=this.config,R=this.media,I=s.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,R.currentTime-v,b.maxBufferHole),C=I.end;if(I.len>this.getMaxBufferLength()+v)return;console.assert(h,"Subtitle track details are defined on idle subtitle stream controller tick");var x,O=h.fragments,P=O.length,M=h.edge,F=this.fragPrevious;if(C<M){var B=b.maxFragLookUpTolerance;F&&h.hasProgramDateTime&&(x=Object(a.findFragmentByPDT)(O,F.endProgramDateTime,B)),x||!(x=Object(a.findFragmentByPTS)(F,O,C,B))&&F&&F.start<O[0].start&&(x=O[0])}else x=O[P-1];(D=x)!==null&&D!==void 0&&D.encrypted?(i.logger.log("Loading key for "+x.sn),this.state=y.State.KEY_LOADING,this.hls.trigger(n.Events.KEY_LOADING,{frag:x})):x&&this.fragmentTracker.getState(x)===o.FragmentState.NOT_LOADED&&this.loadFragment(x,h,C)}}else this.state=y.State.IDLE},A.loadFragment=function(D,w,k){this.fragCurrent=D,l.prototype.loadFragment.call(this,D,w,k)},S=T,(p=[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}])&&L(S.prototype,p),T}(y.default)},"./src/controller/subtitle-track-controller.ts":function(t,e,r){r.r(e);var n=r("./src/events.ts"),i=r("./src/utils/texttrack-utils.ts"),s=r("./src/controller/base-playlist-controller.ts"),a=r("./src/types/loader.ts");function d(m,f){for(var L=0;L<f.length;L++){var _=f[L];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,_.key,_)}}function u(m,f){return(u=Object.setPrototypeOf||function(L,_){return L.__proto__=_,L})(m,f)}var o=function(m){var f,L;function _(c){var T;return(T=m.call(this,c,"[subtitle-track-controller]")||this).media=null,T.tracks=[],T.groupId=null,T.tracksInGroup=[],T.trackId=-1,T.selectDefaultTrack=!0,T.queuedDefaultTrack=-1,T.trackChangeListener=function(){return T.onTextTracksChanged()},T.asyncPollTrackChange=function(){return T.pollTrackChange(0)},T.useTextTrackPolling=!1,T.subtitlePollingInterval=-1,T.subtitleDisplay=!0,T.registerListeners(),T}L=m,(f=_).prototype=Object.create(L.prototype),f.prototype.constructor=f,u(f,L);var E,l,g=_.prototype;return g.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,m.prototype.destroy.call(this)},g.registerListeners=function(){var c=this.hls;c.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),c.on(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.on(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),c.on(n.Events.ERROR,this.onError,this)},g.unregisterListeners=function(){var c=this.hls;c.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),c.off(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.off(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),c.off(n.Events.ERROR,this.onError,this)},g.onMediaAttached=function(c,T){this.media=T.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},g.pollTrackChange=function(c){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,c)},g.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),y(this.media.textTracks).forEach(function(c){Object(i.clearCurrentCues)(c)}),this.subtitleTrack=-1,this.media=null)},g.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},g.onManifestParsed=function(c,T){this.tracks=T.subtitleTracks},g.onSubtitleTrackLoaded=function(c,T){var S=T.id,p=T.details,A=this.trackId,D=this.tracksInGroup[A];if(D){var w=D.details;D.details=T.details,this.log("subtitle track "+S+" loaded ["+p.startSN+"-"+p.endSN+"]"),S===this.trackId&&(this.retryCount=0,this.playlistLoaded(S,T,w))}else this.warn("Invalid subtitle track id "+S)},g.onLevelLoading=function(c,T){this.switchLevel(T.level)},g.onLevelSwitching=function(c,T){this.switchLevel(T.level)},g.switchLevel=function(c){var T=this.hls.levels[c];if(T!=null&&T.textGroupIds){var S=T.textGroupIds[T.urlId];if(this.groupId!==S){var p=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,A=this.tracks.filter(function(k){return!S||k.groupId===S});this.tracksInGroup=A;var D=this.findTrackId(p==null?void 0:p.name)||this.findTrackId();this.groupId=S;var w={subtitleTracks:A};this.log("Updating subtitle tracks, "+A.length+' track(s) found in "'+S+'" group-id'),this.hls.trigger(n.Events.SUBTITLE_TRACKS_UPDATED,w),D!==-1&&this.setSubtitleTrack(D,p)}}},g.findTrackId=function(c){for(var T=this.tracksInGroup,S=0;S<T.length;S++){var p=T[S];if((!this.selectDefaultTrack||p.default)&&(!c||c===p.name))return p.id}return-1},g.onError=function(c,T){m.prototype.onError.call(this,c,T),!T.fatal&&T.context&&T.context.type===a.PlaylistContextType.SUBTITLE_TRACK&&T.context.id===this.trackId&&T.context.groupId===this.groupId&&this.retryLoadingOrFail(T)},g.loadPlaylist=function(c){var T=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(T)){var S=T.id,p=T.groupId,A=T.url;if(c)try{A=c.addDirectives(A)}catch(D){this.warn("Could not construct new URL with HLS Delivery Directives: "+D)}this.log("Loading subtitle playlist for id "+S),this.hls.trigger(n.Events.SUBTITLE_TRACK_LOADING,{url:A,id:S,groupId:p,deliveryDirectives:c||null})}},g.toggleTrackModes=function(c){var T=this,S=this.media,p=this.subtitleDisplay,A=this.trackId;if(S){var D=y(S.textTracks),w=D.filter(function(v){return v.groupId===T.groupId});if(c===-1)[].slice.call(D).forEach(function(v){v.mode="disabled"});else{var k=w[A];k&&(k.mode="disabled")}var h=w[c];h&&(h.mode=p?"showing":"hidden")}},g.setSubtitleTrack=function(c,T){var S,p=this.tracksInGroup;if(this.media){if(this.trackId!==c&&this.toggleTrackModes(c),!(this.trackId===c&&(c===-1||(S=p[c])!==null&&S!==void 0&&S.details)||c<-1||c>=p.length)){this.clearTimer();var A=p[c];if(this.log("Switching to subtitle track "+c),this.trackId=c,A){var D=A.id,w=A.groupId,k=w===void 0?"":w,h=A.name,v=A.type,b=A.url;this.hls.trigger(n.Events.SUBTITLE_TRACK_SWITCH,{id:D,groupId:k,name:h,type:v,url:b});var R=this.switchParams(A.url,T==null?void 0:T.details);this.loadPlaylist(R)}else this.hls.trigger(n.Events.SUBTITLE_TRACK_SWITCH,{id:c})}}else this.queuedDefaultTrack=c},g.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var c=-1,T=y(this.media.textTracks),S=0;S<T.length;S++)if(T[S].mode==="hidden")c=S;else if(T[S].mode==="showing"){c=S;break}this.subtitleTrack!==c&&(this.subtitleTrack=c)}},E=_,(l=[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(c){this.selectDefaultTrack=!1;var T=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(c,T)}}])&&d(E.prototype,l),_}(s.default);function y(m){for(var f=[],L=0;L<m.length;L++){var _=m[L];_.kind==="subtitles"&&_.label&&f.push(m[L])}return f}e.default=o},"./src/controller/timeline-controller.ts":function(t,e,r){r.r(e),r.d(e,"TimelineController",function(){return f});var n=r("./src/polyfills/number.ts"),i=r("./src/events.ts"),s=r("./src/utils/cea-608-parser.ts"),a=r("./src/utils/output-filter.ts"),d=r("./src/utils/webvtt-parser.ts"),u=r("./src/utils/texttrack-utils.ts"),o=r("./src/utils/imsc1-ttml-parser.ts"),y=r("./src/types/loader.ts"),m=r("./src/utils/logger.ts"),f=function(){function _(l){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this.captionsProperties=void 0,this.hls=l,this.config=l.config,this.Cues=l.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var g=new a.default(this,"textTrack1"),c=new a.default(this,"textTrack2"),T=new a.default(this,"textTrack3"),S=new a.default(this,"textTrack4");this.cea608Parser1=new s.default(1,g,c),this.cea608Parser2=new s.default(3,T,S)}l.on(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),l.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),l.on(i.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),l.on(i.Events.FRAG_LOADING,this.onFragLoading,this),l.on(i.Events.FRAG_LOADED,this.onFragLoaded,this),l.on(i.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),l.on(i.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),l.on(i.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),l.on(i.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),l.on(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var E=_.prototype;return E.destroy=function(){var l=this.hls;l.off(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),l.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),l.off(i.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),l.off(i.Events.FRAG_LOADING,this.onFragLoading,this),l.off(i.Events.FRAG_LOADED,this.onFragLoaded,this),l.off(i.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),l.off(i.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),l.off(i.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),l.off(i.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),l.off(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},E.addCues=function(l,g,c,T,S){for(var p,A,D,w,k=!1,h=S.length;h--;){var v=S[h],b=(p=v[0],A=v[1],D=g,w=c,Math.min(A,w)-Math.max(p,D));if(b>=0&&(v[0]=Math.min(v[0],g),v[1]=Math.max(v[1],c),k=!0,b/(c-g)>.5))return}if(k||S.push([g,c]),this.config.renderTextTracksNatively){var R=this.captionsTracks[l];this.Cues.newCue(R,g,c,T)}else{var I=this.Cues.newCue(null,g,c,T);this.hls.trigger(i.Events.CUES_PARSED,{type:"captions",cues:I,track:l})}},E.onInitPtsFound=function(l,g){var c=this,T=g.frag,S=g.id,p=g.initPTS,A=g.timescale,D=this.unparsedVttFrags;S==="main"&&(this.initPTS[T.cc]=p,this.timescale[T.cc]=A),D.length&&(this.unparsedVttFrags=[],D.forEach(function(w){c.onFragLoaded(i.Events.FRAG_LOADED,w)}))},E.getExistingTrack=function(l){var g=this.media;if(g)for(var c=0;c<g.textTracks.length;c++){var T=g.textTracks[c];if(T[l])return T}return null},E.createCaptionsTrack=function(l){this.config.renderTextTracksNatively?this.createNativeTrack(l):this.createNonNativeTrack(l)},E.createNativeTrack=function(l){if(!this.captionsTracks[l]){var g=this.captionsProperties,c=this.captionsTracks,T=this.media,S=g[l],p=S.label,A=S.languageCode,D=this.getExistingTrack(l);if(D)c[l]=D,Object(u.clearCurrentCues)(c[l]),Object(u.sendAddTrackEvent)(c[l],T);else{var w=this.createTextTrack("captions",p,A);w&&(w[l]=!0,c[l]=w)}}},E.createNonNativeTrack=function(l){if(!this.nonNativeCaptionsTracks[l]){var g=this.captionsProperties[l];if(g){var c={_id:l,label:g.label,kind:"captions",default:!!g.media&&!!g.media.default,closedCaptions:g.media};this.nonNativeCaptionsTracks[l]=c,this.hls.trigger(i.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[c]})}}},E.createTextTrack=function(l,g,c){var T=this.media;if(T)return T.addTextTrack(l,g,c)},E.onMediaAttaching=function(l,g){this.media=g.media,this._cleanTracks()},E.onMediaDetaching=function(){var l=this.captionsTracks;Object.keys(l).forEach(function(g){Object(u.clearCurrentCues)(l[g]),delete l[g]}),this.nonNativeCaptionsTracks={}},E.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},E._cleanTracks=function(){var l=this.media;if(l){var g=l.textTracks;if(g)for(var c=0;c<g.length;c++)Object(u.clearCurrentCues)(g[c])}},E.onSubtitleTracksUpdated=function(l,g){var c=this;this.textTracks=[];var T=g.subtitleTracks||[],S=T.some(function(w){return w.textCodec===o.IMSC1_CODEC});if(this.config.enableWebVTT||S&&this.config.enableIMSC1){var p=this.tracks&&T&&this.tracks.length===T.length;if(this.tracks=T||[],this.config.renderTextTracksNatively){var A=this.media?this.media.textTracks:[];this.tracks.forEach(function(w,k){var h;if(k<A.length){for(var v=null,b=0;b<A.length;b++)if(L(A[b],w)){v=A[b];break}v&&(h=v)}h?Object(u.clearCurrentCues)(h):(h=c.createTextTrack("subtitles",w.name,w.lang))&&(h.mode="disabled"),h&&(h.groupId=w.groupId,c.textTracks.push(h))})}else if(!p&&this.tracks&&this.tracks.length){var D=this.tracks.map(function(w){return{label:w.name,kind:w.type.toLowerCase(),default:w.default,subtitleTrack:w}});this.hls.trigger(i.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:D})}}},E.onManifestLoaded=function(l,g){var c=this;this.config.enableCEA708Captions&&g.captions&&g.captions.forEach(function(T){var S=/(?:CC|SERVICE)([1-4])/.exec(T.instreamId);if(S){var p="textTrack"+S[1],A=c.captionsProperties[p];A&&(A.label=T.name,T.lang&&(A.languageCode=T.lang),A.media=T)}})},E.onFragLoading=function(l,g){var c=this.cea608Parser1,T=this.cea608Parser2,S=this.lastSn;if(this.enabled&&c&&T&&g.frag.type===y.PlaylistLevelType.MAIN){var p=g.frag.sn;p!==S+1&&(c.reset(),T.reset()),this.lastSn=p}},E.onFragLoaded=function(l,g){var c=g.frag,T=g.payload,S=this.initPTS,p=this.unparsedVttFrags;if(c.type===y.PlaylistLevelType.SUBTITLE)if(T.byteLength){if(!Object(n.isFiniteNumber)(S[c.cc]))return p.push(g),void(S.length&&this.hls.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:c,error:new Error("Missing initial subtitle PTS")}));var A=c.decryptdata;if(A==null||A.key==null||A.method!=="AES-128"){var D=this.tracks[c.level],w=this.vttCCs;w[c.cc]||(w[c.cc]={start:c.start,prevCC:this.prevCC,new:!0},this.prevCC=c.cc),D&&D.textCodec===o.IMSC1_CODEC?this._parseIMSC1(c,T):this._parseVTTs(c,T,w)}}else this.hls.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:c,error:new Error("Empty subtitle payload")})},E._parseIMSC1=function(l,g){var c=this,T=this.hls;Object(o.parseIMSC1)(g,this.initPTS[l.cc],this.timescale[l.cc],function(S){c._appendCues(S,l.level),T.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:l})},function(S){m.logger.log("Failed to parse IMSC1: "+S),T.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:S})})},E._parseVTTs=function(l,g,c){var T=this,S=this.hls;Object(d.parseWebVTT)(g,this.initPTS[l.cc],this.timescale[l.cc],c,l.cc,l.start,function(p){T._appendCues(p,l.level),S.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:l})},function(p){T._fallbackToIMSC1(l,g),m.logger.log("Failed to parse VTT cue: "+p),S.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:p})})},E._fallbackToIMSC1=function(l,g){var c=this,T=this.tracks[l.level];T.textCodec||Object(o.parseIMSC1)(g,this.initPTS[l.cc],this.timescale[l.cc],function(){T.textCodec=o.IMSC1_CODEC,c._parseIMSC1(l,g)},function(){T.textCodec="wvtt"})},E._appendCues=function(l,g){var c=this.hls;if(this.config.renderTextTracksNatively){var T=this.textTracks[g];if(T.mode==="disabled")return;l.forEach(function(p){return Object(u.addCueToTrack)(T,p)})}else{var S=this.tracks[g].default?"default":"subtitles"+g;c.trigger(i.Events.CUES_PARSED,{type:"subtitles",cues:l,track:S})}},E.onFragDecrypted=function(l,g){var c=g.frag;if(c.type===y.PlaylistLevelType.SUBTITLE){if(!Object(n.isFiniteNumber)(this.initPTS[c.cc]))return void this.unparsedVttFrags.push(g);this.onFragLoaded(i.Events.FRAG_LOADED,g)}},E.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},E.onFragParsingUserdata=function(l,g){var c=this.cea608Parser1,T=this.cea608Parser2;if(this.enabled&&c&&T)for(var S=0;S<g.samples.length;S++){var p=g.samples[S].bytes;if(p){var A=this.extractCea608Data(p);c.addData(g.samples[S].pts,A[0]),T.addData(g.samples[S].pts,A[1])}}},E.onBufferFlushing=function(l,g){var c=g.startOffset,T=g.endOffset,S=g.endOffsetSubtitles,p=g.type,A=this.media;if(A&&!(A.currentTime<T)){if(!p||p==="video"){var D=this.captionsTracks;Object.keys(D).forEach(function(k){return Object(u.removeCuesInRange)(D[k],c,T)})}if(this.config.renderTextTracksNatively&&c===0&&S!==void 0){var w=this.textTracks;Object.keys(w).forEach(function(k){return Object(u.removeCuesInRange)(w[k],c,S)})}}},E.extractCea608Data=function(l){for(var g=31&l[0],c=2,T=[[],[]],S=0;S<g;S++){var p=l[c++],A=127&l[c++],D=127&l[c++],w=3&p;A===0&&D===0||4&p&&(w!==0&&w!==1||(T[w].push(A),T[w].push(D)))}return T},_}();function L(_,E){return _&&_.label===E.name&&!(_.textTrack1||_.textTrack2)}},"./src/crypt/aes-crypto.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return n});var n=function(){function i(s,a){this.subtle=void 0,this.aesIV=void 0,this.subtle=s,this.aesIV=a}return i.prototype.decrypt=function(s,a){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},a,s)},i}()},"./src/crypt/aes-decryptor.ts":function(t,e,r){r.r(e),r.d(e,"removePadding",function(){return i}),r.d(e,"default",function(){return s});var n=r("./src/utils/typed-array.ts");function i(a){var d=a.byteLength,u=d&&new DataView(a.buffer).getUint8(d-1);return u?Object(n.sliceUint8)(a,0,d-u):a}var s=function(){function a(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var d=a.prototype;return d.uint8ArrayToUint32Array_=function(u){for(var o=new DataView(u),y=new Uint32Array(4),m=0;m<4;m++)y[m]=o.getUint32(4*m);return y},d.initTable=function(){var u=this.sBox,o=this.invSBox,y=this.subMix,m=y[0],f=y[1],L=y[2],_=y[3],E=this.invSubMix,l=E[0],g=E[1],c=E[2],T=E[3],S=new Uint32Array(256),p=0,A=0,D=0;for(D=0;D<256;D++)S[D]=D<128?D<<1:D<<1^283;for(D=0;D<256;D++){var w=A^A<<1^A<<2^A<<3^A<<4;w=w>>>8^255&w^99,u[p]=w,o[w]=p;var k=S[p],h=S[k],v=S[h],b=257*S[w]^16843008*w;m[p]=b<<24|b>>>8,f[p]=b<<16|b>>>16,L[p]=b<<8|b>>>24,_[p]=b,b=16843009*v^65537*h^257*k^16843008*p,l[w]=b<<24|b>>>8,g[w]=b<<16|b>>>16,c[w]=b<<8|b>>>24,T[w]=b,p?(p=k^S[S[S[v^k]]],A^=S[S[A]]):p=A=1}},d.expandKey=function(u){for(var o=this.uint8ArrayToUint32Array_(u),y=!0,m=0;m<o.length&&y;)y=o[m]===this.key[m],m++;if(!y){this.key=o;var f=this.keySize=o.length;if(f!==4&&f!==6&&f!==8)throw new Error("Invalid aes key size="+f);var L,_,E,l,g=this.ksRows=4*(f+6+1),c=this.keySchedule=new Uint32Array(g),T=this.invKeySchedule=new Uint32Array(g),S=this.sBox,p=this.rcon,A=this.invSubMix,D=A[0],w=A[1],k=A[2],h=A[3];for(L=0;L<g;L++)L<f?E=c[L]=o[L]:(l=E,L%f==0?(l=S[(l=l<<8|l>>>24)>>>24]<<24|S[l>>>16&255]<<16|S[l>>>8&255]<<8|S[255&l],l^=p[L/f|0]<<24):f>6&&L%f==4&&(l=S[l>>>24]<<24|S[l>>>16&255]<<16|S[l>>>8&255]<<8|S[255&l]),c[L]=E=(c[L-f]^l)>>>0);for(_=0;_<g;_++)L=g-_,l=3&_?c[L]:c[L-4],T[_]=_<4||L<=4?l:D[S[l>>>24]]^w[S[l>>>16&255]]^k[S[l>>>8&255]]^h[S[255&l]],T[_]=T[_]>>>0}},d.networkToHostOrderSwap=function(u){return u<<24|(65280&u)<<8|(16711680&u)>>8|u>>>24},d.decrypt=function(u,o,y){for(var m,f,L,_,E,l,g,c,T,S,p,A,D,w,k=this.keySize+6,h=this.invKeySchedule,v=this.invSBox,b=this.invSubMix,R=b[0],I=b[1],C=b[2],x=b[3],O=this.uint8ArrayToUint32Array_(y),P=O[0],M=O[1],F=O[2],B=O[3],j=new Int32Array(u),K=new Int32Array(j.length),z=this.networkToHostOrderSwap;o<j.length;){for(T=z(j[o]),S=z(j[o+1]),p=z(j[o+2]),A=z(j[o+3]),E=T^h[0],l=A^h[1],g=p^h[2],c=S^h[3],D=4,w=1;w<k;w++)m=R[E>>>24]^I[l>>16&255]^C[g>>8&255]^x[255&c]^h[D],f=R[l>>>24]^I[g>>16&255]^C[c>>8&255]^x[255&E]^h[D+1],L=R[g>>>24]^I[c>>16&255]^C[E>>8&255]^x[255&l]^h[D+2],_=R[c>>>24]^I[E>>16&255]^C[l>>8&255]^x[255&g]^h[D+3],E=m,l=f,g=L,c=_,D+=4;m=v[E>>>24]<<24^v[l>>16&255]<<16^v[g>>8&255]<<8^v[255&c]^h[D],f=v[l>>>24]<<24^v[g>>16&255]<<16^v[c>>8&255]<<8^v[255&E]^h[D+1],L=v[g>>>24]<<24^v[c>>16&255]<<16^v[E>>8&255]<<8^v[255&l]^h[D+2],_=v[c>>>24]<<24^v[E>>16&255]<<16^v[l>>8&255]<<8^v[255&g]^h[D+3],K[o]=z(m^P),K[o+1]=z(_^M),K[o+2]=z(L^F),K[o+3]=z(f^B),P=T,M=S,F=p,B=A,o+=4}return K.buffer},a}()},"./src/crypt/decrypter.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return o});var n=r("./src/crypt/aes-crypto.ts"),i=r("./src/crypt/fast-aes-key.ts"),s=r("./src/crypt/aes-decryptor.ts"),a=r("./src/utils/logger.ts"),d=r("./src/utils/mp4-tools.ts"),u=r("./src/utils/typed-array.ts"),o=function(){function y(f,L,_){var E=(_===void 0?{}:_).removePKCS7Padding,l=E===void 0||E;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=f,this.config=L,this.removePKCS7Padding=l,l)try{var g=self.crypto;g&&(this.subtle=g.subtle||g.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var m=y.prototype;return m.destroy=function(){this.observer=null},m.isSync=function(){return this.config.enableSoftwareAES},m.flush=function(){var f=this.currentResult;if(f){var L=new Uint8Array(f);return this.reset(),this.removePKCS7Padding?Object(s.removePadding)(L):L}this.reset()},m.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},m.decrypt=function(f,L,_,E){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(f),L,_);var l=this.flush();l&&E(l.buffer)}else this.webCryptoDecrypt(new Uint8Array(f),L,_).then(E)},m.softwareDecrypt=function(f,L,_){var E=this.currentIV,l=this.currentResult,g=this.remainderData;this.logOnce("JS AES decrypt"),g&&(f=Object(d.appendUint8Array)(g,f),this.remainderData=null);var c=this.getValidChunk(f);if(!c.length)return null;E&&(_=E);var T=this.softwareDecrypter;T||(T=this.softwareDecrypter=new s.default),T.expandKey(L);var S=l;return this.currentResult=T.decrypt(c.buffer,0,_),this.currentIV=Object(u.sliceUint8)(c,-16).buffer,S||null},m.webCryptoDecrypt=function(f,L,_){var E=this,l=this.subtle;return this.key===L&&this.fastAesKey||(this.key=L,this.fastAesKey=new i.default(l,L)),this.fastAesKey.expandKey().then(function(g){return l?new n.default(l,_).decrypt(f.buffer,g):Promise.reject(new Error("web crypto not initialized"))}).catch(function(g){return E.onWebCryptoError(g,f,L,_)})},m.onWebCryptoError=function(f,L,_,E){return a.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",f),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(L,_,E)},m.getValidChunk=function(f){var L=f,_=f.length-f.length%16;return _!==f.length&&(L=Object(u.sliceUint8)(f,0,_),this.remainderData=Object(u.sliceUint8)(f,_)),L},m.logOnce=function(f){this.logEnabled&&(a.logger.log("[decrypter.ts]: "+f),this.logEnabled=!1)},y}()},"./src/crypt/fast-aes-key.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return n});var n=function(){function i(s,a){this.subtle=void 0,this.key=void 0,this.subtle=s,this.key=a}return i.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},i}()},"./src/demux/aacdemuxer.ts":function(t,e,r){r.r(e);var n=r("./src/demux/base-audio-demuxer.ts"),i=r("./src/demux/adts.ts"),s=r("./src/utils/logger.ts"),a=r("./src/demux/id3.ts");function d(o,y){return(d=Object.setPrototypeOf||function(m,f){return m.__proto__=f,m})(o,y)}var u=function(o){var y,m;function f(_,E){var l;return(l=o.call(this)||this).observer=void 0,l.config=void 0,l.observer=_,l.config=E,l}m=o,(y=f).prototype=Object.create(m.prototype),y.prototype.constructor=y,d(y,m);var L=f.prototype;return L.resetInitSegment=function(_,E,l){o.prototype.resetInitSegment.call(this,_,E,l),this._audioTrack={container:"audio/adts",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:_,duration:l,inputTimeScale:9e4,dropped:0}},f.probe=function(_){if(!_)return!1;for(var E=(a.getID3Data(_,0)||[]).length,l=_.length;E<l;E++)if(i.probe(_,E))return s.logger.log("ADTS sync word found !"),!0;return!1},L.canParse=function(_,E){return i.canParse(_,E)},L.appendFrame=function(_,E,l){i.initTrackConfig(_,this.observer,E,l,_.manifestCodec);var g=i.appendFrame(_,E,l,this.initPTS,this.frameIndex);if(g&&g.missing===0)return g},f}(n.default);u.minProbeByteLength=9,e.default=u},"./src/demux/adts.ts":function(t,e,r){r.r(e),r.d(e,"getAudioConfig",function(){return a}),r.d(e,"isHeaderPattern",function(){return d}),r.d(e,"getHeaderLength",function(){return u}),r.d(e,"getFullFrameLength",function(){return o}),r.d(e,"canGetFrameLength",function(){return y}),r.d(e,"isHeader",function(){return m}),r.d(e,"canParse",function(){return f}),r.d(e,"probe",function(){return L}),r.d(e,"initTrackConfig",function(){return _}),r.d(e,"getFrameDuration",function(){return E}),r.d(e,"parseFrameHeader",function(){return l}),r.d(e,"appendFrame",function(){return g});var n=r("./src/utils/logger.ts"),i=r("./src/errors.ts"),s=r("./src/events.ts");function a(c,T,S,p){var A,D,w,k,h=navigator.userAgent.toLowerCase(),v=p,b=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];A=1+((192&T[S+2])>>>6);var R=(60&T[S+2])>>>2;if(!(R>b.length-1))return w=(1&T[S+2])<<2,w|=(192&T[S+3])>>>6,n.logger.log("manifest codec:"+p+", ADTS type:"+A+", samplingIndex:"+R),/firefox/i.test(h)?R>=6?(A=5,k=new Array(4),D=R-3):(A=2,k=new Array(2),D=R):h.indexOf("android")!==-1?(A=2,k=new Array(2),D=R):(A=5,k=new Array(4),p&&(p.indexOf("mp4a.40.29")!==-1||p.indexOf("mp4a.40.5")!==-1)||!p&&R>=6?D=R-3:((p&&p.indexOf("mp4a.40.2")!==-1&&(R>=6&&w===1||/vivaldi/i.test(h))||!p&&w===1)&&(A=2,k=new Array(2)),D=R)),k[0]=A<<3,k[0]|=(14&R)>>1,k[1]|=(1&R)<<7,k[1]|=w<<3,A===5&&(k[1]|=(14&D)>>1,k[2]=(1&D)<<7,k[2]|=8,k[3]=0),{config:k,samplerate:b[R],channelCount:w,codec:"mp4a.40."+A,manifestCodec:v};c.trigger(s.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+R})}function d(c,T){return c[T]===255&&(246&c[T+1])==240}function u(c,T){return 1&c[T+1]?7:9}function o(c,T){return(3&c[T+3])<<11|c[T+4]<<3|(224&c[T+5])>>>5}function y(c,T){return T+5<c.length}function m(c,T){return T+1<c.length&&d(c,T)}function f(c,T){return y(c,T)&&d(c,T)&&o(c,T)<=c.length-T}function L(c,T){if(m(c,T)){var S=u(c,T);if(T+S>=c.length)return!1;var p=o(c,T);if(p<=S)return!1;var A=T+p;return A===c.length||m(c,A)}return!1}function _(c,T,S,p,A){if(!c.samplerate){var D=a(T,S,p,A);if(!D)return;c.config=D.config,c.samplerate=D.samplerate,c.channelCount=D.channelCount,c.codec=D.codec,c.manifestCodec=D.manifestCodec,n.logger.log("parsed codec:"+c.codec+", rate:"+D.samplerate+", channels:"+D.channelCount)}}function E(c){return 9216e4/c}function l(c,T,S,p,A){var D=u(c,T),w=o(c,T);if((w-=D)>0)return{headerLength:D,frameLength:w,stamp:S+p*A}}function g(c,T,S,p,A){var D=l(T,S,p,A,E(c.samplerate));if(D){var w,k=D.frameLength,h=D.headerLength,v=D.stamp,b=h+k,R=Math.max(0,S+b-T.length);R?(w=new Uint8Array(b-h)).set(T.subarray(S+h,T.length),0):w=T.subarray(S+h,S+b);var I={unit:w,pts:v};return R||c.samples.push(I),{sample:I,length:b,missing:R}}}},"./src/demux/base-audio-demuxer.ts":function(t,e,r){r.r(e),r.d(e,"initPTSFn",function(){return o});var n=r("./src/polyfills/number.ts"),i=r("./src/demux/id3.ts"),s=r("./src/demux/dummy-demuxed-track.ts"),a=r("./src/utils/mp4-tools.ts"),d=r("./src/utils/typed-array.ts"),u=function(){function y(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var m=y.prototype;return m.resetInitSegment=function(f,L,_){this._id3Track={type:"id3",id:0,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},m.resetTimeStamp=function(){},m.resetContiguity=function(){},m.canParse=function(f,L){return!1},m.appendFrame=function(f,L,_){},m.demux=function(f,L){this.cachedData&&(f=Object(a.appendUint8Array)(this.cachedData,f),this.cachedData=null);var _,E,l=i.getID3Data(f,0),g=l?l.length:0,c=this._audioTrack,T=this._id3Track,S=l?i.getTimeStamp(l):void 0,p=f.length;for(this.frameIndex!==0&&this.initPTS!==null||(this.initPTS=o(S,L)),l&&l.length>0&&T.samples.push({pts:this.initPTS,dts:this.initPTS,data:l}),E=this.initPTS;g<p;){if(this.canParse(f,g)){var A=this.appendFrame(c,f,g);A?(this.frameIndex++,E=A.sample.pts,_=g+=A.length):g=p}else i.canParse(f,g)?(l=i.getID3Data(f,g),T.samples.push({pts:E,dts:E,data:l}),_=g+=l.length):g++;if(g===p&&_!==p){var D=Object(d.sliceUint8)(f,_);this.cachedData?this.cachedData=Object(a.appendUint8Array)(this.cachedData,D):this.cachedData=D}}return{audioTrack:c,avcTrack:Object(s.dummyTrack)(),id3Track:T,textTrack:Object(s.dummyTrack)()}},m.demuxSampleAes=function(f,L,_){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},m.flush=function(f){var L=this.cachedData;return L&&(this.cachedData=null,this.demux(L,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(s.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(s.dummyTrack)()}},m.destroy=function(){},y}(),o=function(y,m){return Object(n.isFiniteNumber)(y)?90*y:9e4*m};e.default=u},"./src/demux/chunk-cache.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return n});var n=function(){function i(){this.chunks=[],this.dataLength=0}var s=i.prototype;return s.push=function(a){this.chunks.push(a),this.dataLength+=a.length},s.flush=function(){var a,d=this.chunks,u=this.dataLength;return d.length?(a=d.length===1?d[0]:function(o,y){for(var m=new Uint8Array(y),f=0,L=0;L<o.length;L++){var _=o[L];m.set(_,f),f+=_.length}return m}(d,u),this.reset(),a):new Uint8Array(0)},s.reset=function(){this.chunks.length=0,this.dataLength=0},i}()},"./src/demux/dummy-demuxed-track.ts":function(t,e,r){function n(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}r.r(e),r.d(e,"dummyTrack",function(){return n})},"./src/demux/exp-golomb.ts":function(t,e,r){r.r(e);var n=r("./src/utils/logger.ts"),i=function(){function s(d){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=d,this.bytesAvailable=d.byteLength,this.word=0,this.bitsAvailable=0}var a=s.prototype;return a.loadWord=function(){var d=this.data,u=this.bytesAvailable,o=d.byteLength-u,y=new Uint8Array(4),m=Math.min(4,u);if(m===0)throw new Error("no bytes available");y.set(d.subarray(o,o+m)),this.word=new DataView(y.buffer).getUint32(0),this.bitsAvailable=8*m,this.bytesAvailable-=m},a.skipBits=function(d){var u;this.bitsAvailable>d?(this.word<<=d,this.bitsAvailable-=d):(d-=this.bitsAvailable,d-=(u=d>>3)>>3,this.bytesAvailable-=u,this.loadWord(),this.word<<=d,this.bitsAvailable-=d)},a.readBits=function(d){var u=Math.min(this.bitsAvailable,d),o=this.word>>>32-u;return d>32&&n.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=u,this.bitsAvailable>0?this.word<<=u:this.bytesAvailable>0&&this.loadWord(),(u=d-u)>0&&this.bitsAvailable?o<<u|this.readBits(u):o},a.skipLZ=function(){var d;for(d=0;d<this.bitsAvailable;++d)if(this.word&2147483648>>>d)return this.word<<=d,this.bitsAvailable-=d,d;return this.loadWord(),d+this.skipLZ()},a.skipUEG=function(){this.skipBits(1+this.skipLZ())},a.skipEG=function(){this.skipBits(1+this.skipLZ())},a.readUEG=function(){var d=this.skipLZ();return this.readBits(d+1)-1},a.readEG=function(){var d=this.readUEG();return 1&d?1+d>>>1:-1*(d>>>1)},a.readBoolean=function(){return this.readBits(1)===1},a.readUByte=function(){return this.readBits(8)},a.readUShort=function(){return this.readBits(16)},a.readUInt=function(){return this.readBits(32)},a.skipScalingList=function(d){for(var u=8,o=8,y=0;y<d;y++)o!==0&&(o=(u+this.readEG()+256)%256),u=o===0?u:o},a.readSPS=function(){var d,u,o,y=0,m=0,f=0,L=0,_=this.readUByte.bind(this),E=this.readBits.bind(this),l=this.readUEG.bind(this),g=this.readBoolean.bind(this),c=this.skipBits.bind(this),T=this.skipEG.bind(this),S=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);_();var A=_();if(E(5),c(3),_(),S(),A===100||A===110||A===122||A===244||A===44||A===83||A===86||A===118||A===128){var D=l();if(D===3&&c(1),S(),S(),c(1),g())for(u=D!==3?8:12,o=0;o<u;o++)g()&&p(o<6?16:64)}S();var w=l();if(w===0)l();else if(w===1)for(c(1),T(),T(),d=l(),o=0;o<d;o++)T();S(),c(1);var k=l(),h=l(),v=E(1);v===0&&c(1),c(1),g()&&(y=l(),m=l(),f=l(),L=l());var b=[1,1];if(g()&&g())switch(_()){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:b=[_()<<8|_(),_()<<8|_()]}return{width:Math.ceil(16*(k+1)-2*y-2*m),height:(2-v)*(h+1)*16-(v?2:4)*(f+L),pixelRatio:b}},a.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},s}();e.default=i},"./src/demux/id3.ts":function(t,e,r){r.r(e),r.d(e,"isHeader",function(){return i}),r.d(e,"isFooter",function(){return s}),r.d(e,"getID3Data",function(){return a}),r.d(e,"canParse",function(){return u}),r.d(e,"getTimeStamp",function(){return o}),r.d(e,"isTimeStampFrame",function(){return y}),r.d(e,"getID3Frames",function(){return f}),r.d(e,"decodeFrame",function(){return L}),r.d(e,"utf8ArrayToStr",function(){return c}),r.d(e,"testables",function(){return T});var n,i=function(S,p){return p+10<=S.length&&S[p]===73&&S[p+1]===68&&S[p+2]===51&&S[p+3]<255&&S[p+4]<255&&S[p+6]<128&&S[p+7]<128&&S[p+8]<128&&S[p+9]<128},s=function(S,p){return p+10<=S.length&&S[p]===51&&S[p+1]===68&&S[p+2]===73&&S[p+3]<255&&S[p+4]<255&&S[p+6]<128&&S[p+7]<128&&S[p+8]<128&&S[p+9]<128},a=function(S,p){for(var A=p,D=0;i(S,p);)D+=10,D+=d(S,p+6),s(S,p+10)&&(D+=10),p+=D;if(D>0)return S.subarray(A,A+D)},d=function(S,p){var A=0;return A=(127&S[p])<<21,A|=(127&S[p+1])<<14,A|=(127&S[p+2])<<7,A|=127&S[p+3]},u=function(S,p){return i(S,p)&&d(S,p+6)+10<=S.length-p},o=function(S){for(var p=f(S),A=0;A<p.length;A++){var D=p[A];if(y(D))return g(D)}},y=function(S){return S&&S.key==="PRIV"&&S.info==="com.apple.streaming.transportStreamTimestamp"},m=function(S){var p=String.fromCharCode(S[0],S[1],S[2],S[3]),A=d(S,4);return{type:p,size:A,data:S.subarray(10,10+A)}},f=function(S){for(var p=0,A=[];i(S,p);){for(var D=d(S,p+6),w=(p+=10)+D;p+8<w;){var k=m(S.subarray(p)),h=L(k);h&&A.push(h),p+=k.size+10}s(S,p)&&(p+=10)}return A},L=function(S){return S.type==="PRIV"?_(S):S.type[0]==="W"?l(S):E(S)},_=function(S){if(!(S.size<2)){var p=c(S.data,!0),A=new Uint8Array(S.data.subarray(p.length+1));return{key:S.type,info:p,data:A.buffer}}},E=function(S){if(!(S.size<2)){if(S.type==="TXXX"){var p=1,A=c(S.data.subarray(p),!0);p+=A.length+1;var D=c(S.data.subarray(p));return{key:S.type,info:A,data:D}}var w=c(S.data.subarray(1));return{key:S.type,data:w}}},l=function(S){if(S.type==="WXXX"){if(S.size<2)return;var p=1,A=c(S.data.subarray(p),!0);p+=A.length+1;var D=c(S.data.subarray(p));return{key:S.type,info:A,data:D}}var w=c(S.data);return{key:S.type,data:w}},g=function(S){if(S.data.byteLength===8){var p=new Uint8Array(S.data),A=1&p[3],D=(p[4]<<23)+(p[5]<<15)+(p[6]<<7)+p[7];return D/=45,A&&(D+=4772185884e-2),Math.round(D)}},c=function(S,p){p===void 0&&(p=!1);var A=(n||self.TextDecoder===void 0||(n=new self.TextDecoder("utf-8")),n);if(A){var D=A.decode(S);if(p){var w=D.indexOf("\0");return w!==-1?D.substring(0,w):D}return D.replace(/\0/g,"")}for(var k,h,v,b=S.length,R="",I=0;I<b;){if((k=S[I++])===0&&p)return R;if(k!==0&&k!==3)switch(k>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:R+=String.fromCharCode(k);break;case 12:case 13:h=S[I++],R+=String.fromCharCode((31&k)<<6|63&h);break;case 14:h=S[I++],v=S[I++],R+=String.fromCharCode((15&k)<<12|(63&h)<<6|(63&v)<<0)}}return R},T={decodeTextFrame:E}},"./src/demux/mp3demuxer.ts":function(t,e,r){r.r(e);var n=r("./src/demux/base-audio-demuxer.ts"),i=r("./src/demux/id3.ts"),s=r("./src/utils/logger.ts"),a=r("./src/demux/mpegaudio.ts");function d(o,y){return(d=Object.setPrototypeOf||function(m,f){return m.__proto__=f,m})(o,y)}var u=function(o){var y,m;function f(){return o.apply(this,arguments)||this}m=o,(y=f).prototype=Object.create(m.prototype),y.prototype.constructor=y,d(y,m);var L=f.prototype;return L.resetInitSegment=function(_,E,l){o.prototype.resetInitSegment.call(this,_,E,l),this._audioTrack={container:"audio/mpeg",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:_,duration:l,inputTimeScale:9e4,dropped:0}},f.probe=function(_){if(!_)return!1;for(var E=(i.getID3Data(_,0)||[]).length,l=_.length;E<l;E++)if(a.probe(_,E))return s.logger.log("MPEG Audio sync word found !"),!0;return!1},L.canParse=function(_,E){return a.canParse(_,E)},L.appendFrame=function(_,E,l){if(this.initPTS!==null)return a.appendFrame(_,E,l,this.initPTS,this.frameIndex)},f}(n.default);u.minProbeByteLength=4,e.default=u},"./src/demux/mp4demuxer.ts":function(t,e,r){r.r(e);var n=r("./src/utils/mp4-tools.ts"),i=r("./src/demux/dummy-demuxed-track.ts"),s=function(){function a(u,o){this.remainderData=null,this.config=void 0,this.config=o}var d=a.prototype;return d.resetTimeStamp=function(){},d.resetInitSegment=function(){},d.resetContiguity=function(){},a.probe=function(u){return Object(n.findBox)({data:u,start:0,end:Math.min(u.length,16384)},["moof"]).length>0},d.demux=function(u){var o=u,y=Object(i.dummyTrack)();if(this.config.progressive){this.remainderData&&(o=Object(n.appendUint8Array)(this.remainderData,u));var m=Object(n.segmentValidRange)(o);this.remainderData=m.remainder,y.samples=m.valid||new Uint8Array}else y.samples=o;return{audioTrack:Object(i.dummyTrack)(),avcTrack:y,id3Track:Object(i.dummyTrack)(),textTrack:Object(i.dummyTrack)()}},d.flush=function(){var u=Object(i.dummyTrack)();return u.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(i.dummyTrack)(),avcTrack:u,id3Track:Object(i.dummyTrack)(),textTrack:Object(i.dummyTrack)()}},d.demuxSampleAes=function(u,o,y){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},d.destroy=function(){},a}();s.minProbeByteLength=1024,e.default=s},"./src/demux/mpegaudio.ts":function(t,e,r){r.r(e),r.d(e,"appendFrame",function(){return u}),r.d(e,"parseHeader",function(){return o}),r.d(e,"isHeaderPattern",function(){return y}),r.d(e,"isHeader",function(){return m}),r.d(e,"canParse",function(){return f}),r.d(e,"probe",function(){return L});var n=null,i=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],s=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],a=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],d=[0,1,1,4];function u(_,E,l,g,c){if(!(l+24>E.length)){var T=o(E,l);if(T&&l+T.frameLength<=E.length){var S=g+c*(9e4*T.samplesPerFrame/T.sampleRate),p={unit:E.subarray(l,l+T.frameLength),pts:S,dts:S};return _.config=[],_.channelCount=T.channelCount,_.samplerate=T.sampleRate,_.samples.push(p),{sample:p,length:T.frameLength,missing:0}}}}function o(_,E){var l=_[E+1]>>3&3,g=_[E+1]>>1&3,c=_[E+2]>>4&15,T=_[E+2]>>2&3;if(l!==1&&c!==0&&c!==15&&T!==3){var S=_[E+2]>>1&1,p=_[E+3]>>6,A=1e3*i[14*(l===3?3-g:g===3?3:4)+c-1],D=s[3*(l===3?0:l===2?1:2)+T],w=p===3?1:2,k=a[l][g],h=d[g],v=8*k*h,b=Math.floor(k*A/D+S)*h;if(n===null){var R=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);n=R?parseInt(R[1]):0}return n&&n<=87&&g===2&&A>=224e3&&p===0&&(_[E+3]=128|_[E+3]),{sampleRate:D,channelCount:w,frameLength:b,samplesPerFrame:v}}}function y(_,E){return _[E]===255&&(224&_[E+1])==224&&(6&_[E+1])!=0}function m(_,E){return E+1<_.length&&y(_,E)}function f(_,E){return y(_,E)&&4<=_.length-E}function L(_,E){if(E+1<_.length&&y(_,E)){var l=o(_,E),g=4;l!=null&&l.frameLength&&(g=l.frameLength);var c=E+g;return c===_.length||m(_,c)}return!1}},"./src/demux/sample-aes.ts":function(t,e,r){r.r(e);var n=r("./src/crypt/decrypter.ts"),i=r("./src/demux/tsdemuxer.ts"),s=function(){function a(u,o,y){this.keyData=void 0,this.decrypter=void 0,this.keyData=y,this.decrypter=new n.default(u,o,{removePKCS7Padding:!1})}var d=a.prototype;return d.decryptBuffer=function(u,o){this.decrypter.decrypt(u,this.keyData.key.buffer,this.keyData.iv.buffer,o)},d.decryptAacSample=function(u,o,y,m){var f=u[o].unit,L=f.subarray(16,f.length-f.length%16),_=L.buffer.slice(L.byteOffset,L.byteOffset+L.length),E=this;this.decryptBuffer(_,function(l){var g=new Uint8Array(l);f.set(g,16),m||E.decryptAacSamples(u,o+1,y)})},d.decryptAacSamples=function(u,o,y){for(;;o++){if(o>=u.length)return void y();if(!(u[o].unit.length<32)){var m=this.decrypter.isSync();if(this.decryptAacSample(u,o,y,m),!m)return}}},d.getAvcEncryptedData=function(u){for(var o=16*Math.floor((u.length-48)/160)+16,y=new Int8Array(o),m=0,f=32;f<=u.length-16;f+=160,m+=16)y.set(u.subarray(f,f+16),m);return y},d.getAvcDecryptedUnit=function(u,o){for(var y=new Uint8Array(o),m=0,f=32;f<=u.length-16;f+=160,m+=16)u.set(y.subarray(m,m+16),f);return u},d.decryptAvcSample=function(u,o,y,m,f,L){var _=Object(i.discardEPB)(f.data),E=this.getAvcEncryptedData(_),l=this;this.decryptBuffer(E.buffer,function(g){f.data=l.getAvcDecryptedUnit(_,g),L||l.decryptAvcSamples(u,o,y+1,m)})},d.decryptAvcSamples=function(u,o,y,m){if(u instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;o++,y=0){if(o>=u.length)return void m();for(var f=u[o].units;!(y>=f.length);y++){var L=f[y];if(!(L.data.length<=48||L.type!==1&&L.type!==5)){var _=this.decrypter.isSync();if(this.decryptAvcSample(u,o,y,m,L,_),!_)return}}}},a}();e.default=s},"./src/demux/transmuxer-interface.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return m});var n=r("./node_modules/webworkify-webpack/index.js"),i=r("./src/events.ts"),s=r("./src/demux/transmuxer.ts"),a=r("./src/utils/logger.ts"),d=r("./src/errors.ts"),u=r("./src/utils/mediasource-helper.ts"),o=r("./node_modules/eventemitter3/index.js"),y=Object(u.getMediaSource)()||{isTypeSupported:function(){return!1}},m=function(){function f(_,E,l,g){var c=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=_,this.id=E,this.onTransmuxComplete=l,this.onFlush=g;var T=_.config,S=function(w,k){(k=k||{}).frag=c.frag,k.id=c.id,_.trigger(w,k)};this.observer=new o.EventEmitter,this.observer.on(i.Events.FRAG_DECRYPTED,S),this.observer.on(i.Events.ERROR,S);var p={mp4:y.isTypeSupported("video/mp4"),mpeg:y.isTypeSupported("audio/mpeg"),mp3:y.isTypeSupported('audio/mp4; codecs="mp3"')},A=navigator.vendor;if(T.enableWorker&&typeof Worker<"u"){var D;a.logger.log("demuxing in webworker");try{D=this.worker=n("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),D.addEventListener("message",this.onwmsg),D.onerror=function(w){_.trigger(i.Events.ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(w.message+"  ("+w.filename+":"+w.lineno+")")})},D.postMessage({cmd:"init",typeSupported:p,vendor:A,id:E,config:JSON.stringify(T)})}catch(w){a.logger.warn("Error in worker:",w),a.logger.error("Error while initializing DemuxerWorker, fallback to inline"),D&&self.URL.revokeObjectURL(D.objectURL),this.transmuxer=new s.default(this.observer,p,T,A,E),this.worker=null}}else this.transmuxer=new s.default(this.observer,p,T,A,E)}var L=f.prototype;return L.destroy=function(){var _=this.worker;if(_)_.removeEventListener("message",this.onwmsg),_.terminate(),this.worker=null;else{var E=this.transmuxer;E&&(E.destroy(),this.transmuxer=null)}var l=this.observer;l&&l.removeAllListeners(),this.observer=null},L.push=function(_,E,l,g,c,T,S,p,A,D){var w=this;A.transmuxing.start=self.performance.now();var k=this.transmuxer,h=this.worker,v=T?T.start:c.start,b=c.decryptdata,R=this.frag,I=!(R&&c.cc===R.cc),C=!(R&&A.level===R.level),x=R?A.sn-R.sn:-1,O=this.part?A.part-this.part.index:1,P=!C&&(x===1||x===0&&O===1),M=self.performance.now();(C||x||c.stats.parsing.start===0)&&(c.stats.parsing.start=M),!T||!O&&P||(T.stats.parsing.start=M);var F=new s.TransmuxState(I,P,p,C,v);if(!P||I){a.logger.log("[transmuxer-interface, "+c.type+"]: Starting new transmux session for sn: "+A.sn+" p: "+A.part+" level: "+A.level+" id: "+A.id+`
        discontinuity: `+I+`
        trackSwitch: `+C+`
        contiguous: `+P+`
        accurateTimeOffset: `+p+`
        timeOffset: `+v);var B=new s.TransmuxConfig(l,g,E,S,D);this.configureTransmuxer(B)}if(this.frag=c,this.part=T,h)h.postMessage({cmd:"demux",data:_,decryptdata:b,chunkMeta:A,state:F},_ instanceof ArrayBuffer?[_]:[]);else if(k){var j=k.push(_,b,A,F);Object(s.isPromise)(j)?j.then(function(K){w.handleTransmuxComplete(K)}):this.handleTransmuxComplete(j)}},L.flush=function(_){var E=this;_.transmuxing.start=self.performance.now();var l=this.transmuxer,g=this.worker;if(g)g.postMessage({cmd:"flush",chunkMeta:_});else if(l){var c=l.flush(_);Object(s.isPromise)(c)?c.then(function(T){E.handleFlushResult(T,_)}):this.handleFlushResult(c,_)}},L.handleFlushResult=function(_,E){var l=this;_.forEach(function(g){l.handleTransmuxComplete(g)}),this.onFlush(E)},L.onWorkerMessage=function(_){var E=_.data,l=this.hls;switch(E.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(E.data);break;case"flush":this.onFlush(E.data);break;default:E.data=E.data||{},E.data.frag=this.frag,E.data.id=this.id,l.trigger(E.event,E.data)}},L.configureTransmuxer=function(_){var E=this.worker,l=this.transmuxer;E?E.postMessage({cmd:"configure",config:_}):l&&l.configure(_)},L.handleTransmuxComplete=function(_){_.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(_)},f}()},"./src/demux/transmuxer-worker.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return d});var n=r("./src/demux/transmuxer.ts"),i=r("./src/events.ts"),s=r("./src/utils/logger.ts"),a=r("./node_modules/eventemitter3/index.js");function d(m){var f=new a.EventEmitter,L=function(_,E){m.postMessage({event:_,data:E})};f.on(i.Events.FRAG_DECRYPTED,L),f.on(i.Events.ERROR,L),m.addEventListener("message",function(_){var E=_.data;switch(E.cmd){case"init":var l=JSON.parse(E.config);m.transmuxer=new n.default(f,E.typeSupported,l,E.vendor,E.id),Object(s.enableLogs)(l.debug),L("init",null);break;case"configure":m.transmuxer.configure(E.config);break;case"demux":var g=m.transmuxer.push(E.data,E.decryptdata,E.chunkMeta,E.state);Object(n.isPromise)(g)?g.then(function(S){u(m,S)}):u(m,g);break;case"flush":var c=E.chunkMeta,T=m.transmuxer.flush(c);Object(n.isPromise)(T)?T.then(function(S){y(m,S,c)}):y(m,T,c)}})}function u(m,f){if((L=f.remuxResult).audio||L.video||L.text||L.id3||L.initSegment){var L,_=[],E=f.remuxResult,l=E.audio,g=E.video;l&&o(_,l),g&&o(_,g),m.postMessage({event:"transmuxComplete",data:f},_)}}function o(m,f){f.data1&&m.push(f.data1.buffer),f.data2&&m.push(f.data2.buffer)}function y(m,f,L){f.forEach(function(_){u(m,_)}),m.postMessage({event:"flush",data:L})}},"./src/demux/transmuxer.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return c}),r.d(e,"isPromise",function(){return S}),r.d(e,"TransmuxConfig",function(){return p}),r.d(e,"TransmuxState",function(){return A});var n,i=r("./src/events.ts"),s=r("./src/errors.ts"),a=r("./src/crypt/decrypter.ts"),d=r("./src/demux/aacdemuxer.ts"),u=r("./src/demux/mp4demuxer.ts"),o=r("./src/demux/tsdemuxer.ts"),y=r("./src/demux/mp3demuxer.ts"),m=r("./src/remux/mp4-remuxer.ts"),f=r("./src/remux/passthrough-remuxer.ts"),L=r("./src/demux/chunk-cache.ts"),_=r("./src/utils/mp4-tools.ts"),E=r("./src/utils/logger.ts");try{n=self.performance.now.bind(self.performance)}catch{E.logger.debug("Unable to use Performance API on this environment"),n=self.Date.now}var l=[{demux:o.default,remux:m.default},{demux:u.default,remux:f.default},{demux:d.default,remux:m.default},{demux:y.default,remux:m.default}],g=1024;l.forEach(function(D){var w=D.demux;g=Math.max(g,w.minProbeByteLength)});var c=function(){function D(k,h,v,b,R){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new L.default,this.observer=k,this.typeSupported=h,this.config=v,this.vendor=b,this.id=R}var w=D.prototype;return w.configure=function(k){this.transmuxConfig=k,this.decrypter&&this.decrypter.reset()},w.push=function(k,h,v,b){var R=this,I=v.transmuxing;I.executeStart=n();var C=new Uint8Array(k),x=this.cache,O=this.config,P=this.currentTransmuxState,M=this.transmuxConfig;b&&(this.currentTransmuxState=b);var F=function($,ee){var X=null;return $.byteLength>0&&ee!=null&&ee.key!=null&&ee.iv!==null&&ee.method!=null&&(X=ee),X}(C,h);if(F&&F.method==="AES-128"){var B=this.getDecrypter();if(!O.enableSoftwareAES)return this.decryptionPromise=B.webCryptoDecrypt(C,F.key.buffer,F.iv.buffer).then(function($){var ee=R.push($,null,v);return R.decryptionPromise=null,ee}),this.decryptionPromise;var j=B.softwareDecrypt(C,F.key.buffer,F.iv.buffer);if(!j)return I.executeEnd=n(),T(v);C=new Uint8Array(j)}var K=b||P,z=K.contiguous,re=K.discontinuity,ne=K.trackSwitch,V=K.accurateTimeOffset,q=K.timeOffset,Y=M.audioCodec,ie=M.videoCodec,ue=M.defaultInitPts,N=M.duration,U=M.initSegmentData;if((re||ne)&&this.resetInitSegment(U,Y,ie,N),re&&this.resetInitialTimestamp(ue),z||this.resetContiguity(),this.needsProbing(C,re,ne)){if(x.dataLength){var G=x.flush();C=Object(_.appendUint8Array)(G,C)}this.configureTransmuxer(C,M)}var H=this.transmux(C,F,q,V,v),W=this.currentTransmuxState;return W.contiguous=!0,W.discontinuity=!1,W.trackSwitch=!1,I.executeEnd=n(),H},w.flush=function(k){var h=this,v=k.transmuxing;v.executeStart=n();var b=this.decrypter,R=this.cache,I=this.currentTransmuxState,C=this.decryptionPromise;if(C)return C.then(function(){return h.flush(k)});var x=[],O=I.timeOffset;if(b){var P=b.flush();P&&x.push(this.push(P,null,k))}var M=R.dataLength;R.reset();var F=this.demuxer,B=this.remuxer;if(!F||!B)return M>=g&&this.observer.emit(i.Events.ERROR,i.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),v.executeEnd=n(),[T(k)];var j=F.flush(O);return S(j)?j.then(function(K){return h.flushRemux(x,K,k),x}):(this.flushRemux(x,j,k),x)},w.flushRemux=function(k,h,v){var b=h.audioTrack,R=h.avcTrack,I=h.id3Track,C=h.textTrack,x=this.currentTransmuxState,O=x.accurateTimeOffset,P=x.timeOffset;E.logger.log("[transmuxer.ts]: Flushed fragment "+v.sn+(v.part>-1?" p: "+v.part:"")+" of level "+v.level);var M=this.remuxer.remux(b,R,I,C,P,O,!0,this.id);k.push({remuxResult:M,chunkMeta:v}),v.transmuxing.executeEnd=n()},w.resetInitialTimestamp=function(k){var h=this.demuxer,v=this.remuxer;h&&v&&(h.resetTimeStamp(k),v.resetTimeStamp(k))},w.resetContiguity=function(){var k=this.demuxer,h=this.remuxer;k&&h&&(k.resetContiguity(),h.resetNextTimestamp())},w.resetInitSegment=function(k,h,v,b){var R=this.demuxer,I=this.remuxer;R&&I&&(R.resetInitSegment(h,v,b),I.resetInitSegment(k,h,v))},w.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},w.transmux=function(k,h,v,b,R){return h&&h.method==="SAMPLE-AES"?this.transmuxSampleAes(k,h,v,b,R):this.transmuxUnencrypted(k,v,b,R)},w.transmuxUnencrypted=function(k,h,v,b){var R=this.demuxer.demux(k,h,!1,!this.config.progressive),I=R.audioTrack,C=R.avcTrack,x=R.id3Track,O=R.textTrack;return{remuxResult:this.remuxer.remux(I,C,x,O,h,v,!1,this.id),chunkMeta:b}},w.transmuxSampleAes=function(k,h,v,b,R){var I=this;return this.demuxer.demuxSampleAes(k,h,v).then(function(C){return{remuxResult:I.remuxer.remux(C.audioTrack,C.avcTrack,C.id3Track,C.textTrack,v,b,!1,I.id),chunkMeta:R}})},w.configureTransmuxer=function(k,h){for(var v,b=this.config,R=this.observer,I=this.typeSupported,C=this.vendor,x=h.audioCodec,O=h.defaultInitPts,P=h.duration,M=h.initSegmentData,F=h.videoCodec,B=0,j=l.length;B<j;B++)if(l[B].demux.probe(k)){v=l[B];break}v||(E.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),v={demux:u.default,remux:f.default});var K=this.demuxer,z=this.remuxer,re=v.remux,ne=v.demux;z&&z instanceof re||(this.remuxer=new re(R,b,I,C)),K&&K instanceof ne||(this.demuxer=new ne(R,b,I),this.probe=ne.probe),this.resetInitSegment(M,x,F,P),this.resetInitialTimestamp(O)},w.needsProbing=function(k,h,v){return!this.demuxer||!this.remuxer||h||v},w.getDecrypter=function(){var k=this.decrypter;return k||(k=this.decrypter=new a.default(this.observer,this.config)),k},D}(),T=function(D){return{remuxResult:{},chunkMeta:D}};function S(D){return"then"in D&&D.then instanceof Function}var p=function(D,w,k,h,v){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=D,this.videoCodec=w,this.initSegmentData=k,this.duration=h,this.defaultInitPts=v},A=function(D,w,k,h,v){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.discontinuity=D,this.contiguous=w,this.accurateTimeOffset=k,this.trackSwitch=h,this.timeOffset=v}},"./src/demux/tsdemuxer.ts":function(t,e,r){r.r(e),r.d(e,"discardEPB",function(){return S});var n=r("./src/demux/adts.ts"),i=r("./src/demux/mpegaudio.ts"),s=r("./src/demux/exp-golomb.ts"),a=r("./src/demux/id3.ts"),d=r("./src/demux/sample-aes.ts"),u=r("./src/events.ts"),o=r("./src/utils/mp4-tools.ts"),y=r("./src/utils/logger.ts"),m=r("./src/errors.ts"),f={video:1,audio:2,id3:3,text:4},L=function(){function p(D,w,k){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=D,this.config=w,this.typeSupported=k}p.probe=function(D){var w=p.syncOffset(D);return!(w<0||(w&&y.logger.warn("MPEG2-TS detected but first sync word found @ offset "+w+", junk ahead ?"),0))},p.syncOffset=function(D){for(var w=Math.min(1e3,D.length-564),k=0;k<w;){if(D[k]===71&&D[k+188]===71&&D[k+376]===71)return k;k++}return-1},p.createTrack=function(D,w){return{container:D==="video"||D==="audio"?"video/mp2t":void 0,type:D,id:f[D],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:D==="audio"?w:void 0}};var A=p.prototype;return A.resetInitSegment=function(D,w,k){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=p.createTrack("video",k),this._audioTrack=p.createTrack("audio",k),this._id3Track=p.createTrack("id3",k),this._txtTrack=p.createTrack("text",k),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=D,this.videoCodec=w,this._duration=k},A.resetTimeStamp=function(){},A.resetContiguity=function(){var D=this._audioTrack,w=this._avcTrack,k=this._id3Track;D&&(D.pesData=null),w&&(w.pesData=null),k&&(k.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},A.demux=function(D,w,k,h){var v;k===void 0&&(k=!1),h===void 0&&(h=!1),k||(this.sampleAes=null);var b=this._avcTrack,R=this._audioTrack,I=this._id3Track,C=b.pid,x=b.pesData,O=R.pid,P=I.pid,M=R.pesData,F=I.pesData,B=!1,j=this.pmtParsed,K=this._pmtId,z=D.length;if(this.remainderData&&(z=(D=Object(o.appendUint8Array)(this.remainderData,D)).length,this.remainderData=null),z<188&&!h)return this.remainderData=D,{audioTrack:R,avcTrack:b,id3Track:I,textTrack:this._txtTrack};var re=Math.max(0,p.syncOffset(D));(z-=(z+re)%188)<D.byteLength&&!h&&(this.remainderData=new Uint8Array(D.buffer,z,D.buffer.byteLength-z));for(var ne=re;ne<z;ne+=188)if(D[ne]===71){var V=!!(64&D[ne+1]),q=((31&D[ne+1])<<8)+D[ne+2],Y=void 0;if((48&D[ne+3])>>4>1){if((Y=ne+5+D[ne+4])===ne+188)continue}else Y=ne+4;switch(q){case C:V&&(x&&(v=g(x))&&this.parseAVCPES(v,!1),x={data:[],size:0}),x&&(x.data.push(D.subarray(Y,ne+188)),x.size+=ne+188-Y);break;case O:V&&(M&&(v=g(M))&&(R.isAAC?this.parseAACPES(v):this.parseMPEGPES(v)),M={data:[],size:0}),M&&(M.data.push(D.subarray(Y,ne+188)),M.size+=ne+188-Y);break;case P:V&&(F&&(v=g(F))&&this.parseID3PES(v),F={data:[],size:0}),F&&(F.data.push(D.subarray(Y,ne+188)),F.size+=ne+188-Y);break;case 0:V&&(Y+=D[Y]+1),K=this._pmtId=E(D,Y);break;case K:V&&(Y+=D[Y]+1);var ie=l(D,Y,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,k);(C=ie.avc)>0&&(b.pid=C),(O=ie.audio)>0&&(R.pid=O,R.isAAC=ie.isAAC),(P=ie.id3)>0&&(I.pid=P),B&&!j&&(y.logger.log("reparse from beginning"),B=!1,ne=re-188),j=this.pmtParsed=!0;break;case 17:case 8191:break;default:B=!0}}else this.observer.emit(u.Events.ERROR,u.Events.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});b.pesData=x,R.pesData=M,I.pesData=F;var ue={audioTrack:R,avcTrack:b,id3Track:I,textTrack:this._txtTrack};return h&&this.extractRemainingSamples(ue),ue},A.flush=function(){var D,w=this.remainderData;return this.remainderData=null,D=w?this.demux(w,-1,!1,!0):{audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(D),this.sampleAes?this.decrypt(D,this.sampleAes):D},A.extractRemainingSamples=function(D){var w,k=D.audioTrack,h=D.avcTrack,v=D.id3Track,b=h.pesData,R=k.pesData,I=v.pesData;b&&(w=g(b))?(this.parseAVCPES(w,!0),h.pesData=null):h.pesData=b,R&&(w=g(R))?(k.isAAC?this.parseAACPES(w):this.parseMPEGPES(w),k.pesData=null):(R!=null&&R.size&&y.logger.log("last AAC PES packet truncated,might overlap between fragments"),k.pesData=R),I&&(w=g(I))?(this.parseID3PES(w),v.pesData=null):v.pesData=I},A.demuxSampleAes=function(D,w,k){var h=this.demux(D,k,!0,!this.config.progressive),v=this.sampleAes=new d.default(this.observer,this.config,w);return this.decrypt(h,v)},A.decrypt=function(D,w){return new Promise(function(k){var h=D.audioTrack,v=D.avcTrack;h.samples&&h.isAAC?w.decryptAacSamples(h.samples,0,function(){v.samples?w.decryptAvcSamples(v.samples,0,0,function(){k(D)}):k(D)}):v.samples&&w.decryptAvcSamples(v.samples,0,0,function(){k(D)})})},A.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},A.parseAVCPES=function(D,w){var k,h=this,v=this._avcTrack,b=this.parseAVCNALu(D.data),R=this.avcSample,I=!1;D.data=null,R&&b.length&&!v.audFound&&(c(R,v),R=this.avcSample=_(!1,D.pts,D.dts,"")),b.forEach(function(C){switch(C.type){case 1:k=!0,R||(R=h.avcSample=_(!0,D.pts,D.dts,"")),R.frame=!0;var x=C.data;if(I&&x.length>4){var O=new s.default(x).readSliceType();O!==2&&O!==4&&O!==7&&O!==9||(R.key=!0)}break;case 5:k=!0,R||(R=h.avcSample=_(!0,D.pts,D.dts,"")),R.key=!0,R.frame=!0;break;case 6:k=!0;var P=new s.default(S(C.data));P.readUByte();for(var M=0,F=0,B=!1,j=0;!B&&P.bytesAvailable>1;){M=0;do M+=j=P.readUByte();while(j===255);F=0;do F+=j=P.readUByte();while(j===255);if(M===4&&P.bytesAvailable!==0){if(B=!0,P.readUByte()===181&&P.readUShort()===49&&P.readUInt()===1195456820&&P.readUByte()===3){for(var K=P.readUByte(),z=31&K,re=[K,P.readUByte()],ne=0;ne<z;ne++)re.push(P.readUByte()),re.push(P.readUByte()),re.push(P.readUByte());T(h._txtTrack.samples,{type:3,pts:D.pts,bytes:re})}}else if(M===5&&P.bytesAvailable!==0){if(B=!0,F>16){for(var V=[],q=0;q<16;q++)V.push(P.readUByte().toString(16)),q!==3&&q!==5&&q!==7&&q!==9||V.push("-");for(var Y=F-16,ie=new Uint8Array(Y),ue=0;ue<Y;ue++)ie[ue]=P.readUByte();T(h._txtTrack.samples,{pts:D.pts,payloadType:M,uuid:V.join(""),userData:Object(a.utf8ArrayToStr)(ie),userDataBytes:ie})}}else if(F<P.bytesAvailable)for(var N=0;N<F;N++)P.readUByte()}break;case 7:if(k=!0,I=!0,!v.sps){var U=new s.default(C.data).readSPS();v.width=U.width,v.height=U.height,v.pixelRatio=U.pixelRatio,v.sps=[C.data],v.duration=h._duration;for(var G=C.data.subarray(1,4),H="avc1.",W=0;W<3;W++){var $=G[W].toString(16);$.length<2&&($="0"+$),H+=$}v.codec=H}break;case 8:k=!0,v.pps||(v.pps=[C.data]);break;case 9:k=!1,v.audFound=!0,R&&c(R,v),R=h.avcSample=_(!1,D.pts,D.dts,"");break;case 12:k=!1;break;default:k=!1,R&&(R.debug+="unknown NAL "+C.type+" ")}R&&k&&R.units.push(C)}),w&&R&&(c(R,v),this.avcSample=null)},A.getLastNalUnit=function(){var D,w,k=this.avcSample;if(!k||k.units.length===0){var h=this._avcTrack.samples;k=h[h.length-1]}if((D=k)!==null&&D!==void 0&&D.units){var v=k.units;w=v[v.length-1]}return w},A.parseAVCNALu=function(D){var w,k,h=D.byteLength,v=this._avcTrack,b=v.naluState||0,R=b,I=[],C=0,x=-1,O=0;for(b===-1&&(x=0,O=31&D[0],b=0,C=1);C<h;)if(w=D[C++],b)if(b!==1)if(w)if(w===1){if(x>=0){var P={data:D.subarray(x,C-b-1),type:O};I.push(P)}else{var M=this.getLastNalUnit();if(M&&(R&&C<=4-R&&M.state&&(M.data=M.data.subarray(0,M.data.byteLength-R)),(k=C-b-1)>0)){var F=new Uint8Array(M.data.byteLength+k);F.set(M.data,0),F.set(D.subarray(0,k),M.data.byteLength),M.data=F}}C<h?(x=C,O=31&D[C],b=0):b=-1}else b=0;else b=3;else b=w?0:2;else b=w?0:1;if(x>=0&&b>=0){var B={data:D.subarray(x,h),type:O,state:b};I.push(B)}if(I.length===0){var j=this.getLastNalUnit();if(j){var K=new Uint8Array(j.data.byteLength+D.byteLength);K.set(j.data,0),K.set(D,j.data.byteLength),j.data=K}}return v.naluState=b,I},A.parseAACPES=function(D){var w,k,h,v,b,R=0,I=this._audioTrack,C=this.aacOverFlow,x=D.data;if(C){this.aacOverFlow=null;var O=C.sample.unit.byteLength,P=Math.min(C.missing,O),M=O-P;C.sample.unit.set(x.subarray(0,P),M),I.samples.push(C.sample),R=C.missing}for(w=R,k=x.length;w<k-1&&!n.isHeader(x,w);w++);if(w===R||(w<k-1?(h="AAC PES did not start with ADTS header,offset:"+w,v=!1):(h="no ADTS header found in AAC PES",v=!0),y.logger.warn("parsing error:"+h),this.observer.emit(u.Events.ERROR,u.Events.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.FRAG_PARSING_ERROR,fatal:v,reason:h}),!v)){if(n.initTrackConfig(I,this.observer,x,w,this.audioCodec),D.pts!==void 0)b=D.pts;else{if(!C)return void y.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var F=n.getFrameDuration(I.samplerate);b=C.sample.pts+F}for(var B=0;w<k;){if(n.isHeader(x,w)){if(w+5<k){var j=n.appendFrame(I,x,w,b,B);if(j){if(!j.missing){w+=j.length,B++;continue}this.aacOverFlow=j}}break}w++}}},A.parseMPEGPES=function(D){var w=D.data,k=w.length,h=0,v=0,b=D.pts;if(b!==void 0)for(;v<k;)if(i.isHeader(w,v)){var R=i.appendFrame(this._audioTrack,w,v,b,h);if(!R)break;v+=R.length,h++}else v++;else y.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},A.parseID3PES=function(D){D.pts!==void 0?this._id3Track.samples.push(D):y.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},p}();function _(p,A,D,w){return{key:p,frame:!1,pts:A,dts:D,units:[],debug:w,length:0}}function E(p,A){return(31&p[A+10])<<8|p[A+11]}function l(p,A,D,w){var k={audio:-1,avc:-1,id3:-1,isAAC:!0},h=A+3+((15&p[A+1])<<8|p[A+2])-4;for(A+=12+((15&p[A+10])<<8|p[A+11]);A<h;){var v=(31&p[A+1])<<8|p[A+2];switch(p[A]){case 207:if(!w){y.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:k.audio===-1&&(k.audio=v);break;case 21:k.id3===-1&&(k.id3=v);break;case 219:if(!w){y.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:k.avc===-1&&(k.avc=v);break;case 3:case 4:D?k.audio===-1&&(k.audio=v,k.isAAC=!1):y.logger.log("MPEG audio found, not supported in this browser");break;case 36:y.logger.warn("Unsupported HEVC stream type found")}A+=5+((15&p[A+3])<<8|p[A+4])}return k}function g(p){var A,D,w,k,h,v=0,b=p.data;if(!p||p.size===0)return null;for(;b[0].length<19&&b.length>1;){var R=new Uint8Array(b[0].length+b[1].length);R.set(b[0]),R.set(b[1],b[0].length),b[0]=R,b.splice(1,1)}if(((A=b[0])[0]<<16)+(A[1]<<8)+A[2]===1){if((D=(A[4]<<8)+A[5])&&D>p.size-6)return null;var I=A[7];192&I&&(k=536870912*(14&A[9])+4194304*(255&A[10])+16384*(254&A[11])+128*(255&A[12])+(254&A[13])/2,64&I?k-(h=536870912*(14&A[14])+4194304*(255&A[15])+16384*(254&A[16])+128*(255&A[17])+(254&A[18])/2)>54e5&&(y.logger.warn(Math.round((k-h)/9e4)+"s delta between PTS and DTS, align them"),k=h):h=k);var C=(w=A[8])+9;if(p.size<=C)return null;p.size-=C;for(var x=new Uint8Array(p.size),O=0,P=b.length;O<P;O++){var M=(A=b[O]).byteLength;if(C){if(C>M){C-=M;continue}A=A.subarray(C),M-=C,C=0}x.set(A,v),v+=M}return D&&(D-=w+3),{data:x,pts:k,dts:h,len:D}}return null}function c(p,A){if(p.units.length&&p.frame){if(p.pts===void 0){var D=A.samples,w=D.length;if(!w)return void A.dropped++;var k=D[w-1];p.pts=k.pts,p.dts=k.dts}A.samples.push(p)}p.debug.length&&y.logger.log(p.pts+"/"+p.dts+":"+p.debug)}function T(p,A){var D=p.length;if(D>0){if(A.pts>=p[D-1].pts)p.push(A);else for(var w=D-1;w>=0;w--)if(A.pts<p[w].pts){p.splice(w,0,A);break}}else p.push(A)}function S(p){for(var A=p.byteLength,D=[],w=1;w<A-2;)p[w]===0&&p[w+1]===0&&p[w+2]===3?(D.push(w+2),w+=2):w++;if(D.length===0)return p;var k=A-D.length,h=new Uint8Array(k),v=0;for(w=0;w<k;v++,w++)v===D[0]&&(v++,D.shift()),h[w]=p[v];return h}L.minProbeByteLength=188,e.default=L},"./src/errors.ts":function(t,e,r){var n,i,s,a;r.r(e),r.d(e,"ErrorTypes",function(){return n}),r.d(e,"ErrorDetails",function(){return s}),(i=n||(n={})).NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",(a=s||(s={})).KEY_SYSTEM_NO_KEYS="keySystemNoKeys",a.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",a.KEY_SYSTEM_NO_SESSION="keySystemNoSession",a.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",a.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",a.MANIFEST_LOAD_ERROR="manifestLoadError",a.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",a.MANIFEST_PARSING_ERROR="manifestParsingError",a.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",a.LEVEL_EMPTY_ERROR="levelEmptyError",a.LEVEL_LOAD_ERROR="levelLoadError",a.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",a.LEVEL_SWITCH_ERROR="levelSwitchError",a.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",a.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",a.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",a.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",a.FRAG_LOAD_ERROR="fragLoadError",a.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",a.FRAG_DECRYPT_ERROR="fragDecryptError",a.FRAG_PARSING_ERROR="fragParsingError",a.REMUX_ALLOC_ERROR="remuxAllocError",a.KEY_LOAD_ERROR="keyLoadError",a.KEY_LOAD_TIMEOUT="keyLoadTimeOut",a.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",a.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",a.BUFFER_APPEND_ERROR="bufferAppendError",a.BUFFER_APPENDING_ERROR="bufferAppendingError",a.BUFFER_STALLED_ERROR="bufferStalledError",a.BUFFER_FULL_ERROR="bufferFullError",a.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",a.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",a.INTERNAL_EXCEPTION="internalException",a.INTERNAL_ABORTED="aborted",a.UNKNOWN="unknown"},"./src/events.ts":function(t,e,r){var n,i;r.r(e),r.d(e,"Events",function(){return n}),(i=n||(n={})).MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached"},"./src/hls.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return c});var n=r("./node_modules/url-toolkit/src/url-toolkit.js"),i=r("./src/loader/playlist-loader.ts"),s=r("./src/loader/key-loader.ts"),a=r("./src/controller/id3-track-controller.ts"),d=r("./src/controller/latency-controller.ts"),u=r("./src/controller/level-controller.ts"),o=r("./src/controller/fragment-tracker.ts"),y=r("./src/controller/stream-controller.ts"),m=r("./src/is-supported.ts"),f=r("./src/utils/logger.ts"),L=r("./src/config.ts"),_=r("./node_modules/eventemitter3/index.js"),E=r("./src/events.ts"),l=r("./src/errors.ts");function g(T,S){for(var p=0;p<S.length;p++){var A=S[p];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(T,A.key,A)}}var c=function(){function T(w){w===void 0&&(w={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new _.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this._media=null,this.url=null;var k=this.config=Object(L.mergeConfig)(T.DefaultConfig,w);this.userConfig=w,Object(f.enableLogs)(k.debug),this._autoLevelCapping=-1,k.progressive&&Object(L.enableStreamingMode)(k);var h=k.abrController,v=k.bufferController,b=k.capLevelController,R=k.fpsController,I=this.abrController=new h(this),C=this.bufferController=new v(this),x=this.capLevelController=new b(this),O=new R(this),P=new i.default(this),M=new s.default(this),F=new a.default(this),B=this.levelController=new u.default(this),j=new o.FragmentTracker(this),K=this.streamController=new y.default(this,j);x.setStreamController(K),O.setStreamController(K);var z=[B,K];this.networkControllers=z;var re=[P,M,I,C,x,O,F,j];this.audioTrackController=this.createController(k.audioTrackController,null,z),this.createController(k.audioStreamController,j,z),this.subtitleTrackController=this.createController(k.subtitleTrackController,null,z),this.createController(k.subtitleStreamController,j,z),this.createController(k.timelineController,null,re),this.emeController=this.createController(k.emeController,null,re),this.latencyController=this.createController(d.default,null,re),this.coreComponents=re}T.isSupported=function(){return Object(m.isSupported)()};var S,p,A,D=T.prototype;return D.createController=function(w,k,h){if(w){var v=k?new w(this,k):new w(this);return h&&h.push(v),v}return null},D.on=function(w,k,h){h===void 0&&(h=this),this._emitter.on(w,k,h)},D.once=function(w,k,h){h===void 0&&(h=this),this._emitter.once(w,k,h)},D.removeAllListeners=function(w){this._emitter.removeAllListeners(w)},D.off=function(w,k,h,v){h===void 0&&(h=this),this._emitter.off(w,k,h,v)},D.listeners=function(w){return this._emitter.listeners(w)},D.emit=function(w,k,h){return this._emitter.emit(w,k,h)},D.trigger=function(w,k){if(this.config.debug)return this.emit(w,w,k);try{return this.emit(w,w,k)}catch(h){f.logger.error("An internal error happened while handling event "+w+'. Error message: "'+h.message+'". Here is a stacktrace:',h),this.trigger(E.Events.ERROR,{type:l.ErrorTypes.OTHER_ERROR,details:l.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:w,error:h})}return!1},D.listenerCount=function(w){return this._emitter.listenerCount(w)},D.destroy=function(){f.logger.log("destroy"),this.trigger(E.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(w){return w.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(w){return w.destroy()}),this.coreComponents.length=0},D.attachMedia=function(w){f.logger.log("attachMedia"),this._media=w,this.trigger(E.Events.MEDIA_ATTACHING,{media:w})},D.detachMedia=function(){f.logger.log("detachMedia"),this.trigger(E.Events.MEDIA_DETACHING,void 0),this._media=null},D.loadSource=function(w){this.stopLoad();var k=this.media,h=this.url,v=this.url=n.buildAbsoluteURL(self.location.href,w,{alwaysNormalize:!0});f.logger.log("loadSource:"+v),k&&h&&h!==v&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(k)),this.trigger(E.Events.MANIFEST_LOADING,{url:w})},D.startLoad=function(w){w===void 0&&(w=-1),f.logger.log("startLoad("+w+")"),this.networkControllers.forEach(function(k){k.startLoad(w)})},D.stopLoad=function(){f.logger.log("stopLoad"),this.networkControllers.forEach(function(w){w.stopLoad()})},D.swapAudioCodec=function(){f.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},D.recoverMediaError=function(){f.logger.log("recoverMediaError");var w=this._media;this.detachMedia(),w&&this.attachMedia(w)},D.removeLevel=function(w,k){k===void 0&&(k=0),this.levelController.removeLevel(w,k)},S=T,A=[{key:"version",get:function(){return"1.0.10"}},{key:"Events",get:function(){return E.Events}},{key:"ErrorTypes",get:function(){return l.ErrorTypes}},{key:"ErrorDetails",get:function(){return l.ErrorDetails}},{key:"DefaultConfig",get:function(){return T.defaultConfig?T.defaultConfig:L.hlsDefaultConfig},set:function(w){T.defaultConfig=w}}],(p=[{key:"levels",get:function(){var w=this.levelController.levels;return w||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(w){f.logger.log("set currentLevel:"+w),this.loadLevel=w,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(w){f.logger.log("set nextLevel:"+w),this.levelController.manualLevel=w,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(w){f.logger.log("set loadLevel:"+w),this.levelController.manualLevel=w}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(w){this.levelController.nextLoadLevel=w}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(w){f.logger.log("set firstLevel:"+w),this.levelController.firstLevel=w}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(w){f.logger.log("set startLevel:"+w),w!==-1&&(w=Math.max(w,this.minAutoLevel)),this.levelController.startLevel=w}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(w){var k=!!w;k!==this.config.capLevelToPlayerSize&&(k?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=k)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(w){this._autoLevelCapping!==w&&(f.logger.log("set autoLevelCapping:"+w),this._autoLevelCapping=w)}},{key:"bandwidthEstimate",get:function(){var w=this.abrController.bwEstimator;return w?w.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var w=this.levels,k=this.config.minAutoBitrate;if(!w)return 0;for(var h=w.length,v=0;v<h;v++)if(w[v].maxBitrate>k)return v;return 0}},{key:"maxAutoLevel",get:function(){var w=this.levels,k=this.autoLevelCapping;return k===-1&&w&&w.length?w.length-1:k}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(w){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,w)}},{key:"audioTracks",get:function(){var w=this.audioTrackController;return w?w.audioTracks:[]}},{key:"audioTrack",get:function(){var w=this.audioTrackController;return w?w.audioTrack:-1},set:function(w){var k=this.audioTrackController;k&&(k.audioTrack=w)}},{key:"subtitleTracks",get:function(){var w=this.subtitleTrackController;return w?w.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var w=this.subtitleTrackController;return w?w.subtitleTrack:-1},set:function(w){var k=this.subtitleTrackController;k&&(k.subtitleTrack=w)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var w=this.subtitleTrackController;return!!w&&w.subtitleDisplay},set:function(w){var k=this.subtitleTrackController;k&&(k.subtitleDisplay=w)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(w){this.config.lowLatencyMode=w}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&g(S.prototype,p),A&&g(S,A),T}();c.defaultConfig=void 0},"./src/is-supported.ts":function(t,e,r){r.r(e),r.d(e,"isSupported",function(){return s}),r.d(e,"changeTypeSupported",function(){return a});var n=r("./src/utils/mediasource-helper.ts");function i(){return self.SourceBuffer||self.WebKitSourceBuffer}function s(){var d=Object(n.getMediaSource)();if(!d)return!1;var u=i(),o=d&&typeof d.isTypeSupported=="function"&&d.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),y=!u||u.prototype&&typeof u.prototype.appendBuffer=="function"&&typeof u.prototype.remove=="function";return!!o&&!!y}function a(){var d,u=i();return typeof(u==null||(d=u.prototype)===null||d===void 0?void 0:d.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return m}),r.d(e,"LoadError",function(){return L});var n=r("./src/polyfills/number.ts"),i=r("./src/errors.ts");function s(_){var E=typeof Map=="function"?new Map:void 0;return(s=function(l){if(l===null||(g=l,Function.toString.call(g).indexOf("[native code]")===-1))return l;var g;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(E!==void 0){if(E.has(l))return E.get(l);E.set(l,c)}function c(){return a(l,arguments,o(this).constructor)}return c.prototype=Object.create(l.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),u(c,l)})(_)}function a(_,E,l){return(a=d()?Reflect.construct:function(g,c,T){var S=[null];S.push.apply(S,c);var p=new(Function.bind.apply(g,S));return T&&u(p,T.prototype),p}).apply(null,arguments)}function d(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function u(_,E){return(u=Object.setPrototypeOf||function(l,g){return l.__proto__=g,l})(_,E)}function o(_){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)})(_)}var y=Math.pow(2,17),m=function(){function _(l){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=l}var E=_.prototype;return E.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},E.abort=function(){this.loader&&this.loader.abort()},E.load=function(l,g){var c=this,T=l.url;if(!T)return Promise.reject(new L({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:l,networkDetails:null},"Fragment does not have a "+(T?"part list":"url")));this.abort();var S=this.config,p=S.fLoader,A=S.loader;return new Promise(function(D,w){c.loader&&c.loader.destroy();var k=c.loader=l.loader=p?new p(S):new A(S),h=f(l),v={timeout:S.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:S.fragLoadingMaxRetryTimeout,highWaterMark:y};l.stats=k.stats,k.load(h,v,{onSuccess:function(b,R,I,C){c.resetLoader(l,k),D({frag:l,part:null,payload:b.data,networkDetails:C})},onError:function(b,R,I){c.resetLoader(l,k),w(new L({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:l,response:b,networkDetails:I}))},onAbort:function(b,R,I){c.resetLoader(l,k),w(new L({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:l,networkDetails:I}))},onTimeout:function(b,R,I){c.resetLoader(l,k),w(new L({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:l,networkDetails:I}))},onProgress:function(b,R,I,C){g&&g({frag:l,part:null,payload:I,networkDetails:C})}})})},E.loadPart=function(l,g,c){var T=this;this.abort();var S=this.config,p=S.fLoader,A=S.loader;return new Promise(function(D,w){T.loader&&T.loader.destroy();var k=T.loader=l.loader=p?new p(S):new A(S),h=f(l,g),v={timeout:S.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:S.fragLoadingMaxRetryTimeout,highWaterMark:y};g.stats=k.stats,k.load(h,v,{onSuccess:function(b,R,I,C){T.resetLoader(l,k),T.updateStatsFromPart(l,g);var x={frag:l,part:g,payload:b.data,networkDetails:C};c(x),D(x)},onError:function(b,R,I){T.resetLoader(l,k),w(new L({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:l,part:g,response:b,networkDetails:I}))},onAbort:function(b,R,I){l.stats.aborted=g.stats.aborted,T.resetLoader(l,k),w(new L({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:l,part:g,networkDetails:I}))},onTimeout:function(b,R,I){T.resetLoader(l,k),w(new L({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:l,part:g,networkDetails:I}))}})})},E.updateStatsFromPart=function(l,g){var c=l.stats,T=g.stats,S=T.total;if(c.loaded+=T.loaded,S){var p=Math.round(l.duration/g.duration),A=Math.min(Math.round(c.loaded/S),p),D=(p-A)*Math.round(c.loaded/A);c.total=c.loaded+D}else c.total=Math.max(c.loaded,c.total);var w=c.loading,k=T.loading;w.start?w.first+=k.first-k.start:(w.start=k.start,w.first=k.first),w.end=k.end},E.resetLoader=function(l,g){l.loader=null,this.loader===g&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),g.destroy()},_}();function f(_,E){E===void 0&&(E=null);var l=E||_,g={frag:_,part:E,responseType:"arraybuffer",url:l.url,rangeStart:0,rangeEnd:0},c=l.byteRangeStartOffset,T=l.byteRangeEndOffset;return Object(n.isFiniteNumber)(c)&&Object(n.isFiniteNumber)(T)&&(g.rangeStart=c,g.rangeEnd=T),g}var L=function(_){var E,l;function g(c){for(var T,S=arguments.length,p=new Array(S>1?S-1:0),A=1;A<S;A++)p[A-1]=arguments[A];return(T=_.call.apply(_,[this].concat(p))||this).data=void 0,T.data=c,T}return l=_,(E=g).prototype=Object.create(l.prototype),E.prototype.constructor=E,u(E,l),g}(s(Error))},"./src/loader/fragment.ts":function(t,e,r){r.r(e),r.d(e,"ElementaryStreamTypes",function(){return n}),r.d(e,"BaseSegment",function(){return _}),r.d(e,"Fragment",function(){return E}),r.d(e,"Part",function(){return l});var n,i,s=r("./src/polyfills/number.ts"),a=r("./node_modules/url-toolkit/src/url-toolkit.js"),d=r("./src/utils/logger.ts"),u=r("./src/loader/level-key.ts"),o=r("./src/loader/load-stats.ts");function y(g,c){g.prototype=Object.create(c.prototype),g.prototype.constructor=g,m(g,c)}function m(g,c){return(m=Object.setPrototypeOf||function(T,S){return T.__proto__=S,T})(g,c)}function f(g,c){for(var T=0;T<c.length;T++){var S=c[T];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(g,S.key,S)}}function L(g,c,T){return c&&f(g.prototype,c),T&&f(g,T),g}(i=n||(n={})).AUDIO="audio",i.VIDEO="video",i.AUDIOVIDEO="audiovideo";var _=function(){function g(c){var T;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((T={})[n.AUDIO]=null,T[n.VIDEO]=null,T[n.AUDIOVIDEO]=null,T),this.baseurl=c}return g.prototype.setByteRange=function(c,T){var S=c.split("@",2),p=[];S.length===1?p[0]=T?T.byteRangeEndOffset:0:p[0]=parseInt(S[1]),p[1]=parseInt(S[0])+p[0],this._byteRange=p},L(g,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(c){this._url=c}}]),g}(),E=function(g){function c(S,p){var A;return(A=g.call(this,p)||this)._decryptdata=null,A.rawProgramDateTime=null,A.programDateTime=null,A.tagList=[],A.duration=0,A.sn=0,A.levelkey=void 0,A.type=void 0,A.loader=null,A.level=-1,A.cc=0,A.startPTS=void 0,A.endPTS=void 0,A.appendedPTS=void 0,A.startDTS=void 0,A.endDTS=void 0,A.start=0,A.deltaPTS=void 0,A.maxStartPTS=void 0,A.minEndPTS=void 0,A.stats=new o.LoadStats,A.urlId=0,A.data=void 0,A.bitrateTest=!1,A.title=null,A.initSegment=null,A.type=S,A}y(c,g);var T=c.prototype;return T.createInitializationVector=function(S){for(var p=new Uint8Array(16),A=12;A<16;A++)p[A]=S>>8*(15-A)&255;return p},T.setDecryptDataFromLevelKey=function(S,p){var A=S;return(S==null?void 0:S.method)==="AES-128"&&S.uri&&!S.iv&&((A=u.LevelKey.fromURI(S.uri)).method=S.method,A.iv=this.createInitializationVector(p),A.keyFormat="identity"),A},T.setElementaryStreamInfo=function(S,p,A,D,w,k){k===void 0&&(k=!1);var h=this.elementaryStreams,v=h[S];v?(v.startPTS=Math.min(v.startPTS,p),v.endPTS=Math.max(v.endPTS,A),v.startDTS=Math.min(v.startDTS,D),v.endDTS=Math.max(v.endDTS,w)):h[S]={startPTS:p,endPTS:A,startDTS:D,endDTS:w,partial:k}},T.clearElementaryStreamInfo=function(){var S=this.elementaryStreams;S[n.AUDIO]=null,S[n.VIDEO]=null,S[n.AUDIOVIDEO]=null},L(c,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var S=this.sn;typeof S!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&d.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),S=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,S)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(s.isFiniteNumber)(this.programDateTime))return null;var S=Object(s.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*S}},{key:"encrypted",get:function(){var S;return!((S=this.decryptdata)===null||S===void 0||!S.keyFormat||!this.decryptdata.uri)}}]),c}(_),l=function(g){function c(T,S,p,A,D){var w;(w=g.call(this,p)||this).fragOffset=0,w.duration=0,w.gap=!1,w.independent=!1,w.relurl=void 0,w.fragment=void 0,w.index=void 0,w.stats=new o.LoadStats,w.duration=T.decimalFloatingPoint("DURATION"),w.gap=T.bool("GAP"),w.independent=T.bool("INDEPENDENT"),w.relurl=T.enumeratedString("URI"),w.fragment=S,w.index=A;var k=T.enumeratedString("BYTERANGE");return k&&w.setByteRange(k,D),D&&(w.fragOffset=D.fragOffset+D.duration),w}return y(c,g),L(c,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var T=this.elementaryStreams;return!!(T.audio||T.video||T.audiovideo)}}]),c}(_)},"./src/loader/key-loader.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return a});var n=r("./src/events.ts"),i=r("./src/errors.ts"),s=r("./src/utils/logger.ts"),a=function(){function d(o){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=o,this._registerListeners()}var u=d.prototype;return u._registerListeners=function(){this.hls.on(n.Events.KEY_LOADING,this.onKeyLoading,this)},u._unregisterListeners=function(){this.hls.off(n.Events.KEY_LOADING,this.onKeyLoading)},u.destroy=function(){for(var o in this._unregisterListeners(),this.loaders){var y=this.loaders[o];y&&y.destroy()}this.loaders={}},u.onKeyLoading=function(o,y){var m=y.frag,f=m.type,L=this.loaders[f];if(m.decryptdata){var _=m.decryptdata.uri;if(_!==this.decrypturl||this.decryptkey===null){var E=this.hls.config;if(L&&(s.logger.warn("abort previous key loader for type:"+f),L.abort()),!_)return void s.logger.warn("key uri is falsy");var l=E.loader,g=m.loader=this.loaders[f]=new l(E);this.decrypturl=_,this.decryptkey=null;var c={url:_,frag:m,responseType:"arraybuffer"},T={timeout:E.fragLoadingTimeOut,maxRetry:0,retryDelay:E.fragLoadingRetryDelay,maxRetryDelay:E.fragLoadingMaxRetryTimeout,highWaterMark:0},S={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};g.load(c,T,S)}else this.decryptkey&&(m.decryptdata.key=this.decryptkey,this.hls.trigger(n.Events.KEY_LOADED,{frag:m}))}else s.logger.warn("Missing decryption data on fragment in onKeyLoading")},u.loadsuccess=function(o,y,m){var f=m.frag;f.decryptdata?(this.decryptkey=f.decryptdata.key=new Uint8Array(o.data),f.loader=null,delete this.loaders[f.type],this.hls.trigger(n.Events.KEY_LOADED,{frag:f})):s.logger.error("after key load, decryptdata unset")},u.loaderror=function(o,y){var m=y.frag,f=m.loader;f&&f.abort(),delete this.loaders[m.type],this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:m,response:o})},u.loadtimeout=function(o,y){var m=y.frag,f=m.loader;f&&f.abort(),delete this.loaders[m.type],this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:m})},d}()},"./src/loader/level-details.ts":function(t,e,r){r.r(e),r.d(e,"LevelDetails",function(){return s});var n=r("./src/polyfills/number.ts");function i(a,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(a,o.key,o)}}var s=function(){function a(o){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=o}var d,u;return a.prototype.reloaded=function(o){if(!o)return this.advanced=!0,void(this.updated=!0);var y=this.lastPartSn-o.lastPartSn,m=this.lastPartIndex-o.lastPartIndex;this.updated=this.endSN!==o.endSN||!!m||!!y,this.advanced=this.endSN>o.endSN||y>0||y===0&&m>0,this.updated||this.advanced?this.misses=Math.floor(.6*o.misses):this.misses=o.misses+1,this.availabilityDelay=o.availabilityDelay},d=a,(u=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Object(n.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var o=this.driftEndTime-this.driftStartTime;return o>0?1e3*(this.driftEnd-this.driftStart)/o:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var o;return(o=this.partList)!==null&&o!==void 0&&o.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var o;return(o=this.fragments)!==null&&o!==void 0&&o.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var o;return(o=this.partList)!==null&&o!==void 0&&o.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var o;return(o=this.partList)!==null&&o!==void 0&&o.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&i(d.prototype,u),a}()},"./src/loader/level-key.ts":function(t,e,r){r.r(e),r.d(e,"LevelKey",function(){return s});var n=r("./node_modules/url-toolkit/src/url-toolkit.js");function i(a,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(a,o.key,o)}}var s=function(){function a(o,y){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,this._uri=y?Object(n.buildAbsoluteURL)(o,y,{alwaysNormalize:!0}):o}var d,u;return a.fromURL=function(o,y){return new a(o,y)},a.fromURI=function(o){return new a(o)},d=a,(u=[{key:"uri",get:function(){return this._uri}}])&&i(d.prototype,u),a}()},"./src/loader/load-stats.ts":function(t,e,r){r.r(e),r.d(e,"LoadStats",function(){return n});var n=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return l});var n=r("./src/polyfills/number.ts"),i=r("./node_modules/url-toolkit/src/url-toolkit.js"),s=r("./src/loader/fragment.ts"),a=r("./src/loader/level-details.ts"),d=r("./src/loader/level-key.ts"),u=r("./src/utils/attr-list.ts"),o=r("./src/utils/logger.ts"),y=r("./src/utils/codecs.ts"),m=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,f=/#EXT-X-MEDIA:(.*)/g,L=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),_=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),E=/\.(mp4|m4s|m4v|m4a)$/i,l=function(){function S(){}return S.findGroup=function(p,A){for(var D=0;D<p.length;D++){var w=p[D];if(w.id===A)return w}},S.convertAVC1ToAVCOTI=function(p){var A=p.split(".");if(A.length>2){var D=A.shift()+".";return D+=parseInt(A.shift()).toString(16),D+=("000"+parseInt(A.shift()).toString(16)).substr(-4)}return p},S.resolve=function(p,A){return i.buildAbsoluteURL(A,p,{alwaysNormalize:!0})},S.parseMasterPlaylist=function(p,A){var D,w=[],k={},h=!1;for(m.lastIndex=0;(D=m.exec(p))!=null;)if(D[1]){var v=new u.AttrList(D[1]),b={attrs:v,bitrate:v.decimalInteger("AVERAGE-BANDWIDTH")||v.decimalInteger("BANDWIDTH"),name:v.NAME,url:S.resolve(D[2],A)},R=v.decimalResolution("RESOLUTION");R&&(b.width=R.width,b.height=R.height),g((v.CODECS||"").split(/[ ,]+/).filter(function(C){return C}),b),b.videoCodec&&b.videoCodec.indexOf("avc1")!==-1&&(b.videoCodec=S.convertAVC1ToAVCOTI(b.videoCodec)),w.push(b)}else if(D[3]){var I=new u.AttrList(D[3]);I["DATA-ID"]&&(h=!0,k[I["DATA-ID"]]=I)}return{levels:w,sessionData:h?k:null}},S.parseMasterPlaylistMedia=function(p,A,D,w){var k;w===void 0&&(w=[]);var h=[],v=0;for(f.lastIndex=0;(k=f.exec(p))!==null;){var b=new u.AttrList(k[1]);if(b.TYPE===D){var R={attrs:b,bitrate:0,id:v++,groupId:b["GROUP-ID"],instreamId:b["INSTREAM-ID"],name:b.NAME||b.LANGUAGE||"",type:D,default:b.bool("DEFAULT"),autoselect:b.bool("AUTOSELECT"),forced:b.bool("FORCED"),lang:b.LANGUAGE,url:b.URI?S.resolve(b.URI,A):""};if(w.length){var I=S.findGroup(w,R.groupId)||w[0];c(R,I,"audioCodec"),c(R,I,"textCodec")}h.push(R)}}return h},S.parseLevelPlaylist=function(p,A,D,w,k){var h,v,b,R=new a.LevelDetails(A),I=R.fragments,C=null,x=0,O=0,P=0,M=0,F=null,B=new s.Fragment(w,A),j=-1,K=!1;for(L.lastIndex=0,R.m3u8=p;(h=L.exec(p))!==null;){K&&(K=!1,(B=new s.Fragment(w,A)).start=P,B.sn=x,B.cc=M,B.level=D,C&&(B.initSegment=C,B.rawProgramDateTime=C.rawProgramDateTime));var z=h[1];if(z){B.duration=parseFloat(z);var re=(" "+h[2]).slice(1);B.title=re||null,B.tagList.push(re?["INF",z,re]:["INF",z])}else if(h[3])Object(n.isFiniteNumber)(B.duration)&&(B.start=P,b&&(B.levelkey=b),B.sn=x,B.level=D,B.cc=M,B.urlId=k,I.push(B),B.relurl=(" "+h[3]).slice(1),T(B,F),F=B,P+=B.duration,x++,O=0,K=!0);else if(h[4]){var ne=(" "+h[4]).slice(1);F?B.setByteRange(ne,F):B.setByteRange(ne)}else if(h[5])B.rawProgramDateTime=(" "+h[5]).slice(1),B.tagList.push(["PROGRAM-DATE-TIME",B.rawProgramDateTime]),j===-1&&(j=I.length);else{if(!(h=h[0].match(_))){o.logger.warn("No matches on slow regex match for level playlist!");continue}for(v=1;v<h.length&&h[v]===void 0;v++);var V=(" "+h[v]).slice(1),q=(" "+h[v+1]).slice(1),Y=h[v+2]?(" "+h[v+2]).slice(1):"";switch(V){case"PLAYLIST-TYPE":R.type=q.toUpperCase();break;case"MEDIA-SEQUENCE":x=R.startSN=parseInt(q);break;case"SKIP":var ie=new u.AttrList(q),ue=ie.decimalInteger("SKIPPED-SEGMENTS");if(Object(n.isFiniteNumber)(ue)){R.skippedSegments=ue;for(var N=ue;N--;)I.unshift(null);x+=ue}var U=ie.enumeratedString("RECENTLY-REMOVED-DATERANGES");U&&(R.recentlyRemovedDateranges=U.split("	"));break;case"TARGETDURATION":R.targetduration=parseFloat(q);break;case"VERSION":R.version=parseInt(q);break;case"EXTM3U":break;case"ENDLIST":R.live=!1;break;case"#":(q||Y)&&B.tagList.push(Y?[q,Y]:[q]);break;case"DIS":M++;case"GAP":B.tagList.push([V]);break;case"BITRATE":B.tagList.push([V,q]);break;case"DISCONTINUITY-SEQ":M=parseInt(q);break;case"KEY":var G,H=new u.AttrList(q),W=H.enumeratedString("METHOD"),$=H.URI,ee=H.hexadecimalInteger("IV"),X=H.enumeratedString("KEYFORMATVERSIONS"),te=H.enumeratedString("KEYID"),Z=(G=H.enumeratedString("KEYFORMAT"))!=null?G:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(Z)>-1){o.logger.warn("Keyformat "+Z+" is not supported from the manifest");continue}if(Z!=="identity")continue;W&&(b=d.LevelKey.fromURL(A,$),$&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(W)>=0&&(b.method=W,b.keyFormat=Z,te&&(b.keyID=te),X&&(b.keyFormatVersions=X),b.iv=ee));break;case"START":var le=new u.AttrList(q).decimalFloatingPoint("TIME-OFFSET");Object(n.isFiniteNumber)(le)&&(R.startTimeOffset=le);break;case"MAP":var se=new u.AttrList(q);B.relurl=se.URI,se.BYTERANGE&&B.setByteRange(se.BYTERANGE),B.level=D,B.sn="initSegment",b&&(B.levelkey=b),B.initSegment=null,C=B,K=!0;break;case"SERVER-CONTROL":var oe=new u.AttrList(q);R.canBlockReload=oe.bool("CAN-BLOCK-RELOAD"),R.canSkipUntil=oe.optionalFloat("CAN-SKIP-UNTIL",0),R.canSkipDateRanges=R.canSkipUntil>0&&oe.bool("CAN-SKIP-DATERANGES"),R.partHoldBack=oe.optionalFloat("PART-HOLD-BACK",0),R.holdBack=oe.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var de=new u.AttrList(q);R.partTarget=de.decimalFloatingPoint("PART-TARGET");break;case"PART":var fe=R.partList;fe||(fe=R.partList=[]);var ye=O>0?fe[fe.length-1]:void 0,Ee=O++,ke=new s.Part(new u.AttrList(q),B,A,Ee,ye);fe.push(ke),B.duration+=ke.duration;break;case"PRELOAD-HINT":var xe=new u.AttrList(q);R.preloadHint=xe;break;case"RENDITION-REPORT":var ot=new u.AttrList(q);R.renditionReports=R.renditionReports||[],R.renditionReports.push(ot);break;default:o.logger.warn("line parsed but not handled: "+h)}}}F&&!F.relurl?(I.pop(),P-=F.duration,R.partList&&(R.fragmentHint=F)):R.partList&&(T(B,F),B.cc=M,R.fragmentHint=B);var Ot=I.length,qe=I[0],Gt=I[Ot-1];if((P+=R.skippedSegments*R.targetduration)>0&&Ot&&Gt){R.averagetargetduration=P/Ot;var Fe=Gt.sn;R.endSN=Fe!=="initSegment"?Fe:0,qe&&(R.startCC=qe.cc,qe.initSegment||R.fragments.every(function(je){return je.relurl&&(ht=je.relurl,E.test((ir=(wt=i.parseURL(ht))===null||wt===void 0?void 0:wt.path)!=null?ir:""));var ht,ir,wt})&&(o.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(B=new s.Fragment(w,A)).relurl=Gt.relurl,B.level=D,B.sn="initSegment",qe.initSegment=B,R.needSidxRanges=!0))}else R.endSN=0,R.startCC=0;return R.fragmentHint&&(P+=R.fragmentHint.duration),R.totalduration=P,R.endCC=M,j>0&&function(je,ht){for(var ir=je[ht],wt=ht;wt--;){var sr=je[wt];if(!sr)return;sr.programDateTime=ir.programDateTime-1e3*sr.duration,ir=sr}}(I,j),R},S}();function g(S,p){["video","audio","text"].forEach(function(A){var D=S.filter(function(k){return Object(y.isCodecType)(k,A)});if(D.length){var w=D.filter(function(k){return k.lastIndexOf("avc1",0)===0||k.lastIndexOf("mp4a",0)===0});p[A+"Codec"]=w.length>0?w[0]:D[0],S=S.filter(function(k){return D.indexOf(k)===-1})}}),p.unknownCodecs=S}function c(S,p,A){var D=p[A];D&&(S[A]=D)}function T(S,p){S.rawProgramDateTime?S.programDateTime=Date.parse(S.rawProgramDateTime):p!=null&&p.programDateTime&&(S.programDateTime=p.endProgramDateTime),Object(n.isFiniteNumber)(S.programDateTime)||(S.programDateTime=null,S.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(t,e,r){r.r(e);var n=r("./src/polyfills/number.ts"),i=r("./src/events.ts"),s=r("./src/errors.ts"),a=r("./src/utils/logger.ts"),d=r("./src/utils/mp4-tools.ts"),u=r("./src/loader/m3u8-parser.ts"),o=r("./src/types/loader.ts"),y=r("./src/utils/attr-list.ts");function m(L,_){var E=L.url;return E!==void 0&&E.indexOf("data:")!==0||(E=_.url),E}var f=function(){function L(E){this.hls=void 0,this.loaders=Object.create(null),this.hls=E,this.registerListeners()}var _=L.prototype;return _.registerListeners=function(){var E=this.hls;E.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.on(i.Events.LEVEL_LOADING,this.onLevelLoading,this),E.on(i.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),E.on(i.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},_.unregisterListeners=function(){var E=this.hls;E.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.off(i.Events.LEVEL_LOADING,this.onLevelLoading,this),E.off(i.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),E.off(i.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},_.createInternalLoader=function(E){var l=this.hls.config,g=l.pLoader,c=l.loader,T=new(g||c)(l);return E.loader=T,this.loaders[E.type]=T,T},_.getInternalLoader=function(E){return this.loaders[E.type]},_.resetInternalLoader=function(E){this.loaders[E]&&delete this.loaders[E]},_.destroyInternalLoaders=function(){for(var E in this.loaders){var l=this.loaders[E];l&&l.destroy(),this.resetInternalLoader(E)}},_.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},_.onManifestLoading=function(E,l){var g=l.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:o.PlaylistContextType.MANIFEST,url:g,deliveryDirectives:null})},_.onLevelLoading=function(E,l){var g=l.id,c=l.level,T=l.url,S=l.deliveryDirectives;this.load({id:g,groupId:null,level:c,responseType:"text",type:o.PlaylistContextType.LEVEL,url:T,deliveryDirectives:S})},_.onAudioTrackLoading=function(E,l){var g=l.id,c=l.groupId,T=l.url,S=l.deliveryDirectives;this.load({id:g,groupId:c,level:null,responseType:"text",type:o.PlaylistContextType.AUDIO_TRACK,url:T,deliveryDirectives:S})},_.onSubtitleTrackLoading=function(E,l){var g=l.id,c=l.groupId,T=l.url,S=l.deliveryDirectives;this.load({id:g,groupId:c,level:null,responseType:"text",type:o.PlaylistContextType.SUBTITLE_TRACK,url:T,deliveryDirectives:S})},_.load=function(E){var l,g,c,T,S,p,A=this.hls.config,D=this.getInternalLoader(E);if(D){var w=D.context;if(w&&w.url===E.url)return void a.logger.trace("[playlist-loader]: playlist request ongoing");a.logger.log("[playlist-loader]: aborting previous loader for type: "+E.type),D.abort()}switch(E.type){case o.PlaylistContextType.MANIFEST:g=A.manifestLoadingMaxRetry,c=A.manifestLoadingTimeOut,T=A.manifestLoadingRetryDelay,S=A.manifestLoadingMaxRetryTimeout;break;case o.PlaylistContextType.LEVEL:case o.PlaylistContextType.AUDIO_TRACK:case o.PlaylistContextType.SUBTITLE_TRACK:g=0,c=A.levelLoadingTimeOut;break;default:g=A.levelLoadingMaxRetry,c=A.levelLoadingTimeOut,T=A.levelLoadingRetryDelay,S=A.levelLoadingMaxRetryTimeout}if(D=this.createInternalLoader(E),(l=E.deliveryDirectives)!==null&&l!==void 0&&l.part&&(E.type===o.PlaylistContextType.LEVEL&&E.level!==null?p=this.hls.levels[E.level].details:E.type===o.PlaylistContextType.AUDIO_TRACK&&E.id!==null?p=this.hls.audioTracks[E.id].details:E.type===o.PlaylistContextType.SUBTITLE_TRACK&&E.id!==null&&(p=this.hls.subtitleTracks[E.id].details),p)){var k=p.partTarget,h=p.targetduration;k&&h&&(c=Math.min(1e3*Math.max(3*k,.8*h),c))}var v={timeout:c,maxRetry:g,retryDelay:T,maxRetryDelay:S,highWaterMark:0},b={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};D.load(E,v,b)},_.loadsuccess=function(E,l,g,c){if(c===void 0&&(c=null),g.isSidxRequest)return this.handleSidxRequest(E,g),void this.handlePlaylistLoaded(E,l,g,c);this.resetInternalLoader(g.type);var T=E.data;T.indexOf("#EXTM3U")===0?(l.parsing.start=performance.now(),T.indexOf("#EXTINF:")>0||T.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(E,l,g,c):this.handleMasterPlaylist(E,l,g,c)):this.handleManifestParsingError(E,g,"no EXTM3U delimiter",c)},_.loaderror=function(E,l,g){g===void 0&&(g=null),this.handleNetworkError(l,g,!1,E)},_.loadtimeout=function(E,l,g){g===void 0&&(g=null),this.handleNetworkError(l,g,!0)},_.handleMasterPlaylist=function(E,l,g,c){var T=this.hls,S=E.data,p=m(E,g),A=u.default.parseMasterPlaylist(S,p),D=A.levels,w=A.sessionData;if(D.length){var k=D.map(function(I){return{id:I.attrs.AUDIO,audioCodec:I.audioCodec}}),h=D.map(function(I){return{id:I.attrs.SUBTITLES,textCodec:I.textCodec}}),v=u.default.parseMasterPlaylistMedia(S,p,"AUDIO",k),b=u.default.parseMasterPlaylistMedia(S,p,"SUBTITLES",h),R=u.default.parseMasterPlaylistMedia(S,p,"CLOSED-CAPTIONS");v.length&&(v.some(function(I){return!I.url})||!D[0].audioCodec||D[0].attrs.AUDIO||(a.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),v.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new y.AttrList({}),bitrate:0,url:""}))),T.trigger(i.Events.MANIFEST_LOADED,{levels:D,audioTracks:v,subtitles:b,captions:R,url:p,stats:l,networkDetails:c,sessionData:w})}else this.handleManifestParsingError(E,g,"no level found in manifest",c)},_.handleTrackOrLevelPlaylist=function(E,l,g,c){var T=this.hls,S=g.id,p=g.level,A=g.type,D=m(E,g),w=Object(n.isFiniteNumber)(S)?S:0,k=Object(n.isFiniteNumber)(p)?p:w,h=function(C){switch(C.type){case o.PlaylistContextType.AUDIO_TRACK:return o.PlaylistLevelType.AUDIO;case o.PlaylistContextType.SUBTITLE_TRACK:return o.PlaylistLevelType.SUBTITLE;default:return o.PlaylistLevelType.MAIN}}(g),v=u.default.parseLevelPlaylist(E.data,D,k,h,w);if(v.fragments.length){if(A===o.PlaylistContextType.MANIFEST){var b={attrs:new y.AttrList({}),bitrate:0,details:v,name:"",url:D};T.trigger(i.Events.MANIFEST_LOADED,{levels:[b],audioTracks:[],url:D,stats:l,networkDetails:c,sessionData:null})}if(l.parsing.end=performance.now(),v.needSidxRanges){var R,I=(R=v.fragments[0].initSegment)===null||R===void 0?void 0:R.url;this.load({url:I,isSidxRequest:!0,type:A,level:p,levelDetails:v,id:S,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})}else g.levelDetails=v,this.handlePlaylistLoaded(E,l,g,c)}else T.trigger(i.Events.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:D,reason:"no fragments found in level",level:typeof g.level=="number"?g.level:void 0})},_.handleSidxRequest=function(E,l){var g=Object(d.parseSegmentIndex)(new Uint8Array(E.data));if(g){var c=g.references,T=l.levelDetails;c.forEach(function(S,p){var A=S.info,D=T.fragments[p];D.byteRange.length===0&&D.setByteRange(String(1+A.end-A.start)+"@"+String(A.start)),D.initSegment&&D.initSegment.setByteRange(String(g.moovEndOffset)+"@0")})}},_.handleManifestParsingError=function(E,l,g,c){this.hls.trigger(i.Events.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:l.type===o.PlaylistContextType.MANIFEST,url:E.url,reason:g,response:E,context:l,networkDetails:c})},_.handleNetworkError=function(E,l,g,c){g===void 0&&(g=!1),a.logger.warn("[playlist-loader]: A network "+(g?"timeout":"error")+" occurred while loading "+E.type+" level: "+E.level+" id: "+E.id+' group-id: "'+E.groupId+'"');var T=s.ErrorDetails.UNKNOWN,S=!1,p=this.getInternalLoader(E);switch(E.type){case o.PlaylistContextType.MANIFEST:T=g?s.ErrorDetails.MANIFEST_LOAD_TIMEOUT:s.ErrorDetails.MANIFEST_LOAD_ERROR,S=!0;break;case o.PlaylistContextType.LEVEL:T=g?s.ErrorDetails.LEVEL_LOAD_TIMEOUT:s.ErrorDetails.LEVEL_LOAD_ERROR,S=!1;break;case o.PlaylistContextType.AUDIO_TRACK:T=g?s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,S=!1;break;case o.PlaylistContextType.SUBTITLE_TRACK:T=g?s.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:s.ErrorDetails.SUBTITLE_LOAD_ERROR,S=!1}p&&this.resetInternalLoader(E.type);var A={type:s.ErrorTypes.NETWORK_ERROR,details:T,fatal:S,url:E.url,loader:p,context:E,networkDetails:l};c&&(A.response=c),this.hls.trigger(i.Events.ERROR,A)},_.handlePlaylistLoaded=function(E,l,g,c){var T=g.type,S=g.level,p=g.id,A=g.groupId,D=g.loader,w=g.levelDetails,k=g.deliveryDirectives;if(w!=null&&w.targetduration){if(D)switch(w.live&&(D.getCacheAge&&(w.ageHeader=D.getCacheAge()||0),D.getCacheAge&&!isNaN(w.ageHeader)||(w.ageHeader=0)),T){case o.PlaylistContextType.MANIFEST:case o.PlaylistContextType.LEVEL:this.hls.trigger(i.Events.LEVEL_LOADED,{details:w,level:S||0,id:p||0,stats:l,networkDetails:c,deliveryDirectives:k});break;case o.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(i.Events.AUDIO_TRACK_LOADED,{details:w,id:p||0,groupId:A||"",stats:l,networkDetails:c,deliveryDirectives:k});break;case o.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(i.Events.SUBTITLE_TRACK_LOADED,{details:w,id:p||0,groupId:A||"",stats:l,networkDetails:c,deliveryDirectives:k})}}else this.handleManifestParsingError(E,g,"invalid target duration",c)},L}();e.default=f},"./src/polyfills/number.ts":function(t,e,r){r.r(e),r.d(e,"isFiniteNumber",function(){return n}),r.d(e,"MAX_SAFE_INTEGER",function(){return i});var n=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},i=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(t,e,r){r.r(e);var n=function(){function i(){}return i.getSilentFrame=function(s,a){switch(s){case"mp4a.40.2":if(a===1)return new Uint8Array([0,200,0,128,35,128]);if(a===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(a===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(a===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(a===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(a===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(a===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(a===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(a===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},i}();e.default=n},"./src/remux/mp4-generator.ts":function(t,e,r){r.r(e);var n=Math.pow(2,32)-1,i=function(){function s(){}return s.init=function(){var a;for(a in s.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},s.types)s.types.hasOwnProperty(a)&&(s.types[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)]);var d=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),u=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);s.HDLR_TYPES={video:d,audio:u};var o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),y=new Uint8Array([0,0,0,0,0,0,0,0]);s.STTS=s.STSC=s.STCO=y,s.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),s.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),s.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),s.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var m=new Uint8Array([105,115,111,109]),f=new Uint8Array([97,118,99,49]),L=new Uint8Array([0,0,0,1]);s.FTYP=s.box(s.types.ftyp,m,L,m,f),s.DINF=s.box(s.types.dinf,s.box(s.types.dref,o))},s.box=function(a){for(var d=8,u=arguments.length,o=new Array(u>1?u-1:0),y=1;y<u;y++)o[y-1]=arguments[y];for(var m=o.length,f=m;m--;)d+=o[m].byteLength;var L=new Uint8Array(d);for(L[0]=d>>24&255,L[1]=d>>16&255,L[2]=d>>8&255,L[3]=255&d,L.set(a,4),m=0,d=8;m<f;m++)L.set(o[m],d),d+=o[m].byteLength;return L},s.hdlr=function(a){return s.box(s.types.hdlr,s.HDLR_TYPES[a])},s.mdat=function(a){return s.box(s.types.mdat,a)},s.mdhd=function(a,d){d*=a;var u=Math.floor(d/(n+1)),o=Math.floor(d%(n+1));return s.box(s.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,a>>24&255,a>>16&255,a>>8&255,255&a,u>>24,u>>16&255,u>>8&255,255&u,o>>24,o>>16&255,o>>8&255,255&o,85,196,0,0]))},s.mdia=function(a){return s.box(s.types.mdia,s.mdhd(a.timescale,a.duration),s.hdlr(a.type),s.minf(a))},s.mfhd=function(a){return s.box(s.types.mfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a]))},s.minf=function(a){return a.type==="audio"?s.box(s.types.minf,s.box(s.types.smhd,s.SMHD),s.DINF,s.stbl(a)):s.box(s.types.minf,s.box(s.types.vmhd,s.VMHD),s.DINF,s.stbl(a))},s.moof=function(a,d,u){return s.box(s.types.moof,s.mfhd(a),s.traf(u,d))},s.moov=function(a){for(var d=a.length,u=[];d--;)u[d]=s.trak(a[d]);return s.box.apply(null,[s.types.moov,s.mvhd(a[0].timescale,a[0].duration)].concat(u).concat(s.mvex(a)))},s.mvex=function(a){for(var d=a.length,u=[];d--;)u[d]=s.trex(a[d]);return s.box.apply(null,[s.types.mvex].concat(u))},s.mvhd=function(a,d){d*=a;var u=Math.floor(d/(n+1)),o=Math.floor(d%(n+1)),y=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,a>>24&255,a>>16&255,a>>8&255,255&a,u>>24,u>>16&255,u>>8&255,255&u,o>>24,o>>16&255,o>>8&255,255&o,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return s.box(s.types.mvhd,y)},s.sdtp=function(a){var d,u,o=a.samples||[],y=new Uint8Array(4+o.length);for(d=0;d<o.length;d++)u=o[d].flags,y[d+4]=u.dependsOn<<4|u.isDependedOn<<2|u.hasRedundancy;return s.box(s.types.sdtp,y)},s.stbl=function(a){return s.box(s.types.stbl,s.stsd(a),s.box(s.types.stts,s.STTS),s.box(s.types.stsc,s.STSC),s.box(s.types.stsz,s.STSZ),s.box(s.types.stco,s.STCO))},s.avc1=function(a){var d,u,o,y=[],m=[];for(d=0;d<a.sps.length;d++)o=(u=a.sps[d]).byteLength,y.push(o>>>8&255),y.push(255&o),y=y.concat(Array.prototype.slice.call(u));for(d=0;d<a.pps.length;d++)o=(u=a.pps[d]).byteLength,m.push(o>>>8&255),m.push(255&o),m=m.concat(Array.prototype.slice.call(u));var f=s.box(s.types.avcC,new Uint8Array([1,y[3],y[4],y[5],255,224|a.sps.length].concat(y).concat([a.pps.length]).concat(m))),L=a.width,_=a.height,E=a.pixelRatio[0],l=a.pixelRatio[1];return s.box(s.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,L>>8&255,255&L,_>>8&255,255&_,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f,s.box(s.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),s.box(s.types.pasp,new Uint8Array([E>>24,E>>16&255,E>>8&255,255&E,l>>24,l>>16&255,l>>8&255,255&l])))},s.esds=function(a){var d=a.config.length;return new Uint8Array([0,0,0,0,3,23+d,0,1,0,4,15+d,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([d]).concat(a.config).concat([6,1,2]))},s.mp4a=function(a){var d=a.samplerate;return s.box(s.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,16,0,0,0,0,d>>8&255,255&d,0,0]),s.box(s.types.esds,s.esds(a)))},s.mp3=function(a){var d=a.samplerate;return s.box(s.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,16,0,0,0,0,d>>8&255,255&d,0,0]))},s.stsd=function(a){return a.type==="audio"?a.isAAC||a.codec!=="mp3"?s.box(s.types.stsd,s.STSD,s.mp4a(a)):s.box(s.types.stsd,s.STSD,s.mp3(a)):s.box(s.types.stsd,s.STSD,s.avc1(a))},s.tkhd=function(a){var d=a.id,u=a.duration*a.timescale,o=a.width,y=a.height,m=Math.floor(u/(n+1)),f=Math.floor(u%(n+1));return s.box(s.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,d>>24&255,d>>16&255,d>>8&255,255&d,0,0,0,0,m>>24,m>>16&255,m>>8&255,255&m,f>>24,f>>16&255,f>>8&255,255&f,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,255&o,0,0,y>>8&255,255&y,0,0]))},s.traf=function(a,d){var u=s.sdtp(a),o=a.id,y=Math.floor(d/(n+1)),m=Math.floor(d%(n+1));return s.box(s.types.traf,s.box(s.types.tfhd,new Uint8Array([0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o])),s.box(s.types.tfdt,new Uint8Array([1,0,0,0,y>>24,y>>16&255,y>>8&255,255&y,m>>24,m>>16&255,m>>8&255,255&m])),s.trun(a,u.length+16+20+8+16+8+8),u)},s.trak=function(a){return a.duration=a.duration||4294967295,s.box(s.types.trak,s.tkhd(a),s.mdia(a))},s.trex=function(a){var d=a.id;return s.box(s.types.trex,new Uint8Array([0,0,0,0,d>>24,d>>16&255,d>>8&255,255&d,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},s.trun=function(a,d){var u,o,y,m,f,L,_=a.samples||[],E=_.length,l=12+16*E,g=new Uint8Array(l);for(d+=8+l,g.set([0,0,15,1,E>>>24&255,E>>>16&255,E>>>8&255,255&E,d>>>24&255,d>>>16&255,d>>>8&255,255&d],0),u=0;u<E;u++)y=(o=_[u]).duration,m=o.size,f=o.flags,L=o.cts,g.set([y>>>24&255,y>>>16&255,y>>>8&255,255&y,m>>>24&255,m>>>16&255,m>>>8&255,255&m,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.paddingValue<<1|f.isNonSync,61440&f.degradPrio,15&f.degradPrio,L>>>24&255,L>>>16&255,L>>>8&255,255&L],12+16*u);return s.box(s.types.trun,g)},s.initSegment=function(a){s.types||s.init();var d=s.moov(a),u=new Uint8Array(s.FTYP.byteLength+d.byteLength);return u.set(s.FTYP),u.set(d,s.FTYP.byteLength),u},s}();i.types=void 0,i.HDLR_TYPES=void 0,i.STTS=void 0,i.STSC=void 0,i.STCO=void 0,i.STSZ=void 0,i.VMHD=void 0,i.SMHD=void 0,i.STSD=void 0,i.FTYP=void 0,i.DINF=void 0,e.default=i},"./src/remux/mp4-remuxer.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return E}),r.d(e,"normalizePts",function(){return l});var n=r("./src/polyfills/number.ts"),i=r("./src/remux/aac-helper.ts"),s=r("./src/remux/mp4-generator.ts"),a=r("./src/events.ts"),d=r("./src/errors.ts"),u=r("./src/utils/logger.ts"),o=r("./src/types/loader.ts"),y=r("./src/utils/timescale-conversion.ts");function m(){return(m=Object.assign||function(T){for(var S=1;S<arguments.length;S++){var p=arguments[S];for(var A in p)Object.prototype.hasOwnProperty.call(p,A)&&(T[A]=p[A])}return T}).apply(this,arguments)}var f=null,L=null,_=!1,E=function(){function T(p,A,D,w){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=p,this.config=A,this.typeSupported=D,this.ISGenerated=!1,f===null){var k=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);f=k?parseInt(k[1]):0}if(L===null){var h=navigator.userAgent.match(/Safari\/(\d+)/i);L=h?parseInt(h[1]):0}_=!!f&&f<75||!!L&&L<600}var S=T.prototype;return S.destroy=function(){},S.resetTimeStamp=function(p){u.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=p},S.resetNextTimestamp=function(){u.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},S.resetInitSegment=function(){u.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},S.getVideoStartPts=function(p){var A=!1,D=p.reduce(function(w,k){var h=k.pts-w;return h<-4294967296?(A=!0,l(w,k.pts)):h>0?w:k.pts},p[0].pts);return A&&u.logger.debug("PTS rollover detected"),D},S.remux=function(p,A,D,w,k,h,v,b){var R,I,C,x,O,P,M=k,F=k,B=p.pid>-1,j=A.pid>-1,K=A.samples.length,z=p.samples.length>0,re=K>1;if((!B||z)&&(!j||re)||this.ISGenerated||v){this.ISGenerated||(C=this.generateIS(p,A,k));var ne=this.isVideoContiguous,V=-1;if(re&&(V=function(N){for(var U=0;U<N.length;U++)if(N[U].key)return U;return-1}(A.samples),!ne&&this.config.forceKeyFrameOnDiscontinuity))if(P=!0,V>0){u.logger.warn("[mp4-remuxer]: Dropped "+V+" out of "+K+" video samples due to a missing keyframe");var q=this.getVideoStartPts(A.samples);A.samples=A.samples.slice(V),A.dropped+=V,F+=(A.samples[0].pts-q)/(A.timescale||9e4)}else V===-1&&(u.logger.warn("[mp4-remuxer]: No keyframe found out of "+K+" video samples"),P=!1);if(this.ISGenerated){if(z&&re){var Y=this.getVideoStartPts(A.samples),ie=(l(p.samples[0].pts,Y)-Y)/A.inputTimeScale;M+=Math.max(0,ie),F+=Math.max(0,-ie)}if(z){if(p.samplerate||(u.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),C=this.generateIS(p,A,k)),I=this.remuxAudio(p,M,this.isAudioContiguous,h,j||re||b===o.PlaylistLevelType.AUDIO?F:void 0),re){var ue=I?I.endPTS-I.startPTS:0;A.inputTimeScale||(u.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),C=this.generateIS(p,A,k)),R=this.remuxVideo(A,F,ne,ue)}}else re&&(R=this.remuxVideo(A,F,ne,0));R&&(R.firstKeyFrame=V,R.independent=V!==-1)}}return this.ISGenerated&&(D.samples.length&&(O=this.remuxID3(D,k)),w.samples.length&&(x=this.remuxText(w,k))),{audio:I,video:R,initSegment:C,independent:P,text:x,id3:O}},S.generateIS=function(p,A,D){var w,k,h,v=p.samples,b=A.samples,R=this.typeSupported,I={},C=!Object(n.isFiniteNumber)(this._initPTS),x="audio/mp4";if(C&&(w=k=1/0),p.config&&v.length&&(p.timescale=p.samplerate,p.isAAC||(R.mpeg?(x="audio/mpeg",p.codec=""):R.mp3&&(p.codec="mp3")),I.audio={id:"audio",container:x,codec:p.codec,initSegment:!p.isAAC&&R.mpeg?new Uint8Array(0):s.default.initSegment([p]),metadata:{channelCount:p.channelCount}},C&&(h=p.inputTimeScale,w=k=v[0].pts-Math.round(h*D))),A.sps&&A.pps&&b.length&&(A.timescale=A.inputTimeScale,I.video={id:"main",container:"video/mp4",codec:A.codec,initSegment:s.default.initSegment([A]),metadata:{width:A.width,height:A.height}},C)){h=A.inputTimeScale;var O=this.getVideoStartPts(b),P=Math.round(h*D);k=Math.min(k,l(b[0].dts,O)-P),w=Math.min(w,O-P)}if(Object.keys(I).length)return this.ISGenerated=!0,C&&(this._initPTS=w,this._initDTS=k),{tracks:I,initPTS:w,timescale:h}},S.remuxVideo=function(p,A,D,w){var k,h,v,b=p.inputTimeScale,R=p.samples,I=[],C=R.length,x=this._initPTS,O=this.nextAvcDts,P=8,M=Number.POSITIVE_INFINITY,F=Number.NEGATIVE_INFINITY,B=0,j=!1;D&&O!==null||(O=A*b-(R[0].pts-l(R[0].dts,R[0].pts)));for(var K=0;K<C;K++){var z=R[K];z.pts=l(z.pts-x,O),z.dts=l(z.dts-x,O),z.dts>z.pts&&(B=Math.max(Math.min(B,z.pts-z.dts),-18e3)),z.dts<R[K>0?K-1:K].dts&&(j=!0)}j&&R.sort(function(wt,sr){var oc=wt.dts-sr.dts,lc=wt.pts-sr.pts;return oc||lc}),h=R[0].dts,v=R[R.length-1].dts;var re=Math.round((v-h)/(C-1));if(B<0){if(B<-2*re){u.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(y.toMsFromMpegTsClock)(-re,!0)+" ms");for(var ne=B,V=0;V<C;V++)R[V].dts=ne=Math.max(ne,R[V].pts-re),R[V].pts=Math.max(ne,R[V].pts)}else{u.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(y.toMsFromMpegTsClock)(B,!0)+" ms to overcome this issue");for(var q=0;q<C;q++)R[q].dts=R[q].dts+B}h=R[0].dts}if(D){var Y=h-O,ie=Y>re;if(ie||Y<-1){ie?u.logger.warn("AVC: "+Object(y.toMsFromMpegTsClock)(Y,!0)+" ms ("+Y+"dts) hole between fragments detected, filling it"):u.logger.warn("AVC: "+Object(y.toMsFromMpegTsClock)(-Y,!0)+" ms ("+Y+"dts) overlapping between fragments detected"),h=O;var ue=R[0].pts-Y;R[0].dts=h,R[0].pts=ue,u.logger.log("Video: First PTS/DTS adjusted: "+Object(y.toMsFromMpegTsClock)(ue,!0)+"/"+Object(y.toMsFromMpegTsClock)(h,!0)+", delta: "+Object(y.toMsFromMpegTsClock)(Y,!0)+" ms")}}_&&(h=Math.max(0,h));for(var N=0,U=0,G=0;G<C;G++){for(var H=R[G],W=H.units,$=W.length,ee=0,X=0;X<$;X++)ee+=W[X].data.length;U+=ee,N+=$,H.length=ee,H.dts=Math.max(H.dts,h),H.pts=Math.max(H.pts,H.dts,0),M=Math.min(H.pts,M),F=Math.max(H.pts,F)}v=R[C-1].dts;var te,Z=U+4*N+8;try{te=new Uint8Array(Z)}catch{return void this.observer.emit(a.Events.ERROR,a.Events.ERROR,{type:d.ErrorTypes.MUX_ERROR,details:d.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Z,reason:"fail allocating video mdat "+Z})}var le=new DataView(te.buffer);le.setUint32(0,Z),te.set(s.default.types.mdat,4);for(var se=0;se<C;se++){for(var oe=R[se],de=oe.units,fe=0,ye=0,Ee=de.length;ye<Ee;ye++){var ke=de[ye],xe=ke.data,ot=ke.data.byteLength;le.setUint32(P,ot),P+=4,te.set(xe,P),P+=ot,fe+=4+ot}if(se<C-1)k=R[se+1].dts-oe.dts;else{var Ot=this.config,qe=oe.dts-R[se>0?se-1:se].dts;if(Ot.stretchShortVideoTrack&&this.nextAudioPts!==null){var Gt=Math.floor(Ot.maxBufferHole*b),Fe=(w?M+w*b:this.nextAudioPts)-oe.pts;Fe>Gt?((k=Fe-qe)<0&&(k=qe),u.logger.log("[mp4-remuxer]: It is approximately "+Fe/90+" ms to the next segment; using duration "+k/90+" ms for the last video frame.")):k=qe}else k=qe}var je=Math.round(oe.pts-oe.dts);I.push(new g(oe.key,k,fe,je))}if(I.length&&f&&f<70){var ht=I[0].flags;ht.dependsOn=2,ht.isNonSync=0}console.assert(k!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=O=v+k,this.isVideoContiguous=!0;var ir={data1:s.default.moof(p.sequenceNumber++,h,m({},p,{samples:I})),data2:te,startPTS:M/b,endPTS:(F+k)/b,startDTS:h/b,endDTS:O/b,type:"video",hasAudio:!1,hasVideo:!0,nb:I.length,dropped:p.dropped};return p.samples=[],p.dropped=0,console.assert(te.length,"MDAT length must not be zero"),ir},S.remuxAudio=function(p,A,D,w,k){var h=p.inputTimeScale,v=h/(p.samplerate?p.samplerate:h),b=p.isAAC?1024:1152,R=b*v,I=this._initPTS,C=!p.isAAC&&this.typeSupported.mpeg,x=[],O=p.samples,P=C?0:8,M=this.nextAudioPts||-1,F=A*h;if(this.isAudioContiguous=D=D||O.length&&M>0&&(w&&Math.abs(F-M)<9e3||Math.abs(l(O[0].pts-I,F)-M)<20*R),O.forEach(function(xe){xe.pts=l(xe.pts-I,F)}),!D||M<0){if(!(O=O.filter(function(xe){return xe.pts>=0})).length)return;M=k===0?0:w?Math.max(0,F):O[0].pts}if(p.isAAC)for(var B=k!==void 0,j=this.config.maxAudioFramesDrift,K=0,z=M;K<O.length;K++){var re=O[K],ne=re.pts,V=ne-z,q=Math.abs(1e3*V/h);if(V<=-j*R&&B)K===0&&(u.logger.warn("Audio frame @ "+(ne/h).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*V/h)+" ms."),this.nextAudioPts=M=z=ne);else if(V>=j*R&&q<1e4&&B){var Y=Math.round(V/R);(z=ne-Y*R)<0&&(Y--,z+=R),K===0&&(this.nextAudioPts=M=z),u.logger.warn("[mp4-remuxer]: Injecting "+Y+" audio frame @ "+(z/h).toFixed(3)+"s due to "+Math.round(1e3*V/h)+" ms gap.");for(var ie=0;ie<Y;ie++){var ue=Math.max(z,0),N=i.default.getSilentFrame(p.manifestCodec||p.codec,p.channelCount);N||(u.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),N=re.unit.subarray()),O.splice(K,0,{unit:N,pts:ue}),z+=R,K++}}re.pts=z,z+=R}for(var U,G=null,H=null,W=0,$=O.length;$--;)W+=O[$].unit.byteLength;for(var ee=0,X=O.length;ee<X;ee++){var te=O[ee],Z=te.unit,le=te.pts;if(H!==null)x[ee-1].duration=Math.round((le-H)/v);else{if(D&&p.isAAC&&(le=M),G=le,!(W>0))return;W+=P;try{U=new Uint8Array(W)}catch{return void this.observer.emit(a.Events.ERROR,a.Events.ERROR,{type:d.ErrorTypes.MUX_ERROR,details:d.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:W,reason:"fail allocating audio mdat "+W})}C||(new DataView(U.buffer).setUint32(0,W),U.set(s.default.types.mdat,4))}U.set(Z,P);var se=Z.byteLength;P+=se,x.push(new g(!0,b,se,0)),H=le}var oe=x.length;if(oe){var de=x[x.length-1];this.nextAudioPts=M=H+v*de.duration;var fe=C?new Uint8Array(0):s.default.moof(p.sequenceNumber++,G/v,m({},p,{samples:x}));p.samples=[];var ye=G/h,Ee=M/h,ke={data1:fe,data2:U,startPTS:ye,endPTS:Ee,startDTS:ye,endDTS:Ee,type:"audio",hasAudio:!0,hasVideo:!1,nb:oe};return this.isAudioContiguous=!0,console.assert(U.length,"MDAT length must not be zero"),ke}},S.remuxEmptyAudio=function(p,A,D,w){var k=p.inputTimeScale,h=k/(p.samplerate?p.samplerate:k),v=this.nextAudioPts,b=(v!==null?v:w.startDTS*k)+this._initDTS,R=w.endDTS*k+this._initDTS,I=1024*h,C=Math.ceil((R-b)/I),x=i.default.getSilentFrame(p.manifestCodec||p.codec,p.channelCount);if(u.logger.warn("[mp4-remuxer]: remux empty Audio"),x){for(var O=[],P=0;P<C;P++){var M=b+P*I;O.push({unit:x,pts:M,dts:M})}return p.samples=O,this.remuxAudio(p,A,D,!1)}u.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},S.remuxID3=function(p,A){var D=p.samples.length;if(D){for(var w=p.inputTimeScale,k=this._initPTS,h=this._initDTS,v=0;v<D;v++){var b=p.samples[v];b.pts=l(b.pts-k,A*w)/w,b.dts=l(b.dts-h,A*w)/w}var R=p.samples;return p.samples=[],{samples:R}}},S.remuxText=function(p,A){var D=p.samples.length;if(D){for(var w=p.inputTimeScale,k=this._initPTS,h=0;h<D;h++){var v=p.samples[h];v.pts=l(v.pts-k,A*w)/w}p.samples.sort(function(R,I){return R.pts-I.pts});var b=p.samples;return p.samples=[],{samples:b}}},T}();function l(T,S){var p;if(S===null)return T;for(p=S<T?-8589934592:8589934592;Math.abs(T-S)>4294967296;)T+=p;return T}var g=function(T,S,p,A){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=S,this.size=p,this.cts=A,this.flags=new c(T)},c=function(T){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=T?2:1,this.isNonSync=T?0:1}},"./src/remux/passthrough-remuxer.ts":function(t,e,r){r.r(e);var n=r("./src/polyfills/number.ts"),i=r("./src/utils/mp4-tools.ts"),s=r("./src/loader/fragment.ts"),a=r("./src/utils/logger.ts"),d=function(){function y(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var m=y.prototype;return m.destroy=function(){},m.resetTimeStamp=function(f){this.initPTS=f,this.lastEndDTS=null},m.resetNextTimestamp=function(){this.lastEndDTS=null},m.resetInitSegment=function(f,L,_){this.audioCodec=L,this.videoCodec=_,this.generateInitSegment(f),this.emitInitSegment=!0},m.generateInitSegment=function(f){var L=this.audioCodec,_=this.videoCodec;if(!f||!f.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var E=this.initData=Object(i.parseInitSegment)(f);L||(L=o(E.audio,s.ElementaryStreamTypes.AUDIO)),_||(_=o(E.video,s.ElementaryStreamTypes.VIDEO));var l={};E.audio&&E.video?l.audiovideo={container:"video/mp4",codec:L+","+_,initSegment:f,id:"main"}:E.audio?l.audio={container:"audio/mp4",codec:L,initSegment:f,id:"audio"}:E.video?l.video={container:"video/mp4",codec:_,initSegment:f,id:"main"}:a.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=l},m.remux=function(f,L,_,E,l){var g=this.initPTS,c=this.lastEndDTS,T={audio:void 0,video:void 0,text:E,id3:_,initSegment:void 0};Object(n.isFiniteNumber)(c)||(c=this.lastEndDTS=l||0);var S=L.samples;if(!S||!S.length)return T;var p={initPTS:void 0,timescale:1},A=this.initData;if(A&&A.length||(this.generateInitSegment(S),A=this.initData),!A||!A.length)return a.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),T;this.emitInitSegment&&(p.tracks=this.initTracks,this.emitInitSegment=!1),Object(n.isFiniteNumber)(g)||(this.initPTS=p.initPTS=g=u(A,S,c));var D=Object(i.getDuration)(S,A),w=c,k=D+w;Object(i.offsetStartDTS)(A,S,g),D>0?this.lastEndDTS=k:(a.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var h=!!A.audio,v=!!A.video,b="";h&&(b+="audio"),v&&(b+="video");var R={data1:S,startPTS:w,startDTS:w,endPTS:k,endDTS:k,type:b,hasAudio:h,hasVideo:v,nb:1,dropped:0};return T.audio=R.type==="audio"?R:void 0,T.video=R.type!=="audio"?R:void 0,T.text=E,T.id3=_,T.initSegment=p,T},y}(),u=function(y,m,f){return Object(i.getStartDTS)(y,m)-f};function o(y,m){var f=y==null?void 0:y.codec;return f&&f.length>4?f:f==="hvc1"?"hvc1.1.c.L120.90":f==="av01"?"av01.0.04M.08":f==="avc1"||m===s.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}e.default=d},"./src/task-loop.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return n});var n=function(){function i(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var s=i.prototype;return s.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},s.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},s.onHandlerDestroyed=function(){},s.hasInterval=function(){return!!this._tickInterval},s.hasNextTick=function(){return!!this._tickTimer},s.setInterval=function(a){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,a),!0)},s.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},s.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},s.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},s.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},s.doTick=function(){},i}()},"./src/types/level.ts":function(t,e,r){function n(o,y){for(var m=0;m<y.length;m++){var f=y[m];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(o,f.key,f)}}var i,s;function a(o,y){var m=o.canSkipUntil,f=o.canSkipDateRanges,L=o.endSN;return m&&(y!==void 0?y-L:0)<m?f?i.v2:i.Yes:i.No}r.r(e),r.d(e,"HlsSkip",function(){return i}),r.d(e,"getSkipValue",function(){return a}),r.d(e,"HlsUrlParameters",function(){return d}),r.d(e,"Level",function(){return u}),(s=i||(i={})).No="",s.Yes="YES",s.v2="v2";var d=function(){function o(y,m,f){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=y,this.part=m,this.skip=f}return o.prototype.addDirectives=function(y){var m=new self.URL(y);return this.msn!==void 0&&m.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&m.searchParams.set("_HLS_part",this.part.toString()),this.skip&&m.searchParams.set("_HLS_skip",this.skip),m.toString()},o}(),u=function(){function o(f){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[f.url],this.attrs=f.attrs,this.bitrate=f.bitrate,f.details&&(this.details=f.details),this.id=f.id||0,this.name=f.name,this.width=f.width||0,this.height=f.height||0,this.audioCodec=f.audioCodec,this.videoCodec=f.videoCodec,this.unknownCodecs=f.unknownCodecs,this.codecSet=[f.videoCodec,f.audioCodec].filter(function(L){return L}).join(",").replace(/\.[^.,]+/g,"")}var y,m;return y=o,(m=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(f){var L=f%this.url.length;this._urlId!==L&&(this.details=void 0,this._urlId=L)}}])&&n(y.prototype,m),o}()},"./src/types/loader.ts":function(t,e,r){var n,i,s,a;r.r(e),r.d(e,"PlaylistContextType",function(){return n}),r.d(e,"PlaylistLevelType",function(){return s}),(i=n||(n={})).MANIFEST="manifest",i.LEVEL="level",i.AUDIO_TRACK="audioTrack",i.SUBTITLE_TRACK="subtitleTrack",(a=s||(s={})).MAIN="main",a.AUDIO="audio",a.SUBTITLE="subtitle"},"./src/types/transmuxer.ts":function(t,e,r){r.r(e),r.d(e,"ChunkMetadata",function(){return n});var n=function(i,s,a,d,u,o){d===void 0&&(d=0),u===void 0&&(u=-1),o===void 0&&(o=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=i,this.sn=s,this.id=a,this.size=d,this.part=u,this.partial=o}},"./src/utils/attr-list.ts":function(t,e,r){r.r(e),r.d(e,"AttrList",function(){return s});var n=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,s=function(){function a(u){for(var o in typeof u=="string"&&(u=a.parseAttrList(u)),u)u.hasOwnProperty(o)&&(this[o]=u[o])}var d=a.prototype;return d.decimalInteger=function(u){var o=parseInt(this[u],10);return o>Number.MAX_SAFE_INTEGER?1/0:o},d.hexadecimalInteger=function(u){if(this[u]){var o=(this[u]||"0x").slice(2);o=(1&o.length?"0":"")+o;for(var y=new Uint8Array(o.length/2),m=0;m<o.length/2;m++)y[m]=parseInt(o.slice(2*m,2*m+2),16);return y}return null},d.hexadecimalIntegerAsNumber=function(u){var o=parseInt(this[u],16);return o>Number.MAX_SAFE_INTEGER?1/0:o},d.decimalFloatingPoint=function(u){return parseFloat(this[u])},d.optionalFloat=function(u,o){var y=this[u];return y?parseFloat(y):o},d.enumeratedString=function(u){return this[u]},d.bool=function(u){return this[u]==="YES"},d.decimalResolution=function(u){var o=n.exec(this[u]);if(o!==null)return{width:parseInt(o[1],10),height:parseInt(o[2],10)}},a.parseAttrList=function(u){var o,y={};for(i.lastIndex=0;(o=i.exec(u))!==null;){var m=o[2];m.indexOf('"')===0&&m.lastIndexOf('"')===m.length-1&&(m=m.slice(1,-1)),y[o[1]]=m}return y},a}()},"./src/utils/binary-search.ts":function(t,e,r){r.r(e),e.default={search:function(n,i){for(var s=0,a=n.length-1,d=null,u=null;s<=a;){var o=i(u=n[d=(s+a)/2|0]);if(o>0)s=d+1;else{if(!(o<0))return u;a=d-1}}return null}}},"./src/utils/buffer-helper.ts":function(t,e,r){r.r(e),r.d(e,"BufferHelper",function(){return s});var n=r("./src/utils/logger.ts"),i={length:0,start:function(){return 0},end:function(){return 0}},s=function(){function a(){}return a.isBuffered=function(d,u){try{if(d){for(var o=a.getBuffered(d),y=0;y<o.length;y++)if(u>=o.start(y)&&u<=o.end(y))return!0}}catch{}return!1},a.bufferInfo=function(d,u,o){try{if(d){var y,m=a.getBuffered(d),f=[];for(y=0;y<m.length;y++)f.push({start:m.start(y),end:m.end(y)});return this.bufferedInfo(f,u,o)}}catch{}return{len:0,start:u,end:u,nextStart:void 0}},a.bufferedInfo=function(d,u,o){u=Math.max(0,u),d.sort(function(p,A){var D=p.start-A.start;return D||A.end-p.end});var y=[];if(o)for(var m=0;m<d.length;m++){var f=y.length;if(f){var L=y[f-1].end;d[m].start-L<o?d[m].end>L&&(y[f-1].end=d[m].end):y.push(d[m])}else y.push(d[m])}else y=d;for(var _,E=0,l=u,g=u,c=0;c<y.length;c++){var T=y[c].start,S=y[c].end;if(u+o>=T&&u<S)l=T,E=(g=S)-u;else if(u+o<T){_=T;break}}return{len:E,start:l||0,end:g||0,nextStart:_}},a.getBuffered=function(d){try{return d.buffered}catch(u){return n.logger.log("failed to get media.buffered",u),i}},a}()},"./src/utils/cea-608-parser.ts":function(t,e,r){r.r(e),r.d(e,"Row",function(){return T}),r.d(e,"CaptionScreen",function(){return S});var n,i,s=r("./src/utils/logger.ts"),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},d=function(k){var h=k;return a.hasOwnProperty(k)&&(h=a[k]),String.fromCharCode(h)},u=15,o=100,y={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},m={17:2,18:4,21:6,22:8,23:10,19:13,20:15},f={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},L={25:2,26:4,29:6,30:8,31:10,27:13,28:15},_=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];(i=n||(n={}))[i.ERROR=0]="ERROR",i[i.TEXT=1]="TEXT",i[i.WARNING=2]="WARNING",i[i.INFO=2]="INFO",i[i.DEBUG=3]="DEBUG",i[i.DATA=3]="DATA";var E=function(){function k(){this.time=null,this.verboseLevel=n.ERROR}return k.prototype.log=function(h,v){this.verboseLevel>=h&&s.logger.log(this.time+" ["+h+"] "+v)},k}(),l=function(k){for(var h=[],v=0;v<k.length;v++)h.push(k[v].toString(16));return h},g=function(){function k(v,b,R,I,C){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=v||"white",this.underline=b||!1,this.italics=R||!1,this.background=I||"black",this.flash=C||!1}var h=k.prototype;return h.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},h.setStyles=function(v){for(var b=["foreground","underline","italics","background","flash"],R=0;R<b.length;R++){var I=b[R];v.hasOwnProperty(I)&&(this[I]=v[I])}},h.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},h.equals=function(v){return this.foreground===v.foreground&&this.underline===v.underline&&this.italics===v.italics&&this.background===v.background&&this.flash===v.flash},h.copy=function(v){this.foreground=v.foreground,this.underline=v.underline,this.italics=v.italics,this.background=v.background,this.flash=v.flash},h.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},k}(),c=function(){function k(v,b,R,I,C,x){this.uchar=void 0,this.penState=void 0,this.uchar=v||" ",this.penState=new g(b,R,I,C,x)}var h=k.prototype;return h.reset=function(){this.uchar=" ",this.penState.reset()},h.setChar=function(v,b){this.uchar=v,this.penState.copy(b)},h.setPenState=function(v){this.penState.copy(v)},h.equals=function(v){return this.uchar===v.uchar&&this.penState.equals(v.penState)},h.copy=function(v){this.uchar=v.uchar,this.penState.copy(v.penState)},h.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},k}(),T=function(){function k(v){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var b=0;b<o;b++)this.chars.push(new c);this.logger=v,this.pos=0,this.currPenState=new g}var h=k.prototype;return h.equals=function(v){for(var b=!0,R=0;R<o;R++)if(!this.chars[R].equals(v.chars[R])){b=!1;break}return b},h.copy=function(v){for(var b=0;b<o;b++)this.chars[b].copy(v.chars[b])},h.isEmpty=function(){for(var v=!0,b=0;b<o;b++)if(!this.chars[b].isEmpty()){v=!1;break}return v},h.setCursor=function(v){this.pos!==v&&(this.pos=v),this.pos<0?(this.logger.log(n.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>o&&(this.logger.log(n.DEBUG,"Too large cursor position "+this.pos),this.pos=o)},h.moveCursor=function(v){var b=this.pos+v;if(v>1)for(var R=this.pos+1;R<b+1;R++)this.chars[R].setPenState(this.currPenState);this.setCursor(b)},h.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},h.insertChar=function(v){v>=144&&this.backSpace();var b=d(v);this.pos>=o?this.logger.log(n.ERROR,"Cannot insert "+v.toString(16)+" ("+b+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(b,this.currPenState),this.moveCursor(1))},h.clearFromPos=function(v){var b;for(b=v;b<o;b++)this.chars[b].reset()},h.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},h.clearToEndOfRow=function(){this.clearFromPos(this.pos)},h.getTextString=function(){for(var v=[],b=!0,R=0;R<o;R++){var I=this.chars[R].uchar;I!==" "&&(b=!1),v.push(I)}return b?"":v.join("")},h.setPenStyles=function(v){this.currPenState.setStyles(v),this.chars[this.pos].setPenState(this.currPenState)},k}(),S=function(){function k(v){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var b=0;b<u;b++)this.rows.push(new T(v));this.logger=v,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var h=k.prototype;return h.reset=function(){for(var v=0;v<u;v++)this.rows[v].clear();this.currRow=14},h.equals=function(v){for(var b=!0,R=0;R<u;R++)if(!this.rows[R].equals(v.rows[R])){b=!1;break}return b},h.copy=function(v){for(var b=0;b<u;b++)this.rows[b].copy(v.rows[b])},h.isEmpty=function(){for(var v=!0,b=0;b<u;b++)if(!this.rows[b].isEmpty()){v=!1;break}return v},h.backSpace=function(){this.rows[this.currRow].backSpace()},h.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},h.insertChar=function(v){this.rows[this.currRow].insertChar(v)},h.setPen=function(v){this.rows[this.currRow].setPenStyles(v)},h.moveCursor=function(v){this.rows[this.currRow].moveCursor(v)},h.setCursor=function(v){this.logger.log(n.INFO,"setCursor: "+v),this.rows[this.currRow].setCursor(v)},h.setPAC=function(v){this.logger.log(n.INFO,"pacData = "+JSON.stringify(v));var b=v.row-1;if(this.nrRollUpRows&&b<this.nrRollUpRows-1&&(b=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==b){for(var R=0;R<u;R++)this.rows[R].clear();var I=this.currRow+1-this.nrRollUpRows,C=this.lastOutputScreen;if(C){var x=C.rows[I].cueStartTime,O=this.logger.time;if(x&&O!==null&&x<O)for(var P=0;P<this.nrRollUpRows;P++)this.rows[b-this.nrRollUpRows+P+1].copy(C.rows[I+P])}}this.currRow=b;var M=this.rows[this.currRow];if(v.indent!==null){var F=v.indent,B=Math.max(F-1,0);M.setCursor(v.indent),v.color=M.chars[B].penState.foreground}var j={foreground:v.color,underline:v.underline,italics:v.italics,background:"black",flash:!1};this.setPen(j)},h.setBkgData=function(v){this.logger.log(n.INFO,"bkgData = "+JSON.stringify(v)),this.backSpace(),this.setPen(v),this.insertChar(32)},h.setRollUpRows=function(v){this.nrRollUpRows=v},h.rollUp=function(){if(this.nrRollUpRows!==null){this.logger.log(n.TEXT,this.getDisplayText());var v=this.currRow+1-this.nrRollUpRows,b=this.rows.splice(v,1)[0];b.clear(),this.rows.splice(this.currRow,0,b),this.logger.log(n.INFO,"Rolling up")}else this.logger.log(n.DEBUG,"roll_up but nrRollUpRows not set yet")},h.getDisplayText=function(v){v=v||!1;for(var b=[],R="",I=-1,C=0;C<u;C++){var x=this.rows[C].getTextString();x&&(I=C+1,v?b.push("Row "+I+": '"+x+"'"):b.push(x.trim()))}return b.length>0&&(R=v?"["+b.join(" | ")+"]":b.join(`
`)),R},h.getTextAndFormat=function(){return this.rows},k}(),p=function(){function k(v,b,R){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=v,this.outputFilter=b,this.mode=null,this.verbose=0,this.displayedMemory=new S(R),this.nonDisplayedMemory=new S(R),this.lastOutputScreen=new S(R),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=R}var h=k.prototype;return h.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},h.getHandler=function(){return this.outputFilter},h.setHandler=function(v){this.outputFilter=v},h.setPAC=function(v){this.writeScreen.setPAC(v)},h.setBkgData=function(v){this.writeScreen.setBkgData(v)},h.setMode=function(v){v!==this.mode&&(this.mode=v,this.logger.log(n.INFO,"MODE="+v),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=v)},h.insertChars=function(v){for(var b=0;b<v.length;b++)this.writeScreen.insertChar(v[b]);var R=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(n.INFO,R+": "+this.writeScreen.getDisplayText(!0)),this.mode!=="MODE_PAINT-ON"&&this.mode!=="MODE_ROLL-UP"||(this.logger.log(n.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},h.ccRCL=function(){this.logger.log(n.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},h.ccBS=function(){this.logger.log(n.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},h.ccAOF=function(){},h.ccAON=function(){},h.ccDER=function(){this.logger.log(n.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},h.ccRU=function(v){this.logger.log(n.INFO,"RU("+v+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(v)},h.ccFON=function(){this.logger.log(n.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},h.ccRDC=function(){this.logger.log(n.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},h.ccTR=function(){this.logger.log(n.INFO,"TR"),this.setMode("MODE_TEXT")},h.ccRTD=function(){this.logger.log(n.INFO,"RTD"),this.setMode("MODE_TEXT")},h.ccEDM=function(){this.logger.log(n.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},h.ccCR=function(){this.logger.log(n.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},h.ccENM=function(){this.logger.log(n.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},h.ccEOC=function(){if(this.logger.log(n.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var v=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=v,this.writeScreen=this.nonDisplayedMemory,this.logger.log(n.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},h.ccTO=function(v){this.logger.log(n.INFO,"TO("+v+") - Tab Offset"),this.writeScreen.moveCursor(v)},h.ccMIDROW=function(v){var b={flash:!1};if(b.underline=v%2==1,b.italics=v>=46,b.italics)b.foreground="white";else{var R=Math.floor(v/2)-16;b.foreground=["white","green","blue","cyan","red","yellow","magenta"][R]}this.logger.log(n.INFO,"MIDROW: "+JSON.stringify(b)),this.writeScreen.setPen(b)},h.outputDataUpdate=function(v){v===void 0&&(v=!1);var b=this.logger.time;b!==null&&this.outputFilter&&(this.cueStartTime!==null||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,b,this.lastOutputScreen),v&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:b):this.cueStartTime=b,this.lastOutputScreen.copy(this.displayedMemory))},h.cueSplitAtTime=function(v){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,v,this.displayedMemory),this.cueStartTime=v))},k}(),A=function(){function k(v,b,R){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var I=new E;this.channels=[null,new p(v,b,I),new p(v+1,R,I)],this.cmdHistory={a:null,b:null},this.logger=I}var h=k.prototype;return h.getHandler=function(v){return this.channels[v].getHandler()},h.setHandler=function(v,b){this.channels[v].setHandler(b)},h.addData=function(v,b){var R,I,C,x=!1;this.logger.time=v;for(var O=0;O<b.length;O+=2)if(I=127&b[O],C=127&b[O+1],I!==0||C!==0){if(this.logger.log(n.DATA,"["+l([b[O],b[O+1]])+"] -> ("+l([I,C])+")"),(R=this.parseCmd(I,C))||(R=this.parseMidrow(I,C)),R||(R=this.parsePAC(I,C)),R||(R=this.parseBackgroundAttributes(I,C)),!R&&(x=this.parseChars(I,C))){var P=this.currentChannel;P&&P>0?this.channels[P].insertChars(x):this.logger.log(n.WARNING,"No channel found yet. TEXT-MODE?")}R||x||this.logger.log(n.WARNING,"Couldn't parse cleaned data "+l([I,C])+" orig: "+l([b[O],b[O+1]]))}},h.parseCmd=function(v,b){var R=this.cmdHistory;if(!((v===20||v===28||v===21||v===29)&&b>=32&&b<=47||(v===23||v===31)&&b>=33&&b<=35))return!1;if(w(v,b,R))return D(null,null,R),this.logger.log(n.DEBUG,"Repeated command ("+l([v,b])+") is dropped"),!0;var I=v===20||v===21||v===23?1:2,C=this.channels[I];return v===20||v===21||v===28||v===29?b===32?C.ccRCL():b===33?C.ccBS():b===34?C.ccAOF():b===35?C.ccAON():b===36?C.ccDER():b===37?C.ccRU(2):b===38?C.ccRU(3):b===39?C.ccRU(4):b===40?C.ccFON():b===41?C.ccRDC():b===42?C.ccTR():b===43?C.ccRTD():b===44?C.ccEDM():b===45?C.ccCR():b===46?C.ccENM():b===47&&C.ccEOC():C.ccTO(b-32),D(v,b,R),this.currentChannel=I,!0},h.parseMidrow=function(v,b){var R=0;if((v===17||v===25)&&b>=32&&b<=47){if((R=v===17?1:2)!==this.currentChannel)return this.logger.log(n.ERROR,"Mismatch channel in midrow parsing"),!1;var I=this.channels[R];return!!I&&(I.ccMIDROW(b),this.logger.log(n.DEBUG,"MIDROW ("+l([v,b])+")"),!0)}return!1},h.parsePAC=function(v,b){var R,I=this.cmdHistory;if(!((v>=17&&v<=23||v>=25&&v<=31)&&b>=64&&b<=127||(v===16||v===24)&&b>=64&&b<=95))return!1;if(w(v,b,I))return D(null,null,I),!0;var C=v<=23?1:2;R=b>=64&&b<=95?C===1?y[v]:f[v]:C===1?m[v]:L[v];var x=this.channels[C];return!!x&&(x.setPAC(this.interpretPAC(R,b)),D(v,b,I),this.currentChannel=C,!0)},h.interpretPAC=function(v,b){var R,I={color:null,italics:!1,indent:null,underline:!1,row:v};return R=b>95?b-96:b-64,I.underline=(1&R)==1,R<=13?I.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(R/2)]:R<=15?(I.italics=!0,I.color="white"):I.indent=4*Math.floor((R-16)/2),I},h.parseChars=function(v,b){var R,I,C=null,x=null;if(v>=25?(R=2,x=v-8):(R=1,x=v),x>=17&&x<=19?(I=x===17?b+80:x===18?b+112:b+144,this.logger.log(n.INFO,"Special char '"+d(I)+"' in channel "+R),C=[I]):v>=32&&v<=127&&(C=b===0?[v]:[v,b]),C){var O=l(C);this.logger.log(n.DEBUG,"Char codes =  "+O.join(",")),D(v,b,this.cmdHistory)}return C},h.parseBackgroundAttributes=function(v,b){var R;if(!((v===16||v===24)&&b>=32&&b<=47||(v===23||v===31)&&b>=45&&b<=47))return!1;var I={};v===16||v===24?(R=Math.floor((b-32)/2),I.background=_[R],b%2==1&&(I.background=I.background+"_semi")):b===45?I.background="transparent":(I.foreground="black",b===47&&(I.underline=!0));var C=v<=23?1:2;return this.channels[C].setBkgData(I),D(v,b,this.cmdHistory),!0},h.reset=function(){for(var v=0;v<Object.keys(this.channels).length;v++){var b=this.channels[v];b&&b.reset()}this.cmdHistory={a:null,b:null}},h.cueSplitAtTime=function(v){for(var b=0;b<this.channels.length;b++){var R=this.channels[b];R&&R.cueSplitAtTime(v)}},k}();function D(k,h,v){v.a=k,v.b=h}function w(k,h,v){return v.a===k&&v.b===h}e.default=A},"./src/utils/codecs.ts":function(t,e,r){r.r(e),r.d(e,"isCodecType",function(){return i}),r.d(e,"isCodecSupportedInMp4",function(){return s});var n={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function i(a,d){var u=n[d];return!!u&&u[a.slice(0,4)]===!0}function s(a,d){return MediaSource.isTypeSupported((d||"video")+'/mp4;codecs="'+a+'"')}},"./src/utils/cues.ts":function(t,e,r){r.r(e);var n=r("./src/utils/vttparser.ts"),i=r("./src/utils/webvtt-parser.ts"),s=r("./src/utils/texttrack-utils.ts"),a=/\s/,d={newCue:function(u,o,y,m){for(var f,L,_,E,l,g=[],c=self.VTTCue||self.TextTrackCue,T=0;T<m.rows.length;T++)if(_=!0,E=0,l="",!(f=m.rows[T]).isEmpty()){for(var S=0;S<f.chars.length;S++)a.test(f.chars[S].uchar)&&_?E++:(l+=f.chars[S].uchar,_=!1);f.cueStartTime=o,o===y&&(y+=1e-4),E>=16?E--:E++;var p=Object(n.fixLineBreaks)(l.trim()),A=Object(i.generateCueId)(o,y,p);u&&u.cues&&u.cues.getCueById(A)||((L=new c(o,y,p)).id=A,L.line=T+1,L.align="left",L.position=10+Math.min(80,10*Math.floor(8*E/32)),g.push(L))}return u&&g.length&&(g.sort(function(D,w){return D.line==="auto"||w.line==="auto"?0:D.line>8&&w.line>8?w.line-D.line:D.line-w.line}),g.forEach(function(D){return Object(s.addCueToTrack)(u,D)})),g}};e.default=d},"./src/utils/discontinuities.ts":function(t,e,r){r.r(e),r.d(e,"findFirstFragWithCC",function(){return a}),r.d(e,"shouldAlignOnDiscontinuities",function(){return d}),r.d(e,"findDiscontinuousReferenceFrag",function(){return u}),r.d(e,"adjustSlidingStart",function(){return y}),r.d(e,"alignStream",function(){return m}),r.d(e,"alignPDT",function(){return f});var n=r("./src/polyfills/number.ts"),i=r("./src/utils/logger.ts"),s=r("./src/controller/level-helper.ts");function a(L,_){for(var E=null,l=0,g=L.length;l<g;l++){var c=L[l];if(c&&c.cc===_){E=c;break}}return E}function d(L,_,E){return!(!_.details||!(E.endCC>E.startCC||L&&L.cc<E.startCC))}function u(L,_){var E=L.fragments,l=_.fragments;if(l.length&&E.length){var g=a(E,l[0].cc);if(g&&(!g||g.startPTS))return g;i.logger.log("No frag in previous level to align on")}else i.logger.log("No fragments to align")}function o(L,_){if(L){var E=L.start+_;L.start=L.startPTS=E,L.endPTS=E+L.duration}}function y(L,_){for(var E=_.fragments,l=0,g=E.length;l<g;l++)o(E[l],L);_.fragmentHint&&o(_.fragmentHint,L),_.alignedSliding=!0}function m(L,_,E){_&&(function(l,g,c){if(d(l,c,g)){var T=u(c.details,g);T&&Object(n.isFiniteNumber)(T.start)&&(i.logger.log("Adjusting PTS using last level due to CC increase within current level "+g.url),y(T.start,g))}}(L,E,_),!E.alignedSliding&&_.details&&f(E,_.details),E.alignedSliding||!_.details||E.skippedSegments||Object(s.adjustSliding)(_.details,E))}function f(L,_){if(_.fragments.length&&L.hasProgramDateTime&&_.hasProgramDateTime){var E=_.fragments[0].programDateTime,l=L.fragments[0].programDateTime,g=(l-E)/1e3+_.fragments[0].start;g&&Object(n.isFiniteNumber)(g)&&(i.logger.log("Adjusting PTS using programDateTime delta "+(l-E)+"ms, sliding:"+g.toFixed(3)+" "+L.url+" "),y(g,L))}}},"./src/utils/ewma-bandwidth-estimator.ts":function(t,e,r){r.r(e);var n=r("./src/utils/ewma.ts"),i=function(){function s(d,u,o){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=o,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new n.default(d),this.fast_=new n.default(u)}var a=s.prototype;return a.update=function(d,u){var o=this.slow_,y=this.fast_;this.slow_.halfLife!==d&&(this.slow_=new n.default(d,o.getEstimate(),o.getTotalWeight())),this.fast_.halfLife!==u&&(this.fast_=new n.default(u,y.getEstimate(),y.getTotalWeight()))},a.sample=function(d,u){var o=(d=Math.max(d,this.minDelayMs_))/1e3,y=8*u/o;this.fast_.sample(o,y),this.slow_.sample(o,y)},a.canEstimate=function(){var d=this.fast_;return d&&d.getTotalWeight()>=this.minWeight_},a.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},a.destroy=function(){},s}();e.default=i},"./src/utils/ewma.ts":function(t,e,r){r.r(e);var n=function(){function i(a,d,u){d===void 0&&(d=0),u===void 0&&(u=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=a,this.alpha_=a?Math.exp(Math.log(.5)/a):0,this.estimate_=d,this.totalWeight_=u}var s=i.prototype;return s.sample=function(a,d){var u=Math.pow(this.alpha_,a);this.estimate_=d*(1-u)+u*this.estimate_,this.totalWeight_+=a},s.getTotalWeight=function(){return this.totalWeight_},s.getEstimate=function(){if(this.alpha_){var a=1-Math.pow(this.alpha_,this.totalWeight_);if(a)return this.estimate_/a}return this.estimate_},i}();e.default=n},"./src/utils/fetch-loader.ts":function(t,e,r){r.r(e),r.d(e,"fetchSupported",function(){return m});var n=r("./src/polyfills/number.ts"),i=r("./src/loader/load-stats.ts"),s=r("./src/demux/chunk-cache.ts");function a(E){var l=typeof Map=="function"?new Map:void 0;return(a=function(g){if(g===null||(c=g,Function.toString.call(c).indexOf("[native code]")===-1))return g;var c;if(typeof g!="function")throw new TypeError("Super expression must either be null or a function");if(l!==void 0){if(l.has(g))return l.get(g);l.set(g,T)}function T(){return d(g,arguments,y(this).constructor)}return T.prototype=Object.create(g.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),o(T,g)})(E)}function d(E,l,g){return(d=u()?Reflect.construct:function(c,T,S){var p=[null];p.push.apply(p,T);var A=new(Function.bind.apply(c,p));return S&&o(A,S.prototype),A}).apply(null,arguments)}function u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function o(E,l){return(o=Object.setPrototypeOf||function(g,c){return g.__proto__=c,g})(E,l)}function y(E){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)})(E)}function m(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var f=function(){function E(g){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=g.fetchSetup||L,this.controller=new self.AbortController,this.stats=new i.LoadStats}var l=E.prototype;return l.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},l.abortInternal=function(){var g=this.response;g&&g.ok||(this.stats.aborted=!0,this.controller.abort())},l.abort=function(){var g;this.abortInternal(),(g=this.callbacks)!==null&&g!==void 0&&g.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},l.load=function(g,c,T){var S=this,p=this.stats;if(p.loading.start)throw new Error("Loader can only be used once.");p.loading.start=self.performance.now();var A=function(h,v){var b={method:"GET",mode:"cors",credentials:"same-origin",signal:v};return h.rangeEnd&&(b.headers=new self.Headers({Range:"bytes="+h.rangeStart+"-"+String(h.rangeEnd-1)})),b}(g,this.controller.signal),D=T.onProgress,w=g.responseType==="arraybuffer",k=w?"byteLength":"length";this.context=g,this.config=c,this.callbacks=T,this.request=this.fetchSetup(g,A),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){S.abortInternal(),T.onTimeout(p,g,S.response)},c.timeout),self.fetch(this.request).then(function(h){if(S.response=S.loader=h,!h.ok){var v=h.status,b=h.statusText;throw new _(b||"fetch, bad network response",v,h)}return p.loading.first=Math.max(self.performance.now(),p.loading.start),p.total=parseInt(h.headers.get("Content-Length")||"0"),D&&Object(n.isFiniteNumber)(c.highWaterMark)?S.loadProgressively(h,p,g,c.highWaterMark,D):w?h.arrayBuffer():h.text()}).then(function(h){var v=S.response;self.clearTimeout(S.requestTimeout),p.loading.end=Math.max(self.performance.now(),p.loading.first),p.loaded=p.total=h[k];var b={url:v.url,data:h};D&&!Object(n.isFiniteNumber)(c.highWaterMark)&&D(p,g,h,v),T.onSuccess(b,p,g,v)}).catch(function(h){if(self.clearTimeout(S.requestTimeout),!p.aborted){var v=h.code||0;T.onError({code:v,text:h.message},g,h.details)}})},l.getCacheAge=function(){var g=null;if(this.response){var c=this.response.headers.get("age");g=c?parseFloat(c):null}return g},l.loadProgressively=function(g,c,T,S,p){S===void 0&&(S=0);var A=new s.default,D=g.body.getReader();return function w(){return D.read().then(function(k){if(k.done)return A.dataLength&&p(c,T,A.flush(),g),Promise.resolve(new ArrayBuffer(0));var h=k.value,v=h.length;return c.loaded+=v,v<S||A.dataLength?(A.push(h),A.dataLength>=S&&p(c,T,A.flush(),g)):p(c,T,h,g),w()}).catch(function(){return Promise.reject()})}()},E}();function L(E,l){return new self.Request(E.url,l)}var _=function(E){var l,g;function c(T,S,p){var A;return(A=E.call(this,T)||this).code=void 0,A.details=void 0,A.code=S,A.details=p,A}return g=E,(l=c).prototype=Object.create(g.prototype),l.prototype.constructor=l,o(l,g),c}(a(Error));e.default=f},"./src/utils/imsc1-ttml-parser.ts":function(t,e,r){r.r(e),r.d(e,"IMSC1_CODEC",function(){return y}),r.d(e,"parseIMSC1",function(){return _});var n=r("./src/utils/mp4-tools.ts"),i=r("./src/utils/vttparser.ts"),s=r("./src/utils/vttcue.ts"),a=r("./src/demux/id3.ts"),d=r("./src/utils/timescale-conversion.ts"),u=r("./src/utils/webvtt-parser.ts");function o(){return(o=Object.assign||function(p){for(var A=1;A<arguments.length;A++){var D=arguments[A];for(var w in D)Object.prototype.hasOwnProperty.call(D,w)&&(p[w]=D[w])}return p}).apply(this,arguments)}var y="stpp.ttml.im1t",m=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,f=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,L={left:"start",center:"center",right:"end",start:"start",end:"end"};function _(p,A,D,w,k){var h=Object(n.findBox)(new Uint8Array(p),["mdat"]);if(h.length!==0){var v=h[0],b=Object(a.utf8ArrayToStr)(new Uint8Array(p,v.start,v.end-v.start)),R=Object(d.toTimescaleFromScale)(A,1,D);try{w(function(I,C){var x=new DOMParser().parseFromString(I,"text/xml").getElementsByTagName("tt")[0];if(!x)throw new Error("Invalid ttml");var O={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},P=Object.keys(O).reduce(function(K,z){return K[z]=x.getAttribute("ttp:"+z)||O[z],K},{}),M=x.getAttribute("xml:space")!=="preserve",F=l(E(x,"styling","style")),B=l(E(x,"layout","region")),j=E(x,"body","[begin]");return[].map.call(j,function(K){var z=g(K,M);if(!z||!K.hasAttribute("begin"))return null;var re=S(K.getAttribute("begin"),P),ne=S(K.getAttribute("dur"),P),V=S(K.getAttribute("end"),P);if(re===null)throw T(K);if(V===null){if(ne===null)throw T(K);V=re+ne}var q=new s.default(re-C,V-C,z);q.id=Object(u.generateCueId)(q.startTime,q.endTime,q.text);var Y=B[K.getAttribute("region")],ie=F[K.getAttribute("style")];q.position=10,q.size=80;var ue=function(G,H){var W="http://www.w3.org/ns/ttml#styling";return["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(function($,ee){var X=c(H,W,ee)||c(G,W,ee);return X&&($[ee]=X),$},{})}(Y,ie),N=ue.textAlign;if(N){var U=L[N];U&&(q.lineAlign=U),q.align=N}return o(q,ue),q}).filter(function(K){return K!==null})}(b,R))}catch(I){k(I)}}else k(new Error("Could not parse IMSC1 mdat"))}function E(p,A,D){var w=p.getElementsByTagName(A)[0];return w?[].slice.call(w.querySelectorAll(D)):[]}function l(p){return p.reduce(function(A,D){var w=D.getAttribute("xml:id");return w&&(A[w]=D),A},{})}function g(p,A){return[].slice.call(p.childNodes).reduce(function(D,w,k){var h;return w.nodeName==="br"&&k?D+`
`:(h=w.childNodes)!==null&&h!==void 0&&h.length?g(w,A):A?D+w.textContent.trim().replace(/\s+/g," "):D+w.textContent},"")}function c(p,A,D){return p.hasAttributeNS(A,D)?p.getAttributeNS(A,D):null}function T(p){return new Error("Could not parse ttml timestamp "+p)}function S(p,A){if(!p)return null;var D=Object(i.parseTimeStamp)(p);return D===null&&(m.test(p)?D=function(w,k){var h=m.exec(w),v=(0|h[4])+(0|h[5])/k.subFrameRate;return 3600*(0|h[1])+60*(0|h[2])+(0|h[3])+v/k.frameRate}(p,A):f.test(p)&&(D=function(w,k){var h=f.exec(w),v=Number(h[1]);switch(h[2]){case"h":return 3600*v;case"m":return 60*v;case"ms":return 1e3*v;case"f":return v/k.frameRate;case"t":return v/k.tickRate}return v}(p,A))),D}},"./src/utils/logger.ts":function(t,e,r){r.r(e),r.d(e,"enableLogs",function(){return d}),r.d(e,"logger",function(){return u});var n=function(){},i={trace:n,debug:n,log:n,warn:n,info:n,error:n},s=i;function a(o){var y=self.console[o];return y?y.bind(self.console,"["+o+"] >"):n}function d(o){if(self.console&&o===!0||typeof o=="object"){(function(y){for(var m=arguments.length,f=new Array(m>1?m-1:0),L=1;L<m;L++)f[L-1]=arguments[L];f.forEach(function(_){s[_]=y[_]?y[_].bind(y):a(_)})})(o,"debug","log","info","warn","error");try{s.log()}catch{s=i}}else s=i}var u=i},"./src/utils/mediakeys-helper.ts":function(t,e,r){var n,i;r.r(e),r.d(e,"KeySystems",function(){return n}),r.d(e,"requestMediaKeySystemAccess",function(){return s}),(i=n||(n={})).WIDEVINE="com.widevine.alpha",i.PLAYREADY="com.microsoft.playready";var s=typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null},"./src/utils/mediasource-helper.ts":function(t,e,r){function n(){return self.MediaSource||self.WebKitMediaSource}r.r(e),r.d(e,"getMediaSource",function(){return n})},"./src/utils/mp4-tools.ts":function(t,e,r){r.r(e),r.d(e,"bin2str",function(){return d}),r.d(e,"readUint16",function(){return u}),r.d(e,"readUint32",function(){return o}),r.d(e,"writeUint32",function(){return y}),r.d(e,"findBox",function(){return m}),r.d(e,"parseSegmentIndex",function(){return f}),r.d(e,"parseInitSegment",function(){return L}),r.d(e,"getStartDTS",function(){return _}),r.d(e,"getDuration",function(){return E}),r.d(e,"computeRawDurationFromSamples",function(){return l}),r.d(e,"offsetStartDTS",function(){return g}),r.d(e,"segmentValidRange",function(){return c}),r.d(e,"appendUint8Array",function(){return T});var n=r("./src/utils/typed-array.ts"),i=r("./src/loader/fragment.ts"),s=Math.pow(2,32)-1,a=[].push;function d(S){return String.fromCharCode.apply(null,S)}function u(S,p){"data"in S&&(p+=S.start,S=S.data);var A=S[p]<<8|S[p+1];return A<0?65536+A:A}function o(S,p){"data"in S&&(p+=S.start,S=S.data);var A=S[p]<<24|S[p+1]<<16|S[p+2]<<8|S[p+3];return A<0?4294967296+A:A}function y(S,p,A){"data"in S&&(p+=S.start,S=S.data),S[p]=A>>24,S[p+1]=A>>16&255,S[p+2]=A>>8&255,S[p+3]=255&A}function m(S,p){var A,D,w,k=[];if(!p.length)return k;"data"in S?(A=S.data,D=S.start,w=S.end):(D=0,w=(A=S).byteLength);for(var h=D;h<w;){var v=o(A,h),b=v>1?h+v:w;if(d(A.subarray(h+4,h+8))===p[0])if(p.length===1)k.push({data:A,start:h+8,end:b});else{var R=m({data:A,start:h+8,end:b},p.slice(1));R.length&&a.apply(k,R)}h=b}return k}function f(S){var p=m(S,["moov"])[0],A=p?p.end:null,D=m(S,["sidx"]);if(!D||!D[0])return null;var w=[],k=D[0],h=k.data[0],v=h===0?8:16,b=o(k,v);v+=4,v+=h===0?8:16,v+=2;var R=k.end+0,I=u(k,v);v+=2;for(var C=0;C<I;C++){var x=v,O=o(k,x);x+=4;var P=2147483647&O;if((2147483648&O)>>>31==1)return console.warn("SIDX has hierarchical references (not supported)"),null;var M=o(k,x);x+=4,w.push({referenceSize:P,subsegmentDuration:M,info:{duration:M/b,start:R,end:R+P-1}}),R+=P,v=x+=4}return{earliestPresentationTime:0,timescale:b,version:h,referencesCount:I,references:w,moovEndOffset:A}}function L(S){for(var p=[],A=m(S,["moov","trak"]),D=0;D<A.length;D++){var w=A[D],k=m(w,["tkhd"])[0];if(k){var h=k.data[k.start],v=h===0?12:20,b=o(k,v),R=m(w,["mdia","mdhd"])[0];if(R){var I=o(R,v=(h=R.data[R.start])===0?12:20),C=m(w,["mdia","hdlr"])[0];if(C){var x=d(C.data.subarray(C.start+8,C.start+12)),O={soun:i.ElementaryStreamTypes.AUDIO,vide:i.ElementaryStreamTypes.VIDEO}[x];if(O){var P=m(w,["mdia","minf","stbl","stsd"])[0],M=void 0;P&&(M=d(P.data.subarray(P.start+12,P.start+16))),p[b]={timescale:I,type:O},p[O]={timescale:I,id:b,codec:M}}}}}}return m(S,["moov","mvex","trex"]).forEach(function(F){var B=o(F,4),j=p[B];j&&(j.default={duration:o(F,12),flags:o(F,20)})}),p}function _(S,p){return m(p,["moof","traf"]).reduce(function(A,D){var w=m(D,["tfdt"])[0],k=w.data[w.start],h=m(D,["tfhd"]).reduce(function(v,b){var R=o(b,4),I=S[R];if(I){var C=o(w,4);k===1&&(C*=Math.pow(2,32),C+=o(w,8));var x=C/(I.timescale||9e4);if(isFinite(x)&&(v===null||x<v))return x}return v},null);return h!==null&&isFinite(h)&&(A===null||h<A)?h:A},null)||0}function E(S,p){for(var A=0,D=0,w=0,k=m(S,["moof","traf"]),h=0;h<k.length;h++){var v=k[h],b=m(v,["tfhd"])[0],R=p[o(b,4)];if(R){var I=R.default,C=o(b,0)|(I==null?void 0:I.flags),x=I==null?void 0:I.duration;8&C&&(x=o(b,2&C?12:8));for(var O=R.timescale||9e4,P=m(v,["trun"]),M=0;M<P.length;M++)A=x?x*o(P[M],4):l(P[M]),R.type===i.ElementaryStreamTypes.VIDEO?D+=A/O:R.type===i.ElementaryStreamTypes.AUDIO&&(w+=A/O)}}if(D===0&&w===0){var F=f(S);if(F!=null&&F.references)return F.references.reduce(function(B,j){return B+j.info.duration||0},0)}return D||w}function l(S){var p=o(S,0),A=8;1&p&&(A+=4),4&p&&(A+=4);for(var D=0,w=o(S,4),k=0;k<w;k++)256&p&&(D+=o(S,A),A+=4),512&p&&(A+=4),1024&p&&(A+=4),2048&p&&(A+=4);return D}function g(S,p,A){m(p,["moof","traf"]).forEach(function(D){m(D,["tfhd"]).forEach(function(w){var k=o(w,4),h=S[k];if(h){var v=h.timescale||9e4;m(D,["tfdt"]).forEach(function(b){var R=b.data[b.start],I=o(b,4);if(R===0)y(b,4,I-A*v);else{I*=Math.pow(2,32),I+=o(b,8),I-=A*v,I=Math.max(I,0);var C=Math.floor(I/(s+1)),x=Math.floor(I%(s+1));y(b,4,C),y(b,8,x)}})}})})}function c(S){var p={valid:null,remainder:null},A=m(S,["moof"]);if(!A)return p;if(A.length<2)return p.remainder=S,p;var D=A[A.length-1];return p.valid=Object(n.sliceUint8)(S,0,D.start-8),p.remainder=Object(n.sliceUint8)(S,D.start-8),p}function T(S,p){var A=new Uint8Array(S.length+p.length);return A.set(S),A.set(p,S.length),A}},"./src/utils/output-filter.ts":function(t,e,r){r.r(e),r.d(e,"default",function(){return n});var n=function(){function i(a,d){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=a,this.trackName=d}var s=i.prototype;return s.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},s.newCue=function(a,d,u){(this.startTime===null||this.startTime>a)&&(this.startTime=a),this.endTime=d,this.screen=u,this.timelineController.createCaptionsTrack(this.trackName)},s.reset=function(){this.cueRanges=[]},i}()},"./src/utils/texttrack-utils.ts":function(t,e,r){r.r(e),r.d(e,"sendAddTrackEvent",function(){return i}),r.d(e,"addCueToTrack",function(){return s}),r.d(e,"clearCurrentCues",function(){return a}),r.d(e,"removeCuesInRange",function(){return d}),r.d(e,"getCuesInRange",function(){return u});var n=r("./src/utils/logger.ts");function i(o,y){var m;try{m=new Event("addtrack")}catch{(m=document.createEvent("Event")).initEvent("addtrack",!1,!1)}m.track=o,y.dispatchEvent(m)}function s(o,y){var m=o.mode;if(m==="disabled"&&(o.mode="hidden"),o.cues&&!o.cues.getCueById(y.id))try{if(o.addCue(y),!o.cues.getCueById(y.id))throw new Error("addCue is failed for: "+y)}catch(L){n.logger.debug("[texttrack-utils]: "+L);var f=new self.TextTrackCue(y.startTime,y.endTime,y.text);f.id=y.id,o.addCue(f)}m==="disabled"&&(o.mode=m)}function a(o){var y=o.mode;if(y==="disabled"&&(o.mode="hidden"),o.cues)for(var m=o.cues.length;m--;)o.removeCue(o.cues[m]);y==="disabled"&&(o.mode=y)}function d(o,y,m){var f=o.mode;if(f==="disabled"&&(o.mode="hidden"),o.cues&&o.cues.length>0)for(var L=u(o.cues,y,m),_=0;_<L.length;_++)o.removeCue(L[_]);f==="disabled"&&(o.mode=f)}function u(o,y,m){var f=[],L=function(g,c){if(c<g[0].startTime)return 0;var T=g.length-1;if(c>g[T].endTime)return-1;for(var S=0,p=T;S<=p;){var A=Math.floor((p+S)/2);if(c<g[A].startTime)p=A-1;else{if(!(c>g[A].startTime&&S<T))return A;S=A+1}}return g[S].startTime-c<c-g[p].startTime?S:p}(o,y);if(L>-1)for(var _=L,E=o.length;_<E;_++){var l=o[_];if(l.startTime>=y&&l.endTime<=m)f.push(l);else if(l.startTime>m)return f}return f}},"./src/utils/time-ranges.ts":function(t,e,r){r.r(e),e.default={toString:function(n){for(var i="",s=n.length,a=0;a<s;a++)i+="["+n.start(a).toFixed(3)+","+n.end(a).toFixed(3)+"]";return i}}},"./src/utils/timescale-conversion.ts":function(t,e,r){function n(d,u,o,y){o===void 0&&(o=1),y===void 0&&(y=!1);var m=d*u*o;return y?Math.round(m):m}function i(d,u,o,y){return o===void 0&&(o=1),y===void 0&&(y=!1),n(d,u,1/o,y)}function s(d,u){return u===void 0&&(u=!1),n(d,1e3,1/9e4,u)}function a(d,u){return u===void 0&&(u=1),n(d,9e4,1/u)}r.r(e),r.d(e,"toTimescaleFromBase",function(){return n}),r.d(e,"toTimescaleFromScale",function(){return i}),r.d(e,"toMsFromMpegTsClock",function(){return s}),r.d(e,"toMpegTsClockFromTimescale",function(){return a})},"./src/utils/typed-array.ts":function(t,e,r){function n(i,s,a){return Uint8Array.prototype.slice?i.slice(s,a):new Uint8Array(Array.prototype.slice.call(i,s,a))}r.r(e),r.d(e,"sliceUint8",function(){return n})},"./src/utils/vttcue.ts":function(t,e,r){r.r(e),e.default=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var n=["","lr","rl"],i=["start","middle","end","left","right"];function s(o,y){if(typeof y!="string"||!Array.isArray(o))return!1;var m=y.toLowerCase();return!!~o.indexOf(m)&&m}function a(o){return s(i,o)}function d(o){for(var y=arguments.length,m=new Array(y>1?y-1:0),f=1;f<y;f++)m[f-1]=arguments[f];for(var L=1;L<arguments.length;L++){var _=arguments[L];for(var E in _)o[E]=_[E]}return o}function u(o,y,m){var f=this,L={enumerable:!0};f.hasBeenReset=!1;var _="",E=!1,l=o,g=y,c=m,T=null,S="",p=!0,A="auto",D="start",w=50,k="middle",h=50,v="middle";Object.defineProperty(f,"id",d({},L,{get:function(){return _},set:function(b){_=""+b}})),Object.defineProperty(f,"pauseOnExit",d({},L,{get:function(){return E},set:function(b){E=!!b}})),Object.defineProperty(f,"startTime",d({},L,{get:function(){return l},set:function(b){if(typeof b!="number")throw new TypeError("Start time must be set to a number.");l=b,this.hasBeenReset=!0}})),Object.defineProperty(f,"endTime",d({},L,{get:function(){return g},set:function(b){if(typeof b!="number")throw new TypeError("End time must be set to a number.");g=b,this.hasBeenReset=!0}})),Object.defineProperty(f,"text",d({},L,{get:function(){return c},set:function(b){c=""+b,this.hasBeenReset=!0}})),Object.defineProperty(f,"region",d({},L,{get:function(){return T},set:function(b){T=b,this.hasBeenReset=!0}})),Object.defineProperty(f,"vertical",d({},L,{get:function(){return S},set:function(b){var R=function(I){return s(n,I)}(b);if(R===!1)throw new SyntaxError("An invalid or illegal string was specified.");S=R,this.hasBeenReset=!0}})),Object.defineProperty(f,"snapToLines",d({},L,{get:function(){return p},set:function(b){p=!!b,this.hasBeenReset=!0}})),Object.defineProperty(f,"line",d({},L,{get:function(){return A},set:function(b){if(typeof b!="number"&&b!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");A=b,this.hasBeenReset=!0}})),Object.defineProperty(f,"lineAlign",d({},L,{get:function(){return D},set:function(b){var R=a(b);if(!R)throw new SyntaxError("An invalid or illegal string was specified.");D=R,this.hasBeenReset=!0}})),Object.defineProperty(f,"position",d({},L,{get:function(){return w},set:function(b){if(b<0||b>100)throw new Error("Position must be between 0 and 100.");w=b,this.hasBeenReset=!0}})),Object.defineProperty(f,"positionAlign",d({},L,{get:function(){return k},set:function(b){var R=a(b);if(!R)throw new SyntaxError("An invalid or illegal string was specified.");k=R,this.hasBeenReset=!0}})),Object.defineProperty(f,"size",d({},L,{get:function(){return h},set:function(b){if(b<0||b>100)throw new Error("Size must be between 0 and 100.");h=b,this.hasBeenReset=!0}})),Object.defineProperty(f,"align",d({},L,{get:function(){return v},set:function(b){var R=a(b);if(!R)throw new SyntaxError("An invalid or illegal string was specified.");v=R,this.hasBeenReset=!0}})),f.displayState=void 0}return u.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},u}()},"./src/utils/vttparser.ts":function(t,e,r){r.r(e),r.d(e,"parseTimeStamp",function(){return s}),r.d(e,"fixLineBreaks",function(){return m}),r.d(e,"VTTParser",function(){return f});var n=r("./src/utils/vttcue.ts"),i=function(){function L(){}return L.prototype.decode=function(_,E){if(!_)return"";if(typeof _!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(_))},L}();function s(L){function _(l,g,c,T){return 3600*(0|l)+60*(0|g)+(0|c)+parseFloat(T||0)}var E=L.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return E?parseFloat(E[2])>59?_(E[2],E[3],0,E[4]):_(E[1],E[2],E[3],E[4]):null}var a=function(){function L(){this.values=Object.create(null)}var _=L.prototype;return _.set=function(E,l){this.get(E)||l===""||(this.values[E]=l)},_.get=function(E,l,g){return g?this.has(E)?this.values[E]:l[g]:this.has(E)?this.values[E]:l},_.has=function(E){return E in this.values},_.alt=function(E,l,g){for(var c=0;c<g.length;++c)if(l===g[c]){this.set(E,l);break}},_.integer=function(E,l){/^-?\d+$/.test(l)&&this.set(E,parseInt(l,10))},_.percent=function(E,l){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(l)){var g=parseFloat(l);if(g>=0&&g<=100)return this.set(E,g),!0}return!1},L}();function d(L,_,E,l){var g=l?L.split(l):[L];for(var c in g)if(typeof g[c]=="string"){var T=g[c].split(E);T.length===2&&_(T[0],T[1])}}var u=new n.default(0,0,""),o=u.align==="middle"?"middle":"center";function y(L,_,E){var l=L;function g(){var T=s(L);if(T===null)throw new Error("Malformed timestamp: "+l);return L=L.replace(/^[^\sa-zA-Z-]+/,""),T}function c(){L=L.replace(/^\s+/,"")}if(c(),_.startTime=g(),c(),L.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+l);L=L.substr(3),c(),_.endTime=g(),c(),function(T,S){var p=new a;d(T,function(w,k){var h;switch(w){case"region":for(var v=E.length-1;v>=0;v--)if(E[v].id===k){p.set(w,E[v].region);break}break;case"vertical":p.alt(w,k,["rl","lr"]);break;case"line":h=k.split(","),p.integer(w,h[0]),p.percent(w,h[0])&&p.set("snapToLines",!1),p.alt(w,h[0],["auto"]),h.length===2&&p.alt("lineAlign",h[1],["start",o,"end"]);break;case"position":h=k.split(","),p.percent(w,h[0]),h.length===2&&p.alt("positionAlign",h[1],["start",o,"end","line-left","line-right","auto"]);break;case"size":p.percent(w,k);break;case"align":p.alt(w,k,["start",o,"end","left","right"])}},/:/,/\s/),S.region=p.get("region",null),S.vertical=p.get("vertical","");var A=p.get("line","auto");A==="auto"&&u.line===-1&&(A=-1),S.line=A,S.lineAlign=p.get("lineAlign","start"),S.snapToLines=p.get("snapToLines",!0),S.size=p.get("size",100),S.align=p.get("align",o);var D=p.get("position","auto");D==="auto"&&u.position===50&&(D=S.align==="start"||S.align==="left"?0:S.align==="end"||S.align==="right"?100:50),S.position=D}(L,_)}function m(L){return L.replace(/<br(?: \/)?>/gi,`
`)}var f=function(){function L(){this.state="INITIAL",this.buffer="",this.decoder=new i,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var _=L.prototype;return _.parse=function(E){var l=this;function g(){var A=l.buffer,D=0;for(A=m(A);D<A.length&&A[D]!=="\r"&&A[D]!==`
`;)++D;var w=A.substr(0,D);return A[D]==="\r"&&++D,A[D]===`
`&&++D,l.buffer=A.substr(D),w}E&&(l.buffer+=l.decoder.decode(E,{stream:!0}));try{var c="";if(l.state==="INITIAL"){if(!/\r\n|\n/.test(l.buffer))return this;var T=(c=g()).match(/^()?WEBVTT([ \t].*)?$/);if(!T||!T[0])throw new Error("Malformed WebVTT signature.");l.state="HEADER"}for(var S=!1;l.buffer;){if(!/\r\n|\n/.test(l.buffer))return this;switch(S?S=!1:c=g(),l.state){case"HEADER":/:/.test(c)?d(c,function(A,D){},/:/):c||(l.state="ID");continue;case"NOTE":c||(l.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(c)){l.state="NOTE";break}if(!c)continue;if(l.cue=new n.default(0,0,""),l.state="CUE",c.indexOf("-->")===-1){l.cue.id=c;continue}case"CUE":if(!l.cue){l.state="BADCUE";continue}try{y(c,l.cue,l.regionList)}catch{l.cue=null,l.state="BADCUE";continue}l.state="CUETEXT";continue;case"CUETEXT":var p=c.indexOf("-->")!==-1;if(!c||p&&(S=!0)){l.oncue&&l.cue&&l.oncue(l.cue),l.cue=null,l.state="ID";continue}if(l.cue===null)continue;l.cue.text&&(l.cue.text+=`
`),l.cue.text+=c;continue;case"BADCUE":c||(l.state="ID")}}}catch{l.state==="CUETEXT"&&l.cue&&l.oncue&&l.oncue(l.cue),l.cue=null,l.state=l.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},_.flush=function(){var E=this;try{if((E.cue||E.state==="HEADER")&&(E.buffer+=`

`,E.parse()),E.state==="INITIAL"||E.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(l){E.onparsingerror&&E.onparsingerror(l)}return E.onflush&&E.onflush(),this},L}()},"./src/utils/webvtt-parser.ts":function(t,e,r){r.r(e),r.d(e,"generateCueId",function(){return m}),r.d(e,"parseWebVTT",function(){return f});var n=r("./src/polyfills/number.ts"),i=r("./src/utils/vttparser.ts"),s=r("./src/demux/id3.ts"),a=r("./src/utils/timescale-conversion.ts"),d=r("./src/remux/mp4-remuxer.ts"),u=/\r\n|\n\r|\n|\r/g,o=function(L,_,E){return E===void 0&&(E=0),L.substr(E,_.length)===_},y=function(L){for(var _=5381,E=L.length;E;)_=33*_^L.charCodeAt(--E);return(_>>>0).toString()};function m(L,_,E){return y(L.toString())+y(_.toString())+y(E)}function f(L,_,E,l,g,c,T,S){var p,A=new i.VTTParser,D=Object(s.utf8ArrayToStr)(new Uint8Array(L)).trim().replace(u,`
`).split(`
`),w=[],k=Object(a.toMpegTsClockFromTimescale)(_,E),h="00:00.000",v=0,b=0,R=!0,I=!1;A.oncue=function(C){var x=l[g],O=l.ccOffset,P=(v-k)/9e4;if(x!=null&&x.new&&(b!==void 0?O=l.ccOffset=x.start:function(j,K,z){var re=j[K],ne=j[re.prevCC];if(!ne||!ne.new&&re.new)return j.ccOffset=j.presentationOffset=re.start,void(re.new=!1);for(;(V=ne)!==null&&V!==void 0&&V.new;){var V;j.ccOffset+=re.start-ne.start,re.new=!1,ne=j[(re=ne).prevCC]}j.presentationOffset=z}(l,g,P)),P&&(O=P-l.presentationOffset),I){var M=C.endTime-C.startTime,F=Object(d.normalizePts)(9e4*(C.startTime+O-b),9e4*c)/9e4;C.startTime=F,C.endTime=F+M}var B=C.text.trim();C.text=decodeURIComponent(encodeURIComponent(B)),C.id||(C.id=m(C.startTime,C.endTime,B)),C.endTime>0&&w.push(C)},A.onparsingerror=function(C){p=C},A.onflush=function(){p?S(p):T(w)},D.forEach(function(C){if(R){if(o(C,"X-TIMESTAMP-MAP=")){R=!1,I=!0,C.substr(16).split(",").forEach(function(x){o(x,"LOCAL:")?h=x.substr(6):o(x,"MPEGTS:")&&(v=parseInt(x.substr(7)))});try{b=function(x){var O=parseInt(x.substr(-3)),P=parseInt(x.substr(-6,2)),M=parseInt(x.substr(-9,2)),F=x.length>9?parseInt(x.substr(0,x.indexOf(":"))):0;if(!(Object(n.isFiniteNumber)(O)&&Object(n.isFiniteNumber)(P)&&Object(n.isFiniteNumber)(M)&&Object(n.isFiniteNumber)(F)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+x);return O+=1e3*P,(O+=6e4*M)+36e5*F}(h)/1e3}catch(x){I=!1,p=x}return}C===""&&(R=!1)}A.parse(C+`
`)}),A.flush()}},"./src/utils/xhr-loader.ts":function(t,e,r){r.r(e);var n=r("./src/utils/logger.ts"),i=r("./src/loader/load-stats.ts"),s=/^age:\s*[\d.]+\s*$/m,a=function(){function d(o){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=o?o.xhrSetup:null,this.stats=new i.LoadStats,this.retryDelay=0}var u=d.prototype;return u.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},u.abortInternal=function(){var o=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),o&&(o.onreadystatechange=null,o.onprogress=null,o.readyState!==4&&(this.stats.aborted=!0,o.abort()))},u.abort=function(){var o;this.abortInternal(),(o=this.callbacks)!==null&&o!==void 0&&o.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},u.load=function(o,y,m){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=o,this.config=y,this.callbacks=m,this.retryDelay=y.retryDelay,this.loadInternal()},u.loadInternal=function(){var o=this.config,y=this.context;if(o){var m=this.loader=new self.XMLHttpRequest,f=this.stats;f.loading.first=0,f.loaded=0;var L=this.xhrSetup;try{if(L)try{L(m,y.url)}catch{m.open("GET",y.url,!0),L(m,y.url)}m.readyState||m.open("GET",y.url,!0)}catch(_){return void this.callbacks.onError({code:m.status,text:_.message},y,m)}y.rangeEnd&&m.setRequestHeader("Range","bytes="+y.rangeStart+"-"+(y.rangeEnd-1)),m.onreadystatechange=this.readystatechange.bind(this),m.onprogress=this.loadprogress.bind(this),m.responseType=y.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),o.timeout),m.send()}},u.readystatechange=function(){var o=this.context,y=this.loader,m=this.stats;if(o&&y){var f=y.readyState,L=this.config;if(!m.aborted&&f>=2)if(self.clearTimeout(this.requestTimeout),m.loading.first===0&&(m.loading.first=Math.max(self.performance.now(),m.loading.start)),f===4){y.onreadystatechange=null,y.onprogress=null;var _=y.status;if(_>=200&&_<300){var E,l;if(m.loading.end=Math.max(self.performance.now(),m.loading.first),l=o.responseType==="arraybuffer"?(E=y.response).byteLength:(E=y.responseText).length,m.loaded=m.total=l,!this.callbacks)return;var g=this.callbacks.onProgress;if(g&&g(m,o,E,y),!this.callbacks)return;var c={url:y.responseURL,data:E};this.callbacks.onSuccess(c,m,o,y)}else m.retry>=L.maxRetry||_>=400&&_<499?(n.logger.error(_+" while loading "+o.url),this.callbacks.onError({code:_,text:y.statusText},o,y)):(n.logger.warn(_+" while loading "+o.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,L.maxRetryDelay),m.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),L.timeout)}},u.loadtimeout=function(){n.logger.warn("timeout while loading "+this.context.url);var o=this.callbacks;o&&(this.abortInternal(),o.onTimeout(this.stats,this.context,this.loader))},u.loadprogress=function(o){var y=this.stats;y.loaded=o.loaded,o.lengthComputable&&(y.total=o.total)},u.getCacheAge=function(){var o=null;if(this.loader&&s.test(this.loader.getAllResponseHeaders())){var y=this.loader.getResponseHeader("age");o=y?parseFloat(y):null}return o},d}();e.default=a}}).default);var rs=Wp(rc.exports);const zp={name:"d-icon"},pt=Object.assign(zp,{props:{icon:String,size:[Number,String]},setup:function(t){const e=t,r=Ce(()=>({fontSize:/^\d+$/.test(e.size)?e.size+"px":e.size}));return(n,i)=>(he(),ge("i",{class:Je(["d-icon iconfont",t.icon]),style:yt(J(r))},null,6))}});pt.__scopeId="data-v-0c690e66";rr("data-v-4cb76d59");const Yp={class:"d-player-top"},qp={class:"top-title"},$p={class:"top-title"};nr();const Zp={props:{title:{default:""}},setup(t){Date.prototype.format=function(n){let i={"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds()};for(var s in i)new RegExp("("+s+")").test(n)&&(n=n.replace(RegExp.$1,RegExp.$1.length==1?i[s]:("00"+i[s]).substr((""+i[s]).length)));return n};let e=Ke("00:00:00");e.value=new Date().format("hh:mm:ss");let r=null;return r=setInterval(()=>{e.value=new Date().format("hh:mm:ss")},1e3),An(()=>{clearInterval(r)}),(n,i)=>(he(),ge("div",Yp,[Q("p",qp,Ae(t.title||""),1),Q("p",$p,Ae(J(e)),1)]))},__scopeId:"data-v-4cb76d59"};rr("data-v-ac2469ec");const Xp={class:"d-status"},Qp={class:"d-flex-center"},Jp={class:"d-flex-center"},ev=We("5X ");nr();var nc=at({props:["state"],setup:t=>(e,r)=>Ze((he(),ge("div",Xp,[Ze(Q("li",Qp,[pe(pt,{size:"18",class:"d-status-icon",icon:"icon-volume-"+(t.state.volume==0?"mute":t.state.volume>.5?"up":"down")},null,8,["icon"]),We(" "+Ae(~~(100*t.state.volume))+"% ",1)],512),[[it,t.state.handleType=="volume"]]),Ze(Q("li",Jp,[pe(pt,{size:"12",icon:"icon-play"}),pe(pt,{size:"12",icon:"icon-play",style:{"margin-right":"5px"}}),ev],512),[[it,t.state.handleType=="playbackRate"||t.state.isMultiplesPlay]])],512)),[[it,t.state.handleType||t.state.isMultiplesPlay]])});nc.__scopeId="data-v-ac2469ec",rr("data-v-385f7870");const tv=["checked","true-value","false-value"],rv=Q("span",{class:"d-switch_action"},null,-1);nr();var Zn=at({props:{modelValue:{type:[Number,String,Boolean]},width:{type:String,default:"40px"},trueValue:{type:[Number,String,Boolean],default:!0},falseValue:{type:[Number,String,Boolean],default:!0},activeColor:{type:[String],default:"#409EFF"}},emits:["update:modelValue","change"],setup(t,{emit:e}){const r=t;Js(a=>({"014e5dc0":t.width,e4e32852:t.activeColor}));const n=Ke(null),i=Ce(()=>r.modelValue===r.trueValue),s=()=>{Ei(()=>{const a=n.value.checked;e("update:modelValue",a),e("change",a)})};return(a,d)=>(he(),ge("div",{class:Je(["d-switch",{"is-checked":J(i)}])},[Q("input",{class:"d-switch__input",ref:n,type:"checkbox",checked:J(i),onChange:s,"true-value":t.trueValue,"false-value":t.falseValue},null,40,tv),rv],2))}});Zn.__scopeId="data-v-385f7870",rr("data-v-b2384226");const nv={key:0},iv=Q("i",{class:"rotating iconfont icon-loading f50"},null,-1),sv=[Q("i",{class:"rotating iconfont icon-loading f50"},null,-1),Q("p",null,"...",-1)],av=[Q("i",{class:"iconfont icon-replay f24 mr5"},null,-1),We(" ")],ov=[Q("i",{class:"iconfont icon-replay f24 mr5"},null,-1),We(" ")];nr();var ic=at({props:{loadType:String,text:{type:String,default:""}},setup(t){const e=t,{proxy:r}=ki(),n=["loadstart","waiting","ended","error","stalled"],i=()=>{r.$parent.play()},s=Ce(()=>{let a="background: rgba(0, 0, 0, .1);z-index:1";return e.loadType=="loadstart"&&(a="background: rgba(0, 0, 0, 1);;z-index:3"),a});return(a,d)=>Ze((he(),ge("div",{class:"d-loading",style:yt(J(s))},[Q("div",null,[t.loadType=="loadstart"?(he(),ge("span",nv,[iv,Q("p",null,Ae(t.text),1)])):Pe("",!0),Ze(Q("span",null,sv,512),[[it,t.loadType=="waiting"]]),Ze(Q("span",null,[Q("p",{onClick:i,class:"d-flex-x d-pointer"},av)],512),[[it,t.loadType=="ended"]]),Ze(Q("span",null,[Q("p",{onClick:i,class:"d-flex-x d-pointer"},ov)],512),[[it,t.loadType=="error"||t.loadType=="stalled"]])])],4)),[[it,n.includes(t.loadType)]])}});ic.__scopeId="data-v-b2384226";const yr=function(t,e,r,n=!1){t&&e&&r&&t.addEventListener(e,r,n)},rt=function(t,e,r,n=!1){t&&e&&r&&t.removeEventListener(e,r,n)};rr("data-v-5a794390");const lv=["onMousedown"];nr();var Pr=at(Cs(Is({},{name:"DSlider"}),{props:{modelValue:{required:!0,type:Number,default:0},disabled:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},hover:{type:Boolean,default:!0},hoverText:{type:String,default:""},preload:{type:Number,default:0},size:{type:String,default:"10px"}},emits:["update:modelValue","change","onMousemove"],setup:function(t,{emit:e}){const r=t;Js(l=>({"5242b67b":t.size}));const n=Ke(null),i=Ke(null),s=Ct({dragging:!1,hoverPosition:0,hoverTipsLeft:"50%"}),a=Ce(()=>{let l=r.modelValue<0?0:r.modelValue>1?1:r.modelValue;return r.vertical?`height:${100*l}%`:`width:${100*l}%`}),d=Ce(()=>{let l=r.preload<0?0:r.preload>1?1:r.preload;return r.vertical?`height:${100*l}%`:`width:${100*l}%`}),u=Ce(()=>{let l=s.hoverPosition<0?0:s.hoverPosition>1?1:s.hoverPosition;return r.vertical?`bottom:${100*l}%`:`left:${100*l}%`}),o=l=>{l.preventDefault()},y=l=>{r.disabled||(l.preventDefault(),s.dragging=!0,f(l),yr(window,"mousemove",_),yr(window,"touchmove",_),yr(window,"mouseup",E),yr(window,"touchend",E))},m=l=>{if(!r.hover)return;let g=L(l);if(e("onMousemove",l,g),s.hoverPosition=g,r.vertical)return;let c=n.value,T=i.value.clientWidth/2,S=l.clientX-c.getBoundingClientRect().left;S<T?s.hoverTipsLeft=T-S+"px":c.clientWidth-S<T?s.hoverTipsLeft=c.clientWidth-S-T+"px":s.hoverTipsLeft="50%"},f=l=>{let g=L(l);e("update:modelValue",g),e("change",l,g)},L=l=>{let g=n.value,c=0;if(r.vertical){let T=g.clientHeight;c=(g.getBoundingClientRect().bottom-l.clientY)/T}else c=(l.clientX-g.getBoundingClientRect().left)/g.clientWidth;return c<0?0:c>1?1:c},_=l=>{f(l)},E=l=>{s.dragging&&(rt(window,"mousemove",_),rt(window,"touchmove",_),rt(window,"mouseup",E),rt(window,"touchend",E),rt(window,"contextmenu",E),setTimeout(()=>{s.dragging=!1},0))};return(l,g)=>(he(),ge("div",{ref:n,class:Je(["d-slider",{"is-vertical":r.vertical}]),onMousedown:zf(y,["stop"]),onContextmenu:o},[Q("div",{class:"d-slider__runway",onMousemove:m},[Ze(Q("div",{class:"d-slider__cursor",style:yt(J(u))},[Ze(Q("div",{class:"d-slider__tips",ref:i,style:yt({left:J(s).hoverTipsLeft})},Ae(r.hoverText),5),[[it,r.hoverText]])],4),[[it,r.hover]]),Q("div",{class:"d-slider__preload",style:yt(J(d))},null,4),Q("div",{class:"d-slider__bar",style:yt(J(a))},null,4)],32)],42,lv))}}));Pr.__scopeId="data-v-5a794390";rr("data-v-570fa0d1");const uv={key:0,class:"d-player-dialog"},cv={class:"d-player-dialog-body"},dv={class:"d-player-dialog-title"},fv={class:"d-player-hotkey-panel"},hv={class:"d-player-filter-panel"},gv={class:"d-player-filter-panel-item"},mv=Q("span",null,"",-1),pv={class:"d-player-filter-panel-item"},vv=Q("span",null,"",-1),yv={class:"d-player-filter-panel-item"},Ev=Q("span",null,"",-1),Tv={key:0,class:"d-player-contextmenu"},Sv=["dplayerKeyCode"],bv=Q("input",{class:"d-player-copyText"},null,-1);nr();var sc=at({setup(t){const e=Ct({show:!1,dialogType:"",dialogTitle:"",version:"1.3.1-beta.6",mouseX:0,mouseY:0}),r=[{label:"",key:"filter"},{label:"",key:"hotkey"},{label:"",key:"copy"},{label:"1.3.1-beta.6",key:"version"}],n=[{key:"Space",label:"/"},{key:"",label:"10s5"},{key:"",label:"5s"},{key:"",label:"10%"},{key:"",label:"10%"},{key:"Esc",label:"/"},{key:"F",label:"/"}],i=Ct({saturate:.392,brightness:.392,contrast:.392}),s=Ce(()=>({left:e.mouseX+"px",top:e.mouseY+"px"}));Rt(i,y=>{let m=document.querySelector("#dPlayerVideo"),f=(2.55*y.saturate).toFixed(2),L=(2.55*y.brightness).toFixed(2),_=(2.55*y.contrast).toFixed(2);m.style.filter=`saturate(${f}) brightness(${L}) contrast(${_})`});const a=()=>{i.saturate=.392,i.brightness=.392,i.contrast=.392},d=y=>{y.key=="Escape"&&o(0)},u=y=>{y.preventDefault(),yr(window,"keydown",d),yr(window,"click",o);let m=document.querySelector("#refPlayerWrap"),f=m.clientWidth;m.clientHeight,e.mouseX=y.clientX-m.getBoundingClientRect().left,f-e.mouseX<130&&(e.mouseX=e.mouseX+(f-e.mouseX-130)),e.mouseY=y.clientY-m.getBoundingClientRect().top,e.show=!0},o=y=>{let m=y.path[0].tagName=="LI",f=y.path[0].attributes.dplayerKeyCode&&y.path[0].attributes.dplayerKeyCode.value,L=r.map(_=>_.key);if(m&&L.includes(f))if(e.dialogTitle=y.path[0].innerText,e.dialogType=f,f=="copy"){let _=document.querySelector(".d-player-copyText");_.value=window.location.href,_.select(),document.execCommand("copy"),e.dialogType=""}else f=="version"&&(e.dialogType="");e.show=!1,rt(window,"keydown",d),rt(window,"click",o)};return bn(()=>{let y=document.querySelector("#refPlayerWrap");rt(window,"keydown",d),rt(window,"click",o),rt(y,"contextmenu",u),yr(y,"contextmenu",u)}),An(()=>{let y=document.querySelector("#refPlayerWrap");rt(window,"keydown",d),rt(window,"click",o),rt(y,"contextmenu",u)}),(y,m)=>(he(),ge("div",null,[pe(yn,{name:"d-fade-in"},{default:Fr(()=>[J(e).dialogType?(he(),ge("div",uv,[Q("div",cv,[Q("h5",dv,[We(Ae(J(e).dialogTitle)+" ",1),Q("i",{onClick:m[0]||(m[0]=f=>J(e).dialogType=!1),class:"icon icon-close"},"X")]),Ze(Q("ul",fv,[(he(),ge(Be,null,br(n,f=>Q("li",{class:"d-player-hotkey-panel-item",key:f.key},[Q("span",null,Ae(f.key),1),Q("span",null,Ae(f.label),1)])),64))],512),[[it,J(e).dialogType=="hotkey"]]),Ze(Q("ul",hv,[Q("li",gv,[mv,pe(Pr,{class:"filter-panel-slider",size:"5px",modelValue:J(i).saturate,"onUpdate:modelValue":m[1]||(m[1]=f=>J(i).saturate=f)},null,8,["modelValue"]),Q("span",null,Ae(Math.round(255*J(i).saturate)),1)]),Q("li",pv,[vv,pe(Pr,{class:"filter-panel-slider",size:"5px",modelValue:J(i).brightness,"onUpdate:modelValue":m[2]||(m[2]=f=>J(i).brightness=f)},null,8,["modelValue"]),Q("span",null,Ae(Math.round(255*J(i).brightness)),1)]),Q("li",yv,[Ev,pe(Pr,{class:"filter-panel-slider",size:"5px",modelValue:J(i).contrast,"onUpdate:modelValue":m[3]||(m[3]=f=>J(i).contrast=f)},null,8,["modelValue"]),Q("span",null,Ae(Math.round(255*J(i).contrast)),1)]),Q("span",{onClick:a,title:"","aria-label":"",class:"d-player-filter-reset"},"")],512),[[it,J(e).dialogType=="filter"]])])])):Pe("",!0)]),_:1}),J(e).show?(he(),ge("div",Tv,[Q("ul",{class:"d-player-contextmenu-body",style:yt(J(s))},[(he(),ge(Be,null,br(r,f=>Q("li",{dplayerKeyCode:f.key,key:f.key},Ae(f.label),9,Sv)),64))],4),bv])):Pe("",!0)]))}});sc.__scopeId="data-v-570fa0d1";const ns=t=>{let e=~~(t/3600),r=~~(t%3600/60),n=~~(t%60);return e=e<10?"0"+e:e,r=r<10?"0"+r:r,n=n<10?"0"+n:n,`${e}:${r}:${n}`},Jr="ontouchstart"in window,Ko=["loadstart","play","pause","playing","seeking","seeked","waiting","durationchange","progress","canplay","timeupdate","ended","error","stalled"],Av={width:{type:String,default:"800px"},height:{type:String,default:"450px"},color:{type:String,default:"#409eff"},src:{required:!0,type:String,default:""},title:{type:String,default:""},type:{type:String,default:"video/mp4"},poster:{type:String,default:""},webFullScreen:{type:Boolean,default:!1},speed:{type:Boolean,default:!0},currentTime:{type:Number,default:0},playsinline:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},speedRate:{type:Array,default:()=>["2.0","1.5","1.25","1.0","0.75","0.5"]},autoPlay:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},mirror:{type:Boolean,default:!1},ligthOff:{type:Boolean,default:!1},volume:{type:[String,Number],default:.3},control:{type:Boolean,default:!0},controlBtns:{type:Array,default:["audioTrack","quality","speedRate","volume","setting","pip","pageFullScreen","fullScreen"]},preload:{type:String,default:"auto"}};rr("data-v-01791e9e");const Lv={class:"d-player-video",id:"dPlayerVideo"},wv=["controls","webkit-playsinline","playsinline","volume","muted","loop","preload","src","poster"],_v={class:"d-player-lightoff"},kv={key:1,class:"d-player-state"},Dv={class:"d-play-btn"},Rv=["onKeyup","onKeydown"],Iv={class:"d-control-progress"},Cv={class:"d-tool-bar"},Ov={key:0,class:"d-tool-item d-tool-time audioTrack-btn"},xv=Q("span",{style:{margin:"0 3px"}},"/",-1),Pv={class:"total-time"},Mv={class:"d-tool-bar"},Fv={key:0,class:"d-tool-item quality-btn"},Nv={class:"d-tool-item-main"},Uv={class:"speed-main",style:{"text-align":"center"}},Bv=["onClick"],Gv={key:1,class:"d-tool-item speedRate-btn"},Vv={class:"d-tool-item-main"},jv={class:"speed-main"},Hv=["onClick"],Kv={key:2,class:"d-tool-item volume-btn"},Wv={class:"d-tool-item-main volume-box",style:{width:"52px"}},zv={class:"volume-text-size"},Yv={key:3,class:"d-tool-item setting-btn"},qv={class:"d-tool-item-main"},$v={class:"speed-main"},Zv=We("  "),Xv=We("  "),Qv=We("  "),Jv=Q("div",{class:"d-tool-item-main"},"",-1),ey=Q("div",{class:"d-tool-item-main"},"",-1),ty=Q("div",{class:"d-tool-item-main"},"",-1);nr();var Tn=at(Cs(Is({},{name:"vue3VideoPlay",inheritAttrs:!1}),{props:Av,emits:[...Ko,"mirrorChange","loopChange","lightOffChange"],setup:function(t,{expose:e,emit:r}){const n=t;Js(O=>({"51d4439c":J(L),"77e758a6":O.width,b8a1afc0:O.height}));const i=new rs({fragLoadingTimeOut:2e3}),s=Ke(null),a=Ke(null),d=Ke(null),u=Ke(null),o=Ct(Cs(Is({dVideo:null},n),{muted:n.muted,playBtnState:n.autoPlay?"pause":"play",loadStateType:"loadstart",fullScreen:!1,handleType:"",currentTime:"00:00:00",preloadBar:0,totalTime:"00:00:00",isVideoHovering:!0,speedActive:"1.0",playProgress:0,isMultiplesPlay:!1,longPressTimeout:null,progressCursorTime:"00:00:00",qualityLevels:[],currentLevel:0})),y=(...O)=>P=>O.reverse().reduce((M,F)=>F(M),P),m=Ko.reduce((O,P)=>{var M;return O[`on${M=P,M.charAt(0).toUpperCase()+M.slice(1)}`]=F=>{o.loadStateType=P,r(P,F)},O},{});m.onCanplay=y(m.onCanplay,()=>{o.playBtnState!="play"&&o.dVideo.play(),o.autoPlay&&(o.dVideo.play(),o.playBtnState="pause")}),m.onEnded=y(m.onEnded,()=>{o.playBtnState="replay"}),m.onDurationchange=O=>{r("durationchange",O),n.currentTime!=0&&(o.dVideo.currentTime=n.currentTime),m.onTimeupdate(O)},m.onProgress=O=>{console.log("..."),r("progress",O);let P=O.target.duration,M=O.target.buffered,F=O.target.buffered.length&&O.target.buffered.end(M-1);o.preloadBar=F/P},m.onTimeupdate=O=>{r("timeupdate",O);let P=O.duration||O.target.duration||0,M=O.currentTime||O.target.currentTime;o.playProgress=M/P,o.currentTime=ns(M),o.totalTime=ns(P)},m.onError=y(m.onError,()=>{o.playBtnState="replay"});let f=jd();for(let O in f)m[O]=f[O];const L=(_=o.color,`${parseInt("0x"+_.slice(1,3))},${parseInt("0x"+_.slice(3,5))},${parseInt("0x"+_.slice(5,7))}`);var _;const E=Ho(500,()=>{o.handleType=""}),l=O=>{O.preventDefault(),O.code=="ArrowUp"?o.volume=o.volume+.1>1?1:o.volume+.1:o.volume=o.volume-.1<0?0:o.volume-.1,o.muted=!1,o.handleType="volume",E()},g=O=>{n.speed&&(o.dVideo.currentTime=o.dVideo.currentTime<10?.1:o.dVideo.currentTime-10,m.onTimeupdate(o.dVideo),S())},c=O=>{O.preventDefault();let P=O.type;if(O.key=="ArrowRight"){if(S(),P=="keyup"){if(clearTimeout(o.longPressTimeout),!n.speed&&!o.longPressTimeout)return;o.isMultiplesPlay?(o.dVideo.playbackRate=o.speedActive,o.isMultiplesPlay=!1):(o.dVideo.currentTime=o.dVideo.currentTime+10,m.onTimeupdate(o.dVideo))}else if(P=="keydown"){if(!n.speed)return;o.isMultiplesPlay&&clearTimeout(o.longPressTimeout),o.longPressTimeout=setTimeout(()=>{o.isMultiplesPlay=!0,o.dVideo.playbackRate=5,o.handleType="playbackRate",E()},500)}}},T=()=>{Jr||u.value.focus()},S=()=>{o.loadStateType="play",o.dVideo.play().catch(()=>{setTimeout(()=>{o.playBtnState="replay",o.loadStateType="error"},500)}),o.playBtnState="pause"},p=()=>{o.dVideo.pause(),o.playBtnState="play"},A=O=>{O&&O.preventDefault(),o.playBtnState=="play"||o.playBtnState=="replay"?S():o.playBtnState=="pause"&&p()},D=()=>{o.muted=!o.muted,o.volume==0&&(o.volume=.05)},w=(O,P)=>{let M=o.dVideo.duration||o.dVideo.target.duration;o.dVideo.currentTime=M*P,o.playBtnState=="play"&&(o.dVideo.play(),o.playBtnState="pause")},k=(O,P)=>{o.progressCursorTime=ns(o.dVideo.duration*P)},h=Ho(2500,()=>{o.isVideoHovering=!1}),v=O=>{o.isVideoHovering=!0,h()},b=O=>{r("mirrorChange",O,o.dVideo)},R=O=>{r("loopChange",O,o.dVideo)},I=O=>{r("lightOffChange",O,o.dVideo)},C=()=>{var O;O=o.dVideo,document.pictureInPictureElement?document.exitPictureInPicture().catch(P=>{console.log(P,"Video failed to leave Picture-in-Picture mode.")}):O.requestPictureInPicture().catch(P=>{console.log(P,"Video failed to enter Picture-in-Picture mode.")})},x=()=>{o.fullScreen=(O=>{let P=document,M=P.webkitIsFullScreen||P.fullscreen;return M?(document.exitFullscreen||P.webkitExitFullScreen).call(P):(O.requestFullscreen||O.webkitRequestFullScreen).call(O),!M})(s.value)};return Rt(()=>n.src,()=>{Ei(()=>{o.dVideo.canPlayType(n.type)||o.dVideo.canPlayType("application/vnd.apple.mpegurl")?o.muted=n.autoPlay:rs.isSupported()&&(i.detachMedia(),i.attachMedia(o.dVideo),i.on(rs.Events.MEDIA_ATTACHED,()=>{i.loadSource(n.src),i.on("hlsManifestParsed",(O,P)=>{console.log(P),o.currentLevel=P.level,o.qualityLevels=P.levels||[]})}),i.on("hlsLevelSwitching",(O,P)=>{console.log(P),console.log("LEVEL_SWITCHING")}),i.on("hlsLevelSwitched",(O,P)=>{o.currentLevel=P.level,console.log("LEVEL_SWITCHED")}))})},{immediate:!0}),bn(()=>{o.dVideo=a,T()}),e({play:S,pause:p,togglePlay:A}),(O,P)=>(he(),ge("div",{ref:s,id:"refPlayerWrap",class:Je(["d-player-wrap",{"web-full-screen":J(o).webFullScreen,"is-lightoff":J(o).lightOff,"d-player-wrap-hover":J(o).playBtnState=="play"||J(o).isVideoHovering}]),onMousemove:v},[Q("div",Lv,[Q("video",Nl({ref:a,class:["d-player-video-main",{"video-mirror":J(o).mirror}],id:"dPlayerVideoMain",controls:!(!J(Jr)||!J(o).speed),"webkit-playsinline":n.playsinline,playsinline:n.playsinline},J(m),{volume:J(o).volume,muted:J(o).muted,loop:J(o).loop,preload:O.preload,width:"100%",height:"100%",src:n.src,poster:n.poster}),"Video",16,wv)]),pe(yn,{name:"d-fade-in"},{default:Fr(()=>[Ze(Q("div",_v,null,512),[[it,J(o).lightOff]])]),_:1}),J(o).fullScreen?(he(),$s(Zp,{key:0,title:n.title},null,8,["title"])):Pe("",!0),J(Jr)?Pe("",!0):(he(),ge("div",kv,[pe(yn,{name:"d-scale-out"},{default:Fr(()=>[Ze(Q("div",Dv,[pe(pt,{icon:"icon-play",size:40})],512),[[it,J(o).playBtnState=="play"]])]),_:1}),pe(nc,{state:J(o)},null,8,["state"])])),J(Jr)?Pe("",!0):(he(),ge("input",{key:2,type:"input",readonly:"readonly",ref:u,onDblclick:x,onKeyup:[qr(x,["f"]),P[0]||(P[0]=qr(M=>J(o).webFullScreen=!1,["esc"])),c],onClick:A,onKeydown:[qr(A,["space"]),qr(g,["arrow-left"]),qr(l,["arrow-up","arrow-down"]),c],class:"d-player-input",maxlength:"0"},null,40,Rv)),pe(ic,{loadType:J(o).loadStateType},null,8,["loadType"]),pe(sc),!J(Jr)&&J(o).control?(he(),ge("div",{key:3,class:"d-player-control",ref:d},[Q("div",Iv,[pe(Pr,{class:"d-progress-bar",onOnMousemove:k,onChange:w,disabled:!J(o).speed,hoverText:J(o).progressCursorTime,modelValue:J(o).playProgress,"onUpdate:modelValue":P[1]||(P[1]=M=>J(o).playProgress=M),preload:J(o).preloadBar},null,8,["disabled","hoverText","modelValue","preload"])]),Q("div",{class:"d-control-tool",onClick:T},[Q("div",Cv,[Q("div",{class:"d-tool-item",onClick:A},[pe(pt,{size:"24",icon:`icon-${J(o).playBtnState}`},null,8,["icon"])]),n.controlBtns.includes("audioTrack")?(he(),ge("div",Ov,[Q("span",null,Ae(J(o).currentTime),1),xv,Q("span",Pv,Ae(J(o).totalTime),1)])):Pe("",!0)]),Q("div",Mv,[J(o).qualityLevels.length&&n.controlBtns.includes("quality")?(he(),ge("div",Fv,[We(Ae(J(o).qualityLevels.length&&(J(o).qualityLevels[J(o).currentLevel]||{}).height)+"P ",1),Q("div",Nv,[Q("ul",Uv,[(he(!0),ge(Be,null,br(J(o).qualityLevels,(M,F)=>(he(),ge("li",{class:Je({"speed-active":J(o).currentLevel==F}),onClick:B=>((j,K)=>{i.currentLevel=K,o.currentLevel=K})(0,F),key:M},Ae(M.height)+"P",11,Bv))),128))])])])):Pe("",!0),n.controlBtns.includes("speedRate")?(he(),ge("div",Gv,[We(Ae(J(o).speedActive=="1.0"?"":J(o).speedActive+"x")+" ",1),Q("div",Vv,[Q("ul",jv,[(he(!0),ge(Be,null,br(J(o).speedRate,M=>(he(),ge("li",{class:Je({"speed-active":J(o).speedActive==M}),onClick:F=>(B=>{o.speedActive=B,o.dVideo.playbackRate=B})(M),key:M},Ae(M)+"x",11,Hv))),128))])])])):Pe("",!0),n.controlBtns.includes("volume")?(he(),ge("div",Kv,[Q("div",Wv,[Q("div",{class:Je(["volume-main",{"is-muted":J(o).muted}])},[Q("span",zv,Ae(J(o).muted?0:~~(100*J(o).volume))+"%",1),pe(Pr,{onChange:P[2]||(P[2]=M=>J(o).muted=!1),hover:!1,size:"5px",vertical:!0,modelValue:J(o).volume,"onUpdate:modelValue":P[3]||(P[3]=M=>J(o).volume=M)},null,8,["modelValue"])],2)]),Q("span",{onClick:D,style:{display:"flex"}},[pe(pt,{size:"20",icon:"icon-volume-"+(J(o).volume==0||J(o).muted?"mute":J(o).volume>.5?"up":"down")},null,8,["icon"])])])):Pe("",!0),n.controlBtns.includes("setting")?(he(),ge("div",Yv,[pe(pt,{size:"20",class:"rotateHover",icon:"icon-settings"}),Q("div",qv,[Q("ul",$v,[Q("li",null,[Zv,pe(Zn,{onChange:b,modelValue:J(o).mirror,"onUpdate:modelValue":P[4]||(P[4]=M=>J(o).mirror=M)},null,8,["modelValue"])]),Q("li",null,[Xv,pe(Zn,{onChange:R,modelValue:J(o).loop,"onUpdate:modelValue":P[5]||(P[5]=M=>J(o).loop=M)},null,8,["modelValue"])]),Q("li",null,[Qv,pe(Zn,{onChange:I,modelValue:J(o).lightOff,"onUpdate:modelValue":P[6]||(P[6]=M=>J(o).lightOff=M)},null,8,["modelValue"])])])])])):Pe("",!0),n.controlBtns.includes("pip")?(he(),ge("div",{key:4,class:"d-tool-item pip-btn",onClick:C},[pe(pt,{size:"20",icon:"icon-pip"}),Jv])):Pe("",!0),n.controlBtns.includes("pageFullScreen")?(he(),ge("div",{key:5,class:"d-tool-item pip-btn",onClick:P[7]||(P[7]=M=>J(o).webFullScreen=!J(o).webFullScreen)},[pe(pt,{size:"20",icon:"icon-web-screen"}),ey])):Pe("",!0),n.controlBtns.includes("fullScreen")?(he(),ge("div",{key:6,class:"d-tool-item fullScreen-btn",onClick:x},[ty,pe(pt,{size:"20",icon:"icon-screen"})])):Pe("",!0)])])],512)):Pe("",!0)],34))}}));function ry(t){t.component(Tn.name,Tn)}Tn.__scopeId="data-v-01791e9e",Tn.install=ry;const ny={class:"top-info"},iy={class:"video-container"},Wo="http://localhost",sy=at({__name:"DetailView",props:{viewKey:{}},setup(t){const e=t,{data:r}=ru(`${Wo}/api/v1/videos/${e.viewKey}`).get().json(),n=Ct({width:"100%",height:"auto",color:"#409eff",title:"",src:`${Wo}/api/v1/videos/${e.viewKey}/mp4`,muted:!1,webFullScreen:!1,speedRate:["0.75","1.0","1.25","1.5","2.0"],autoPlay:!1,loop:!1,mirror:!1,ligthOff:!1,volume:.3,control:!0,controlBtns:["audioTrack","quality","speedRate","volume","setting","pip","pageFullScreen","fullScreen"]});return(i,s)=>{var a;return he(),ge(Be,null,[Q("div",ny,Ae((a=J(r))==null?void 0:a.Title),1),Q("div",iy,[pe(J(Tn),Tc(Fl(n)),null,16)])],64)}}});const ay=Ii(sy,[["__scopeId","data-v-cc3bc9bd"]]),oy=Qh({history:mh("/"),routes:[{path:"/",redirect:"/categories/"},{path:"/categories/:category",props:!0,name:"listView",component:Bp},{path:"/videos/:viewKey",props:!0,name:"detailView",component:ay}]}),ac=Zf(dg);ac.use(oy);ac.mount("#app");
